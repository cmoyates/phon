<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<opgraph xmlns="http://gedge.ca/ns/opgraph" xmlns:nes="https://www.phon.ca/ns/node_editor" xmlns:oga="http://gedge.ca/ns/opgraph-app" xmlns:ogcn="http://gedge.ca/ns/opgraph-common-nodes" xmlns:opqry="https://phon.ca/ns/opgraph_query" xmlns:qry="http://phon.ling.mun.ca/ns/query">
    <graph id="root">
        <node id="1d6fc11b" name="Project" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
            <extensions>
                <oga:settings>
                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.project.Project]]></oga:property>
                    <oga:property key="contextKey"><![CDATA[_project]]></oga:property>
                </oga:settings>
                <oga:meta x="62" y="69"/>
            </extensions>
        </node>
        <node id="5e629711" name="Selected Sessions" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
            <extensions>
                <oga:settings>
                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.util.ArrayList]]></oga:property>
                    <oga:property key="contextKey"><![CDATA[_selectedSessions]]></oga:property>
                </oga:settings>
                <oga:meta x="62" y="310"/>
            </extensions>
        </node>
        <node id="6b8dfd59" name="Selected Participants" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
            <extensions>
                <oga:settings>
                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.util.ArrayList]]></oga:property>
                    <oga:property key="contextKey"><![CDATA[_selectedParticipants]]></oga:property>
                </oga:settings>
                <oga:meta x="62" y="411"/>
            </extensions>
        </node>
        <node id="dc4dad38c60648c1" name="Parameters" type="class:ca.phon.app.opgraph.nodes.PhonScriptNode">
            <extensions>
                <oga:settings>
                    <oga:property key="__script"><![CDATA[var GroupFilter = require("lib/GroupFilter").GroupFilter;
var AlignedGroupFilter = require("lib/TierFilter").TierFilter;
var WordFilter = require("lib/WordFilter").WordFilter;
var TierList = require("lib/TierList").TierList;
var AlignedWordFilter = require("lib/TierFilter").TierFilter;
var PatternFilter = require("lib/PatternFilter").PatternFilter;
var PatternType = require("lib/PatternFilter").PatternType;
var Pcc = require("lib/Pcc").Pcc;
var PccOptions = require("lib/Pcc").PccOptions;
var ResultType = require("lib/PhonScriptConstants").ResultType;

/********************************
 * Setup params
 *******************************/
var filters = {
	"pcc": new PccOptions("filters.pcc"),
	"group": new GroupFilter("filters.group"),
	"groupTiers": new TierList("filters.groupTiers"),
	"groupPattern": new PatternFilter("filters.groupPattern"),
	"alignedGroup": new AlignedGroupFilter("filters.alignedGroup"),
	"word": new WordFilter("filters.word"),
	"wordTiers": new TierList("filters.wordTiers"),
	"wordPattern": new PatternFilter("filters.wordPattern"),
	"alignedWord": new AlignedWordFilter("filters.alignedWord"),
};

var reportTitleParamInfo = {
	"id": "reportTitle",
	"title": "Report Title",
	"def": "PCC",
	"prompt": "Enter report title"
};
var reportTitleParam;
var reportTitle = reportTitleParamInfo.def;

function setup_params(params) {
	reportTitleParam = new StringScriptParam(
			reportTitleParamInfo.id,
			reportTitleParamInfo.title,
			reportTitleParamInfo.def);
	reportTitleParam.setPrompt(reportTitleParamInfo.prompt);
	params.add(reportTitleParam);
	
	var insertIdx = 0;

	filters.pcc.param_setup(params);
	
	filters.group.param_setup(params);
	filters.groupPattern.param_setup(params);

	var sep = new LabelScriptParam("", "<html><b>Add Aligned Groups</b></html>");
	params.add(sep);
	filters.groupTiers.param_setup(params);
	var sep2 = new LabelScriptParam("", "<html><b>Aligned Group Filter</b></html>");
	params.add(sep2);
	filters.alignedGroup.param_setup(params);

	filters.word.searchByWordEnabled = false;
	filters.word.param_setup(params);
	filters.wordPattern.param_setup(params);
	filters.wordPattern.setEnabled(false);

	var wordsep = new LabelScriptParam("", "<html><b>Add Aligned Words</b></html>");
	params.add(wordsep);
	filters.wordTiers.param_setup(params);

	var wordsep2 = new LabelScriptParam("", "<html><b>Aligned Word Filter</b></html>");
	params.add(wordsep2);
	filters.alignedWord.param_setup(params);
	var searchByWordListener = new java.beans.PropertyChangeListener {
		propertyChange: function (e) {
			var enabled = e.source.getValue(e.source.paramId);
			filters.wordPattern.setEnabled(enabled);
			filters.alignedWord.setEnabled(enabled);
		}
	};
	filters.word.searchByWordParam.addPropertyChangeListener(filters.word.searchByWordParam.paramId, searchByWordListener);
	var enabled = filters.word.searchByWordParam.getValue(filters.word.searchByWordParam.paramId);
	filters.wordPattern.setEnabled(enabled);
	filters.alignedWord.setEnabled(enabled);
}]]></oga:property>
                </oga:settings>
                <oga:meta x="62" y="570"/>
            </extensions>
        </node>
        <opqry:queryNode id="62a83f9c" name="Query: PCC" type="ca.phon.app.opgraph.nodes.query.QueryNode">
            <qry:query xmlns="http://phon.ling.mun.ca/ns/query" date="2017-11-10T08:53:41.928-03:30" name="Query Node" uuid="fe31cf21-2542-4714-bef0-d7909da9c973">
                <script>
                    <source>var GroupFilter = require("lib/GroupFilter").GroupFilter;
var AlignedGroupFilter = require("lib/TierFilter").TierFilter;
var WordFilter = require("lib/WordFilter").WordFilter;
var TierList = require("lib/TierList").TierList;
var AlignedWordFilter = require("lib/TierFilter").TierFilter;
var ParticipantFilter = require("lib/ParticipantFilter").ParticipantFilter;
var PatternFilter = require("lib/PatternFilter").PatternFilter;
var PatternType = require("lib/PatternFilter").PatternType;
var Pcc = require("lib/Pcc").Pcc;
var PccOptions = require("lib/Pcc").PccOptions;
var ResultType = require("lib/PhonScriptConstants").ResultType;

/********************************
 * Setup params
 *******************************/
var filters = {
	"pcc": new PccOptions("filters.pcc"),
	"group": new GroupFilter("filters.group"),
	"groupTiers": new TierList("filters.groupTiers"),
	"groupPattern": new PatternFilter("filters.groupPattern"),
	"alignedGroup": new AlignedGroupFilter("filters.alignedGroup"),
	"word": new WordFilter("filters.word"),
	"wordTiers": new TierList("filters.wordTiers"),
	"wordPattern": new PatternFilter("filters.wordPattern"),
	"alignedWord": new AlignedWordFilter("filters.alignedWord"),
	"speaker": new ParticipantFilter("filters.speaker")
};

function setup_params(params) {
	var insertIdx = 0;

	filters.pcc.param_setup(params);
	
	filters.group.param_setup(params);
	filters.groupPattern.param_setup(params);

	var sep = new LabelScriptParam("", "&lt;html&gt;&lt;b&gt;Add Aligned Groups&lt;/b&gt;&lt;/html&gt;");
	params.add(sep);
	filters.groupTiers.param_setup(params);
	var sep2 = new LabelScriptParam("", "&lt;html&gt;&lt;b&gt;Aligned Group Filter&lt;/b&gt;&lt;/html&gt;");
	params.add(sep2);
	filters.alignedGroup.param_setup(params);

	filters.word.searchByWordEnabled = false;
	filters.word.param_setup(params);
	filters.wordPattern.param_setup(params);
	filters.wordPattern.setEnabled(false);

	var wordsep = new LabelScriptParam("", "&lt;html&gt;&lt;b&gt;Add Aligned Words&lt;/b&gt;&lt;/html&gt;");
	params.add(wordsep);
	filters.wordTiers.param_setup(params);

	var wordsep2 = new LabelScriptParam("", "&lt;html&gt;&lt;b&gt;Aligned Word Filter&lt;/b&gt;&lt;/html&gt;");
	params.add(wordsep2);
	filters.alignedWord.param_setup(params);
	var searchByWordListener = new java.beans.PropertyChangeListener {
		propertyChange: function (e) {
			var enabled = e.source.getValue(e.source.paramId);
			filters.wordPattern.setEnabled(enabled);
			filters.alignedWord.setEnabled(enabled);
		}
	};
	filters.word.searchByWordParam.addPropertyChangeListener(filters.word.searchByWordParam.paramId, searchByWordListener);
	var enabled = filters.word.searchByWordParam.getValue(filters.word.searchByWordParam.paramId);
	filters.wordPattern.setEnabled(enabled);
	filters.alignedWord.setEnabled(enabled);

	filters.speaker.param_setup(params);
}

var session;

function begin_search(s) {
	session = s;
}

var searchTier = "IPA Target";
function query_record(recordIndex, record) {
	var nf = java.text.NumberFormat.getNumberInstance();
	nf.setMinimumFractionDigits(1);
	nf.setMaximumFractionDigits(2);
	// check participant filter
	if (! filters.speaker.check_speaker(record.speaker)) return;

	// check group+groupPattern filters
	var groups = filters.group.getRequestedGroups(record);
	if (filters.groupPattern.isUseFilter()) {
		groups = filters.groupPattern.filter_groups(groups, searchTier);
	}

	// check aligned group for each group returned
	if (filters.alignedGroup.isUseFilter()) {
		groups = filters.alignedGroup.filter_groups(record, groups);
	}

	// perform searches
	for (var i = 0; i &lt; groups.length; i++) {
		var group = groups[i];

		var groupAlignedData = filters.groupTiers.getAlignedTierData(record, group, "Group");

		var groupAlignedResults = groupAlignedData[0];
		var groupAlignedMeta = groupAlignedData[1];

		if (filters.alignedGroup.isUseFilter()) {
			var tierList = new TierList("group");
			tierList.setTiers(filters.alignedGroup.tier);

			var alignedGroupData = tierList.getAlignedTierData(record, group, "Group");
			for(var j = 0; j &lt; alignedGroupData[0].length; j++) {
				groupAlignedResults.push(alignedGroupData[0][j]);
			}
		}

		var toSearch = new Array();
		toSearch.length = 0;
		var selectedWords = filters.word.getRequestedWords(group, searchTier);
		for (j = 0; j &lt; selectedWords.length; j++) {
			var word = selectedWords[j];

			var wordAlignedMeta = new java.util.LinkedHashMap();
			wordAlignedMeta.putAll(groupAlignedMeta);

			var wordAlignedResults = new Array();
			for(var k = 0; k &lt; groupAlignedResults.length; k++) {
				wordAlignedResults.push(groupAlignedResults[k]);
			}

			var wordAlignedData = filters.wordTiers.getAlignedTierData(record, word, "Word");
			for(var k = 0; k &lt; wordAlignedData[0].length; k++) {
				wordAlignedResults.push(wordAlignedData[0][k]);
			}
			wordAlignedMeta.putAll(wordAlignedData[1]);

			var wordIpa = (searchTier == "IPA Target" ? word.IPATarget : word.IPAActual);
			var alignedIpa = (searchTier == "IPA Target" ? word.IPAActual : word.IPATarget);
			var addWord = (wordIpa != null &amp;&amp; wordIpa.length() &gt; 0 &amp;&amp; alignedIpa != null &amp;&amp; alignedIpa.length() &gt; 0);
			// check word pattern if necessary
			if (filters.wordPattern.isUseFilter()) {
				addWord = filters.wordPattern.check_filter(wordIpa);
			}

			// check aligned word pattern if necessary
			if (filters.alignedWord.isUseFilter()) {
				addWord = filters.alignedWord.check_word(word);

				var tierList = new TierList("word");
				tierList.setTiers(filters.alignedWord.tier);

				var alignedWordData = tierList.getAlignedTierData(record, word, "Word");
				for(var k = 0; k &lt; alignedWordData[0].length; k++) {
					wordAlignedResults.push(alignedWordData[0][k]);
				}
			}

			if (addWord == true) {
				toSearch.push([word, wordAlignedResults, wordAlignedMeta]);
			}
		}
		
		for(j = 0; j &lt; toSearch.length; j++) {
			var word = toSearch[j][0];
			var alignedResults = toSearch[j][1];
			var alignedMetadata = toSearch[j][2];
			
			var features = (filters.pcc.pcType.index == 0 ? "c" : "v");
			var pc = Pcc.calc_pc_aligned(word, features, filters.pcc.ignoreDiacritics == true);
			
			var ipaT = (word.IPATarget != null ? word.IPATarget : new IPATranscript());
			var ipaA = (word.IPAActual != null ? word.IPAActual : new IPATranscript());
			
			var result = factory.createResult();
		    result.schema = "ALIGNED";
		    result.recordIndex = recordIndex;

		    var rvt = factory.createResultValue();
		    rvt.tierName = "IPA Target";
	    	rvt.groupIndex = i;
	    	var startIndex = word.getIPATargetWordLocation();
	    	var endIndex = startIndex + ipaT.toString().length();
	    	rvt.range = new Range(startIndex, endIndex, false);
	    	rvt.data = ipaT;
	    	result.addResultValue(rvt);

	    	var rva = factory.createResultValue();
	    	rva.tierName = "IPA Actual";
	    	rva.groupIndex = i;
	    	startIndex = word.getIPAActualWordLocation();
	    	endIndex = startIndex + ipaA.toString().length();
	    	rva.range = new Range(startIndex, endIndex, false);
	    	rva.data = ipaA;
	        result.addResultValue(rva);

			result.metadata.put("# Target", pc.target + "");
			result.metadata.put("# Actual", pc.actual + "");
			result.metadata.put("# Correct", pc.correct + "");
			result.metadata.put("# Substituted", pc.substituted + "");
			result.metadata.put("# Deleted", pc.deleted + "");
			result.metadata.put("# Epenthesized", pc.epen + "");
			
			var pcColName = (filters.pcc.pcType.index == 0 ? "PCC" : "PVC");
			var pcVal = (pc.target &gt; 0 ? ( pc.correct / (pc.correct + pc.substituted + pc.deleted + pc.epen) ): 0) * 100;
			result.metadata.put(pcColName, nf.format(pcVal));

			for(var alignedResultIdx = 0; alignedResultIdx &lt; alignedResults.length; alignedResultIdx++) {
					result.addResultValue(alignedResults[alignedResultIdx]);
			}
		    result.metadata.putAll(alignedMetadata);
		    
		    results.addResult(result);
		}
	}
}
</source>
                    <param id="filters.alignedGroup.patternFilter.filterType">Plain text</param>
                    <param id="filters.alignedWord.patternFilter.filterType">Plain text</param>
                    <param id="filters.groupPattern.filterType">Plain text</param>
                    <param id="filters.pcc.pcType">Percent Consonants Correct (PCC)</param>
                    <param id="filters.wordPattern.filterType">Plain text</param>
                </script>
            </qry:query>
            <extensions>
                <oga:settings/>
                <oga:meta x="452" y="151"/>
            </extensions>
        </opqry:queryNode>
        <node id="10ac3417" name="PCC/PVC" type="class:ca.phon.app.opgraph.nodes.PhonScriptNode">
            <input name="params" optional="false"/>
            <output name="pcType" type="java.lang.String"/>
            <extensions>
                <oga:settings>
                    <oga:property key="__script"><![CDATA[function init(inputs, outputs) {
	inputs.add("params", "", false, false);

	outputs.add("pcType", "", false, java.lang.String);
}

function run(context) {
	var paramMap = context.get("params");

	var pcType = paramMap.get("filters.pcc.pcType");

	if(pcType.index == 0)
		context.put("pcType", "PCC");
	else
		context.put("pcType", "PVC");
}
]]></oga:property>
                </oga:settings>
                <oga:meta x="457" y="365"/>
            </extensions>
        </node>
        <ogcn:macro id="4b18886ea00b48b3" name="Report" type="ca.gedge.opgraph.nodes.general.MacroNode">
            <graph id="1ae94716">
                <node id="e6d45b5e5a1847a0" name="reportTitle" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                    <extensions>
                        <oga:settings>
                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                        </oga:settings>
                        <oga:meta x="42" y="57"/>
                    </extensions>
                </node>
                <node id="1f17ec8476fc478a" name="project" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                    <extensions>
                        <oga:settings>
                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.project.Project]]></oga:property>
                        </oga:settings>
                        <oga:meta x="42" y="158"/>
                    </extensions>
                </node>
                <node id="e6f07f6f7dc34e29" name="results" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                    <extensions>
                        <oga:settings>
                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[[Lca.phon.query.db.ResultSet;]]></oga:property>
                        </oga:settings>
                        <oga:meta x="42" y="399"/>
                    </extensions>
                </node>
                <node id="2ee97062ccbd4ee1" name="selectedSessions" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                    <extensions>
                        <oga:settings>
                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.util.ArrayList]]></oga:property>
                        </oga:settings>
                        <oga:meta x="42" y="500"/>
                    </extensions>
                </node>
                <node id="5f8fe0460f3f4fd8" name="selected participants" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                    <extensions>
                        <oga:settings>
                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.util.ArrayList]]></oga:property>
                        </oga:settings>
                        <oga:meta x="42" y="601"/>
                    </extensions>
                </node>
                <node id="419c72194f554b81" name="script" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                    <extensions>
                        <oga:settings>
                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.script.QueryScript]]></oga:property>
                        </oga:settings>
                        <oga:meta x="42" y="702"/>
                    </extensions>
                </node>
                <node id="9ad0f5182254d47" name="parameters" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                    <extensions>
                        <oga:settings>
                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.util.Map]]></oga:property>
                        </oga:settings>
                        <oga:meta x="42" y="943"/>
                    </extensions>
                </node>
                <node id="51a10b46c3124671" type="class:ca.phon.app.opgraph.nodes.table.ResultsToTableNode">
                    <extensions>
                        <oga:settings>
                            <oga:property key="includeMetadata"><![CDATA[true]]></oga:property>
                            <oga:property key="includeTierInfo"><![CDATA[true]]></oga:property>
                            <oga:property key="includeSpeakerInfo"><![CDATA[true]]></oga:property>
                            <oga:property key="includeSessionInfo"><![CDATA[true]]></oga:property>
                        </oga:settings>
                        <oga:meta x="444" y="182"/>
                    </extensions>
                </node>
                <ogcn:macro id="2fb344a5f7134d66" name="Add Report Title" type="ca.gedge.opgraph.nodes.general.MacroNode">
                    <graph id="5e7352">
                        <node id="24dcc2459a674110" name="arg2" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                </oga:settings>
                                <oga:meta x="15" y="15"/>
                            </extensions>
                        </node>
                        <node id="e0b49afb70b3431d" name="obj" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.util.Map]]></oga:property>
                                </oga:settings>
                                <oga:meta x="15" y="146"/>
                            </extensions>
                        </node>
                        <node id="ee0adfb7bc4c4047" name="reportTitle (key)" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                </oga:settings>
                                <oga:meta x="15" y="241">
                                    <oga:default for="obj" type="java.lang.String">reportTitle</oga:default>
                                </oga:meta>
                            </extensions>
                        </node>
                        <node id="ed88f7744fd4f41" name="Map" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.util.Map]]></oga:property>
                                </oga:settings>
                                <oga:meta x="266" y="195"/>
                            </extensions>
                        </node>
                        <node id="8300eeea09154a85" name="Map#put(Object,Object)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[put(java.lang.Object,java.lang.Object)]]></oga:property>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.util.Map]]></oga:property>
                                </oga:settings>
                                <oga:meta x="278" y="64"/>
                            </extensions>
                        </node>
                        <link dest="8300eeea09154a85" destField="obj" source="ed88f7744fd4f41" sourceField="obj"/>
                        <link dest="8300eeea09154a85" destField="arg1" source="ee0adfb7bc4c4047" sourceField="obj"/>
                        <link dest="ed88f7744fd4f41" destField="obj" source="e0b49afb70b3431d" sourceField="obj"/>
                        <link dest="8300eeea09154a85" destField="arg2" source="24dcc2459a674110" sourceField="obj"/>
                    </graph>
                    <ogcn:published_input field="obj" name="parameters" ref="e0b49afb70b3431d"/>
                    <ogcn:published_input field="obj" name="reportTitle" ref="24dcc2459a674110"/>
                    <ogcn:published_output field="obj" name="obj" ref="ed88f7744fd4f41"/>
                    <extensions>
                        <oga:meta x="454" y="405"/>
                    </extensions>
                </ogcn:macro>
                <ogcn:macro id="cd24c50e7acb44b8" name="Create Summary Table" type="ca.gedge.opgraph.nodes.general.MacroNode">
                    <graph id="1cd3418a">
                        <node id="a18968db51fa4ad9" name="reportTitle" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                </oga:settings>
                                <oga:meta x="42" y="57"/>
                            </extensions>
                        </node>
                        <node id="52a626dfea184936" name="DefaultTableDataSource#&lt;init&gt;()" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>()]]></oga:property>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                </oga:settings>
                                <oga:meta x="308" y="102"/>
                            </extensions>
                        </node>
                        <node id="48d43f4045d34aff" name="Setup Column Names" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                            <input name="title" optional="false"/>
                            <extensions>
                                <oga:settings>
                                    <oga:property key="__script"><![CDATA[function init(inputs, outputs) {
	inputs.add("title", "", false, false);
}

function tableOp(context, table) {
	// add headers to table
	var rowIdx = 0;

	table.setColumnTitle(rowIdx++, "Speaker");
	table.setColumnTitle(rowIdx++, "Role");
	table.setColumnTitle(rowIdx++, "# Target");
	table.setColumnTitle(rowIdx++, "# Correct");
	table.setColumnTitle(rowIdx++, "# Substituted");
	table.setColumnTitle(rowIdx++, "# Deleted");
	table.setColumnTitle(rowIdx++, "# Epenthesized");
	table.setColumnTitle(rowIdx++, context.get("title"));
}
]]></oga:property>
                                </oga:settings>
                                <oga:meta x="642" y="120"/>
                            </extensions>
                        </node>
                        <link dest="48d43f4045d34aff" destField="table" source="52a626dfea184936" sourceField="value"/>
                        <link dest="48d43f4045d34aff" destField="title" source="a18968db51fa4ad9" sourceField="obj"/>
                        <extensions>
                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                            <oga:notes>
                                <oga:note color="0xffff96" height="292" title="Inputs" width="233" x="17" y="15"/>
                            </oga:notes>
                        </extensions>
                    </graph>
                    <ogcn:published_input field="obj" name="title" ref="a18968db51fa4ad9"/>
                    <ogcn:published_output field="table" name="table" ref="48d43f4045d34aff"/>
                    <extensions>
                        <oga:meta x="558" y="541"/>
                    </extensions>
                </ogcn:macro>
                <node id="ff306d8463c54561" name="Split Table by Speaker" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                    <output name="keySet" type="java.util.Set">Unique values from given column name</output>
                    <output name="tableMap" type="java.util.Map">Map of key -&gt; table values</output>
                    <extensions>
                        <oga:settings>
                            <oga:property key="columnName"><![CDATA[Speaker]]></oga:property>
                            <oga:property key="__script"><![CDATA[/*
 * Phon - An open source tool for research in phonology.
 * Copyright (C) 2005 - 2017, Gregory Hedlund <ghedlund@mun.ca> and Yvan Rose <yrose@mun.ca>
 * Dept of Linguistics, Memorial University <https://phon.ca>
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

 /**
  * Split Table.js
  *
  * Script for use with ca.phon.app.opgraph.nodes.table.TableScriptNode
  *
  * Split table based on column name.  Two outputs
  * are produced, a set of keys from the column used in the filter  and a
  * map of key -> table values.
  */

var columnParamInfo = {
	"id": "columnName",
	"title": "Column Name",
	"def": "",
	"prompt": "Enter column name"
}

function setup_params(params) {
	var columnParam = new StringScriptParam(
		columnParamInfo.id,
		columnParamInfo.title,
		columnParamInfo.def);
	columnParam.setPrompt(columnParamInfo.prompt);
	params.add(columnParam);
}

// add custom inputs/outputs here
function init(inputs, outputs) {
	outputs.add("keySet", "Unique values from given column name", false, java.util.Set);
	outputs.add("tableMap", "Map of key -> table values", false, java.util.Map);
}

/*
 * Create a new table with the same schema as the inputTable
 */
function setupTable(inputTable) {
    var table = new DefaultTableDataSource();
    for(c = 0; c < inputTable.columnCount; c++) {
	    var colTitle = inputTable.getColumnTitle(c);
	    table.setColumnTitle(c, colTitle);
	}
	return table;
}

// run operation on table
function tableOp(context, table) {
	// find table column index
	col = table.getColumnIndex(columnName);

	if(col < 0)
		return; // column not found

	var tableMap = new java.util.LinkedHashMap();

	for(row = 0; row < table.rowCount; row++) {
	    // use string value as row key
		var rowKey = Packages.ca.phon.formatter.FormatterUtil.format(table.getValueAt(row, col));

		var keyTable = tableMap.get(rowKey);
		if(keyTable == null) {
		    keyTable = setupTable(table);
		    tableMap.put(rowKey, keyTable);
		}
		keyTable.addRow(table.getRow(row));
	}

	context.put("keySet", tableMap.keySet());
	context.put("tableMap", tableMap);
}
]]></oga:property>
                        </oga:settings>
                        <oga:meta x="621" y="183"/>
                    </extensions>
                </node>
                <ogcn:macro id="af8397839e8a46c1" name="Start Report Template" type="ca.gedge.opgraph.nodes.general.MacroNode">
                    <graph id="762b7bab">
                        <ogcn:macro id="8a1920e5273e42ef" name="Get Process Name" type="ca.gedge.opgraph.nodes.general.MacroNode">
                            <graph id="4d4c6298">
                                <node id="6388682d8a0d413c" name="String#&lt;init&gt;(String)" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>(java.lang.String)]]></oga:property>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="78" y="88">
                                            <oga:default for="arg1" type="java.lang.String">reportTitle</oga:default>
                                        </oga:meta>
                                    </extensions>
                                </node>
                                <node id="86de575faae74729" name="Map#get(Object)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[get(java.lang.Object)]]></oga:property>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.util.Map]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="236" y="91"/>
                                    </extensions>
                                </node>
                                <node id="644415a658d2491d" name="Object#toString()" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[toString()]]></oga:property>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.Object]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="393" y="100"/>
                                    </extensions>
                                </node>
                                <link dest="86de575faae74729" destField="arg1" source="6388682d8a0d413c" sourceField="value"/>
                                <link dest="644415a658d2491d" destField="obj" source="86de575faae74729" sourceField="value"/>
                            </graph>
                            <ogcn:published_input field="obj" name="parameters" ref="86de575faae74729"/>
                            <ogcn:published_output field="value" name="value" ref="644415a658d2491d"/>
                            <extensions>
                                <oga:meta x="364" y="569"/>
                            </extensions>
                        </ogcn:macro>
                        <node id="141f0fb5420e4034" type="class:ca.phon.app.opgraph.nodes.log.PrintScriptParameters">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="includes"><![CDATA[@General]]></oga:property>
                                    <oga:property key="printOnlyChanged"><![CDATA[true]]></oga:property>
                                    <oga:property key="excludes"><![CDATA[@Participant Filter]]></oga:property>
                                </oga:settings>
                                <oga:meta x="333" y="708"/>
                            </extensions>
                        </node>
                        <node id="ae8e94cd4d43448e" name="Add to Report Template" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                            <input name="data" optional="false">Data to print</input>
                            <extensions>
                                <oga:settings>
                                    <oga:property key="dataTemplate"><![CDATA[
#h1("$DATA")
]]></oga:property>
                                    <oga:property key="showText"><![CDATA[true]]></oga:property>
                                    <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                </oga:settings>
                                <oga:meta x="558" y="560">
                                    <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                    <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                </oga:meta>
                            </extensions>
                        </node>
                        <node id="4946309cf7e840ef" name="Add to Report Template" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                            <input name="data" optional="false">Data to print</input>
                            <extensions>
                                <oga:settings>
                                    <oga:property key="dataTemplate"><![CDATA[
#h2("Parameters")

$DATA
]]></oga:property>
                                    <oga:property key="showText"><![CDATA[true]]></oga:property>
                                    <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                </oga:settings>
                                <oga:meta x="564" y="704">
                                    <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                    <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                </oga:meta>
                            </extensions>
                        </node>
                        <link dest="ae8e94cd4d43448e" destField="data" source="8a1920e5273e42ef" sourceField="value"/>
                        <link dest="4946309cf7e840ef" destField="data" source="141f0fb5420e4034" sourceField="text"/>
                        <extensions>
                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                        </extensions>
                    </graph>
                    <ogcn:published_input field="parameters" name="parameters" ref="8a1920e5273e42ef"/>
                    <ogcn:published_input field="script" name="script" ref="141f0fb5420e4034"/>
                    <extensions>
                        <oga:meta x="654" y="418"/>
                    </extensions>
                </ogcn:macro>
                <ogcn:macro id="9be63edf7454f48" name="For Each Participant" type="ca.gedge.opgraph.nodes.reflect.IterableClassNode">
                    <graph id="6e34d624">
                        <node id="f07c16119afe452e" name="Current Object" type="class:ca.gedge.opgraph.nodes.reflect.ContextualItemClassNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ContextualItemClassNode.key"><![CDATA[currentValue]]></oga:property>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ContextualItemClassNode.declaredClass"><![CDATA[java.lang.Object]]></oga:property>
                                </oga:settings>
                                <oga:meta x="48" y="48"/>
                            </extensions>
                        </node>
                        <node id="cd7f2adfba34488c" name="Table Map" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.util.Map]]></oga:property>
                                </oga:settings>
                                <oga:meta x="68" y="208"/>
                            </extensions>
                        </node>
                        <node id="28e03ab509b94a85" name="Selected Sessions" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.util.ArrayList]]></oga:property>
                                    <oga:property key="contextKey"><![CDATA[_selectedSessions]]></oga:property>
                                </oga:settings>
                                <oga:meta x="69" y="310"/>
                            </extensions>
                        </node>
                        <node id="6b15e246103847d5" name="reportTitle" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                </oga:settings>
                                <oga:meta x="67" y="406"/>
                            </extensions>
                        </node>
                        <node id="54074bf3" name="Global Summary" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.TableDataSource]]></oga:property>
                                </oga:settings>
                                <oga:meta x="47" y="533"/>
                            </extensions>
                        </node>
                        <node id="6e7dac5ad324dd0" name="To Participant Object" type="class:ca.gedge.opgraph.nodes.reflect.ObjectCastNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectCastNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                </oga:settings>
                                <oga:meta x="224" y="49"/>
                            </extensions>
                        </node>
                        <ogcn:macro id="ad6397d3e8824ec1" name="Create Summary Table" type="ca.gedge.opgraph.nodes.general.MacroNode">
                            <graph id="6e6561b1">
                                <node id="3fb9b50c0c3a4b9d" name="reportTitle" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="42" y="57"/>
                                    </extensions>
                                </node>
                                <node id="fd6d7175c36a4295" name="DefaultTableDataSource#&lt;init&gt;()" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>()]]></oga:property>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="308" y="102"/>
                                    </extensions>
                                </node>
                                <node id="3bb58550f8704d45" name="Setup Column Names" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                    <input name="title" optional="false"/>
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="__script"><![CDATA[function init(inputs, outputs) {
	inputs.add("title", "", false, false);
}

function tableOp(context, table) {
	// add headers to table
	table.setColumnTitle(0, "Session");
	table.setColumnTitle(1, "Role");
	table.setColumnTitle(2, "Age");
	table.setColumnTitle(3, "# Target");
	table.setColumnTitle(4, "# Correct");
	table.setColumnTitle(5, "# Substituted");
	table.setColumnTitle(6, "# Deleted");
	table.setColumnTitle(7, "# Epenthesized");
	table.setColumnTitle(8, context.get("title"));
}
]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="643" y="120"/>
                                    </extensions>
                                </node>
                                <link dest="3bb58550f8704d45" destField="table" source="fd6d7175c36a4295" sourceField="value"/>
                                <link dest="3bb58550f8704d45" destField="title" source="3fb9b50c0c3a4b9d" sourceField="obj"/>
                                <extensions>
                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                    <oga:notes>
                                        <oga:note color="0xffff96" height="292" title="Inputs" width="233" x="17" y="15"/>
                                    </oga:notes>
                                </extensions>
                            </graph>
                            <ogcn:published_input field="obj" name="title" ref="3fb9b50c0c3a4b9d"/>
                            <ogcn:published_output field="table" name="table" ref="3bb58550f8704d45"/>
                            <extensions>
                                <oga:meta x="472" y="439"/>
                            </extensions>
                        </ogcn:macro>
                        <ogcn:macro id="cb86895b929e40c4" name="Get Table of Results For Speaker" type="ca.gedge.opgraph.nodes.general.MacroNode">
                            <graph id="497f3d93">
                                <node id="709f2e57dcf44ec5" name="Object#toString()" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[toString()]]></oga:property>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.Object]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="105" y="70"/>
                                    </extensions>
                                </node>
                                <node id="d091a8618f89491c" name="Map#get(Object)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[get(java.lang.Object)]]></oga:property>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.util.Map]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="296" y="73"/>
                                    </extensions>
                                </node>
                                <node id="b058aa205ed8417b" type="class:ca.phon.app.opgraph.nodes.PhonScriptNode">
                                    <output name="exists" type="java.lang.Boolean">does table exist</output>
                                    <output name="table" type="ca.phon.query.report.datasource.DefaultTableDataSource">table if exists, undefined otherwise</output>
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="__script"><![CDATA[
// setup input/output fields
function init(inputFields, outputFields) {
	inputFields.add("table", "");
	outputFields.add("exists", "does table exist", false, java.lang.Boolean);
	outputFields.add("table", "table if exists, undefined otherwise", false, Packages.ca.phon.query.report.datasource.DefaultTableDataSource);
}

function run(context) {
	var tableExists =
		(context.containsKey("table") && context.get("table") != null);
	context.put("exists", tableExists);
	context.put("table", context.get("table"));
}
]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="514" y="94"/>
                                    </extensions>
                                </node>
                                <link dest="d091a8618f89491c" destField="arg1" source="709f2e57dcf44ec5" sourceField="value"/>
                                <link dest="b058aa205ed8417b" destField="table" source="d091a8618f89491c" sourceField="value"/>
                                <extensions>
                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                </extensions>
                            </graph>
                            <ogcn:published_input field="obj" name="speaker" ref="709f2e57dcf44ec5"/>
                            <ogcn:published_input field="obj" name="tableMap" ref="d091a8618f89491c"/>
                            <ogcn:published_output field="exists" name="exists" ref="b058aa205ed8417b"/>
                            <ogcn:published_output field="table" name="table" ref="b058aa205ed8417b"/>
                            <extensions>
                                <oga:meta x="506" y="127"/>
                            </extensions>
                        </ogcn:macro>
                        <ogcn:macro id="f597c5aaf39b442f" name="If Speaker has Results" type="ca.gedge.opgraph.nodes.general.MacroNode">
                            <graph id="56ca8bb4">
                                <node id="d779e16362c04d76" name="Table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="100" y="212"/>
                                    </extensions>
                                </node>
                                <node id="73c243ff96eb4831" name="Selected Sessions" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.util.ArrayList]]></oga:property>
                                            <oga:property key="contextKey"><![CDATA[_selectedSessions]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="109" y="362"/>
                                    </extensions>
                                </node>
                                <node id="649d8eae5b4744b8" name="Participant" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="102" y="478"/>
                                    </extensions>
                                </node>
                                <node id="4fc833bd97444fd0" name="Summary Table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.TableDataSource]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="102" y="766"/>
                                    </extensions>
                                </node>
                                <node id="d29e473601c74d07" name="Split Table by Session" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                    <output name="keySet" type="java.util.Set">Unique values from given column name</output>
                                    <output name="tableMap" type="java.util.Map">Map of key -&gt; table values</output>
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="columnName"><![CDATA[Session]]></oga:property>
                                            <oga:property key="__script"><![CDATA[/*
 * Phon - An open source tool for research in phonology.
 * Copyright (C) 2005 - 2017, Gregory Hedlund <ghedlund@mun.ca> and Yvan Rose <yrose@mun.ca>
 * Dept of Linguistics, Memorial University <https://phon.ca>
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

 /**
  * Split Table.js
  *
  * Script for use with ca.phon.app.opgraph.nodes.table.TableScriptNode
  *
  * Split table based on column name.  Two outputs
  * are produced, a set of keys from the column used in the filter  and a
  * map of key -> table values.
  */

var columnParamInfo = {
	"id": "columnName",
	"title": "Column Name",
	"def": "",
	"prompt": "Enter column name"
}

function setup_params(params) {
	var columnParam = new StringScriptParam(
		columnParamInfo.id,
		columnParamInfo.title,
		columnParamInfo.def);
	columnParam.setPrompt(columnParamInfo.prompt);
	params.add(columnParam);
}

// add custom inputs/outputs here
function init(inputs, outputs) {
	outputs.add("keySet", "Unique values from given column name", false, java.util.Set);
	outputs.add("tableMap", "Map of key -> table values", false, java.util.Map);
}

/*
 * Create a new table with the same schema as the inputTable
 */
function setupTable(inputTable) {
    var table = new DefaultTableDataSource();
    for(c = 0; c < inputTable.columnCount; c++) {
	    var colTitle = inputTable.getColumnTitle(c);
	    table.setColumnTitle(c, colTitle);
	}
	return table;
}

// run operation on table
function tableOp(context, table) {
	// find table column index
	col = table.getColumnIndex(columnName);

	if(col < 0)
		return; // column not found

	var tableMap = new java.util.LinkedHashMap();

	for(row = 0; row < table.rowCount; row++) {
	    // use string value as row key
		var rowKey = Packages.ca.phon.formatter.FormatterUtil.format(table.getValueAt(row, col));

		var keyTable = tableMap.get(rowKey);
		if(keyTable == null) {
		    keyTable = setupTable(table);
		    tableMap.put(rowKey, keyTable);
		}
		keyTable.addRow(table.getRow(row));
	}

	context.put("keySet", tableMap.keySet());
	context.put("tableMap", tableMap);
}
]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="505" y="399"/>
                                    </extensions>
                                </node>
                                <ogcn:macro id="44ede451a63843e8" name="For Each Session" type="ca.gedge.opgraph.nodes.reflect.IterableClassNode">
                                    <graph id="6394e510">
                                        <node id="f87a720cdb874d57" name="Current Object" type="class:ca.gedge.opgraph.nodes.reflect.ContextualItemClassNode">
                                            <extensions>
                                                <oga:settings>
                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ContextualItemClassNode.key"><![CDATA[currentValue]]></oga:property>
                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ContextualItemClassNode.declaredClass"><![CDATA[java.lang.Object]]></oga:property>
                                                </oga:settings>
                                                <oga:meta x="37" y="43"/>
                                            </extensions>
                                        </node>
                                        <node id="ad55e9b9a5874167" name="Table Map" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                            <extensions>
                                                <oga:settings>
                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.util.Map]]></oga:property>
                                                </oga:settings>
                                                <oga:meta x="64" y="267"/>
                                            </extensions>
                                        </node>
                                        <node id="d3d3798922cc4b34" name="Participant" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                            <extensions>
                                                <oga:settings>
                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                </oga:settings>
                                                <oga:meta x="59" y="372"/>
                                            </extensions>
                                        </node>
                                        <node id="2a7937ee37704241" name="Summary Table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                            <extensions>
                                                <oga:settings>
                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.TableDataSource]]></oga:property>
                                                </oga:settings>
                                                <oga:meta x="72" y="674"/>
                                            </extensions>
                                        </node>
                                        <node id="15af4b21486c49ee" name="Object#toString()" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                            <extensions>
                                                <oga:settings>
                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[toString()]]></oga:property>
                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.Object]]></oga:property>
                                                </oga:settings>
                                                <oga:meta x="220" y="71"/>
                                            </extensions>
                                        </node>
                                        <ogcn:macro id="71b15afc5b9d47f5" name="Get Table for Session" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                            <graph id="525b0eda">
                                                <node id="257ee0628b94c4f" name="Map" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.util.Map]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="244" y="68"/>
                                                    </extensions>
                                                </node>
                                                <node id="2e1f6fe75c6242f9" name="Map#get(Object)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[get(java.lang.Object)]]></oga:property>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.util.Map]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="401" y="69"/>
                                                    </extensions>
                                                </node>
                                                <node id="2ee1606c76ae4be8" type="class:ca.phon.app.opgraph.nodes.PhonScriptNode">
                                                    <output name="exists" type="java.lang.Boolean">does table exist</output>
                                                    <output name="table" type="ca.phon.query.report.datasource.DefaultTableDataSource">table if exists, undefined otherwise</output>
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="__script"><![CDATA[
// setup input/output fields
function init(inputFields, outputFields) {
	inputFields.add("table", "");
	outputFields.add("exists", "does table exist", false, java.lang.Boolean);
	outputFields.add("table", "table if exists, undefined otherwise", false, Packages.ca.phon.query.report.datasource.DefaultTableDataSource);
}

function run(context) {
	var tableExists =
		(context.containsKey("table") && context.get("table") != null);
	context.put("exists", tableExists);
	context.put("table", context.get("table"));
}
]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="555" y="73"/>
                                                    </extensions>
                                                </node>
                                                <link dest="2e1f6fe75c6242f9" destField="obj" source="257ee0628b94c4f" sourceField="obj"/>
                                                <link dest="2ee1606c76ae4be8" destField="table" source="2e1f6fe75c6242f9" sourceField="value"/>
                                            </graph>
                                            <ogcn:published_input field="arg1" name="sessionName" ref="2e1f6fe75c6242f9"/>
                                            <ogcn:published_input field="obj" name="tableMap" ref="257ee0628b94c4f"/>
                                            <ogcn:published_output field="exists" name="exists" ref="2ee1606c76ae4be8"/>
                                            <ogcn:published_output field="table" name="table" ref="2ee1606c76ae4be8"/>
                                            <extensions>
                                                <oga:meta x="413" y="110"/>
                                            </extensions>
                                        </ogcn:macro>
                                        <node id="f84bd533e334a96" name="Add to Breakdown Template" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                            <input name="data" optional="false">Data to print</input>
                                            <extensions>
                                                <oga:settings>
                                                    <oga:property key="dataTemplate"><![CDATA[
#set($sessionPath = "$DATA")
]]></oga:property>
                                                    <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                    <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                </oga:settings>
                                                <oga:meta x="606" y="397">
                                                    <oga:default for="buffer" type="java.lang.String">Breakdown Template</oga:default>
                                                    <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                </oga:meta>
                                            </extensions>
                                        </node>
                                        <ogcn:macro id="73704a9fac14603" name="If Speaker has Results for Session" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                            <graph id="5bad23bb">
                                                <node id="c15eafc9d07d4fa3" name="DefaultTableDataSource" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                                            <oga:property key="contextKey"/>
                                                        </oga:settings>
                                                        <oga:meta x="57" y="208"/>
                                                    </extensions>
                                                </node>
                                                <node id="306bcfa090b84bff" name="Participant" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="56" y="344"/>
                                                    </extensions>
                                                </node>
                                                <node id="c54d27d196374d69" name="Session Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.Object]]></oga:property>
                                                            <oga:property key="contextKey"/>
                                                        </oga:settings>
                                                        <oga:meta x="65" y="643"/>
                                                    </extensions>
                                                </node>
                                                <node id="69075d7f53bc45c9" name="Summary Table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.TableDataSource]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="60" y="728"/>
                                                    </extensions>
                                                </node>
                                                <ogcn:macro id="c515d6f2dfe84bee" name="Setup Buffer Name" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                    <graph id="75993ec9">
                                                        <node id="9e382cb0a6764113" name="StringBuffer#&lt;init&gt;()" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>()]]></oga:property>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="305" y="167"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="8a3e5529d8d04b63" name="String#&lt;init&gt;(String)" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>(java.lang.String)]]></oga:property>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="311" y="242"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="9dd0c70733b84ce5" name="Object#toString()" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[toString()]]></oga:property>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.Object]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="322" y="495"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="1aaa934ca0684ef3" name="StringBuffer#append(String)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[append(java.lang.String)]]></oga:property>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="483" y="170">
                                                                    <oga:default for="arg1" type="java.lang.String"/>
                                                                </oga:meta>
                                                            </extensions>
                                                        </node>
                                                        <node id="f733a1f64f2847ca" name="StringBuffer#append(String)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[append(java.lang.String)]]></oga:property>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="738" y="210">
                                                                    <oga:default for="arg1" type="java.lang.String">_</oga:default>
                                                                </oga:meta>
                                                            </extensions>
                                                        </node>
                                                        <node id="52bcb70619b84d23" name="StringBuffer#append(Object)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[append(java.lang.Object)]]></oga:property>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="490" y="277"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="4081c160fa5d4797" name="StringBuffer#append(String)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[append(java.lang.String)]]></oga:property>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="497" y="384">
                                                                    <oga:default for="arg1" type="java.lang.String">_</oga:default>
                                                                </oga:meta>
                                                            </extensions>
                                                        </node>
                                                        <node id="c28f6e68e4c94a4a" name="StringBuffer#append(String)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[append(java.lang.String)]]></oga:property>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="497" y="488">
                                                                    <oga:default for="arg1" type="java.lang.String"/>
                                                                </oga:meta>
                                                            </extensions>
                                                        </node>
                                                        <node id="9257b9443a86419a" name="StringBuffer#toString()" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[toString()]]></oga:property>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="721" y="496"/>
                                                            </extensions>
                                                        </node>
                                                        <link dest="1aaa934ca0684ef3" destField="obj" source="9e382cb0a6764113" sourceField="value"/>
                                                        <link dest="c28f6e68e4c94a4a" destField="obj" source="4081c160fa5d4797" sourceField="value"/>
                                                        <link dest="c28f6e68e4c94a4a" destField="arg1" source="9dd0c70733b84ce5" sourceField="value"/>
                                                        <link dest="9257b9443a86419a" destField="obj" source="c28f6e68e4c94a4a" sourceField="value"/>
                                                        <link dest="1aaa934ca0684ef3" destField="arg1" source="8a3e5529d8d04b63" sourceField="value"/>
                                                        <link dest="4081c160fa5d4797" destField="obj" source="52bcb70619b84d23" sourceField="value"/>
                                                        <link dest="f733a1f64f2847ca" destField="obj" source="1aaa934ca0684ef3" sourceField="value"/>
                                                        <link dest="52bcb70619b84d23" destField="obj" source="f733a1f64f2847ca" sourceField="value"/>
                                                    </graph>
                                                    <ogcn:published_input field="obj" name="sessionName" ref="9dd0c70733b84ce5"/>
                                                    <ogcn:published_input field="arg1" name="tableName" ref="8a3e5529d8d04b63"/>
                                                    <ogcn:published_input field="arg1" name="speaker" ref="52bcb70619b84d23"/>
                                                    <ogcn:published_output field="value" name="value" ref="9257b9443a86419a"/>
                                                    <extensions>
                                                        <oga:meta x="442" y="228">
                                                            <oga:default for="tableName" type="java.lang.String">Phone Clusters</oga:default>
                                                        </oga:meta>
                                                    </extensions>
                                                </ogcn:macro>
                                                <node id="73cb1a76b3ae4818" name="Add row to Session Summary" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                    <input name="speaker" optional="false">speaker</input>
                                                    <input name="sessionPath" optional="false">session</input>
                                                    <input name="resultTable" optional="false"/>
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="__script"><![CDATA[importClass(java.lang.Integer)
importClass(java.lang.Float)

function init(inputs, outputs) {
	inputs.add("speaker", "speaker", false, false);
	inputs.add("sessionPath", "session", false, false);
	inputs.add("resultTable", "", false, false);
}

function tableOp(context, table) {
	var row = [];

	var speaker = context.get("speaker");
	var sessionPath = context.get("sessionPath");
	var resultTable = context.get("resultTable");
	var history = speaker.getExtension(Packages.ca.phon.project.ParticipantHistory);

	var idx = 0;
	row[idx++] = sessionPath;
	row[idx++] = speaker.role;
	row[idx++] = history.getAgeForSession(sessionPath);

	// [target, correct, sub, del, epen]
	var pc = [0, 0, 0, 0, 0];
	for(var i = 0; i < resultTable.rowCount; i++) {
		pc[0] += Integer.parseInt(resultTable.getValueAt(i, "# Target"));
		pc[1] += Integer.parseInt(resultTable.getValueAt(i, "# Correct"));
		pc[2] += Integer.parseInt(resultTable.getValueAt(i, "# Substituted"));
		pc[3] += Integer.parseInt(resultTable.getValueAt(i, "# Deleted"));
		pc[4] += Integer.parseInt(resultTable.getValueAt(i, "# Epenthesized")); 
	}

	var pcc = (pc[0] > 0 ? (pc[1] / (pc[1]+pc[2]+pc[3]+pc[4])) : 0) * 100.0;

	row[idx++] = new Integer(pc[0]);
	row[idx++] = new Integer(pc[1]);
	row[idx++] = new Integer(pc[2]);
	row[idx++] = new Integer(pc[3]);
	row[idx++] = new Integer(pc[4]);
	row[idx++] = new Float(pcc);
	
	table.addRow(row);
}
]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="519" y="510"/>
                                                    </extensions>
                                                </node>
                                                <node id="8273012e69ab47ff" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                    <input name="data" optional="false">Data to print</input>
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="dataTemplate"><![CDATA[$DATA]]></oga:property>
                                                            <oga:property key="showText"><![CDATA[false]]></oga:property>
                                                            <oga:property key="showTable"><![CDATA[true]]></oga:property>
                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="675" y="234"/>
                                                    </extensions>
                                                </node>
                                                <ogcn:macro id="a1ffd8cd315f4597" name="Add to Breakdown Template" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                    <graph id="f3e7840">
                                                        <node id="119eed14b8845c5" name="Set Caption" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                            <input name="data" optional="false">Data to print</input>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="dataTemplate"><![CDATA[#set($caption = "<h3>$DATA@" + $sessionPath + "</h3>")]]></oga:property>
                                                                    <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                    <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="15">
                                                                    <oga:default for="buffer" type="java.lang.String">Breakdown Template</oga:default>
                                                                    <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                </oga:meta>
                                                            </extensions>
                                                        </node>
                                                        <node id="6111ee756fd54a31" name="Add to Breakdown Template" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                            <input name="data" optional="false">Data to print</input>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="dataTemplate"><![CDATA[
#set($tableName = "$DATA")
#if($tables.containsKey($tableName))
#set($table = $tables.get($tableName))
#printTableWithIdAndCaptionExcludingColumns( $table $tableName $caption ["Session", "Date", "Speaker", "Age", "Group #", "Tier", "Range", "Result"] )
#else
$caption

No Results
#end
]]></oga:property>
                                                                    <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                    <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="23" y="142">
                                                                    <oga:default for="buffer" type="java.lang.String">Breakdown Template</oga:default>
                                                                    <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                </oga:meta>
                                                            </extensions>
                                                        </node>
                                                        <extensions>
                                                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                        </extensions>
                                                    </graph>
                                                    <ogcn:published_input field="data" name="bufferName" ref="6111ee756fd54a31"/>
                                                    <ogcn:published_input field="data" name="speaker" ref="119eed14b8845c5"/>
                                                    <extensions>
                                                        <oga:meta x="671" y="378"/>
                                                    </extensions>
                                                </ogcn:macro>
                                                <link dest="c515d6f2dfe84bee" destField="sessionName" source="c54d27d196374d69" sourceField="obj"/>
                                                <link dest="c515d6f2dfe84bee" destField="speaker" source="306bcfa090b84bff" sourceField="obj"/>
                                                <link dest="8273012e69ab47ff" destField="buffer" source="c515d6f2dfe84bee" sourceField="value"/>
                                                <link dest="8273012e69ab47ff" destField="data" source="c15eafc9d07d4fa3" sourceField="obj"/>
                                                <link dest="73cb1a76b3ae4818" destField="sessionPath" source="c54d27d196374d69" sourceField="obj"/>
                                                <link dest="73cb1a76b3ae4818" destField="table" source="69075d7f53bc45c9" sourceField="obj"/>
                                                <link dest="73cb1a76b3ae4818" destField="speaker" source="306bcfa090b84bff" sourceField="obj"/>
                                                <link dest="a1ffd8cd315f4597" destField="speaker" source="306bcfa090b84bff" sourceField="obj"/>
                                                <link dest="a1ffd8cd315f4597" destField="bufferName" source="8273012e69ab47ff" sourceField="buffer"/>
                                                <link dest="73cb1a76b3ae4818" destField="resultTable" source="c15eafc9d07d4fa3" sourceField="obj"/>
                                                <extensions>
                                                    <oga:notes>
                                                        <oga:note color="0xffff96" height="697" title="Published Inputs" width="291" x="36" y="150"/>
                                                    </oga:notes>
                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                </extensions>
                                            </graph>
                                            <ogcn:published_input field="obj" name="table" ref="c15eafc9d07d4fa3"/>
                                            <ogcn:published_input field="obj" name="speaker" ref="306bcfa090b84bff"/>
                                            <ogcn:published_input field="obj" name="sessionName" ref="c54d27d196374d69"/>
                                            <ogcn:published_input field="obj" name="summaryTable" ref="69075d7f53bc45c9"/>
                                            <extensions>
                                                <oga:meta x="604" y="100"/>
                                            </extensions>
                                        </ogcn:macro>
                                        <link dest="71b15afc5b9d47f5" destField="tableMap" source="ad55e9b9a5874167" sourceField="obj"/>
                                        <link dest="73704a9fac14603" destField="table" source="71b15afc5b9d47f5" sourceField="table"/>
                                        <link dest="73704a9fac14603" destField="speaker" source="d3d3798922cc4b34" sourceField="obj"/>
                                        <link dest="73704a9fac14603" destField="sessionName" source="f87a720cdb874d57" sourceField="obj"/>
                                        <link dest="73704a9fac14603" destField="enabled" source="71b15afc5b9d47f5" sourceField="exists"/>
                                        <link dest="15af4b21486c49ee" destField="obj" source="f87a720cdb874d57" sourceField="obj"/>
                                        <link dest="71b15afc5b9d47f5" destField="sessionName" source="15af4b21486c49ee" sourceField="value"/>
                                        <link dest="73704a9fac14603" destField="summaryTable" source="2a7937ee37704241" sourceField="obj"/>
                                        <link dest="f84bd533e334a96" destField="data" source="15af4b21486c49ee" sourceField="value"/>
                                        <extensions>
                                            <oga:notes>
                                                <oga:note color="0xffff96" height="620" title="Published Inputs" width="274" x="33" y="200"/>
                                                <oga:note color="0xffc864" height="244" title="Report Template" width="317" x="569" y="350"/>
                                            </oga:notes>
                                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                        </extensions>
                                    </graph>
                                    <ogcn:published_input field="obj" name="tableMap" ref="ad55e9b9a5874167"/>
                                    <ogcn:published_input field="obj" name="speaker" ref="d3d3798922cc4b34"/>
                                    <ogcn:published_input field="obj" name="summaryTable" ref="2a7937ee37704241"/>
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.IterableClassNode.className"><![CDATA[java.util.ArrayList]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="756" y="401"/>
                                    </extensions>
                                </ogcn:macro>
                                <link dest="d29e473601c74d07" destField="table" source="d779e16362c04d76" sourceField="obj"/>
                                <link dest="44ede451a63843e8" destField="collection" source="73c243ff96eb4831" sourceField="obj"/>
                                <link dest="44ede451a63843e8" destField="tableMap" source="d29e473601c74d07" sourceField="tableMap"/>
                                <link dest="44ede451a63843e8" destField="speaker" source="649d8eae5b4744b8" sourceField="obj"/>
                                <link dest="44ede451a63843e8" destField="summaryTable" source="4fc833bd97444fd0" sourceField="obj"/>
                                <extensions>
                                    <oga:notes>
                                        <oga:note color="0xffff96" height="705" title="Published Inputs" width="286" x="54" y="167"/>
                                    </oga:notes>
                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                </extensions>
                            </graph>
                            <ogcn:published_input field="obj" name="table" ref="d779e16362c04d76"/>
                            <ogcn:published_input field="obj" name="selectedSessions" ref="73c243ff96eb4831"/>
                            <ogcn:published_input field="obj" name="speaker" ref="649d8eae5b4744b8"/>
                            <ogcn:published_input field="obj" name="summaryTable" ref="4fc833bd97444fd0"/>
                            <ogcn:published_output field="collection" name="collection" ref="44ede451a63843e8"/>
                            <extensions>
                                <oga:meta x="788" y="134"/>
                            </extensions>
                        </ogcn:macro>
                        <ogcn:macro id="cd62fc584cd94f19" name="Print Summary Table" type="ca.gedge.opgraph.nodes.general.MacroNode">
                            <graph id="5dbf8684">
                                <node id="c285c589718b48d4" type="class:ca.gedge.opgraph.nodes.general.PassThroughNode">
                                    <extensions>
                                        <oga:meta x="79" y="165"/>
                                    </extensions>
                                </node>
                                <node id="84104c69dc1b406a" name="Summary Table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.TableDataSource]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="86" y="314"/>
                                    </extensions>
                                </node>
                                <node id="2368550fe0c14b71" name="Participant" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="85" y="431"/>
                                    </extensions>
                                </node>
                                <ogcn:macro id="23634b3ea246481e" name="Summary Buffer Name" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                    <graph id="7fbede1a">
                                        <node id="60fb4208bddc42a0" name="StringBuffer#&lt;init&gt;(String)" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                                            <extensions>
                                                <oga:settings>
                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>(java.lang.String)]]></oga:property>
                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                </oga:settings>
                                                <oga:meta x="41" y="282">
                                                    <oga:default for="arg1" type="java.lang.String">Summary_</oga:default>
                                                </oga:meta>
                                            </extensions>
                                        </node>
                                        <node id="5e03fbd1a98243ee" name="StringBuffer#append(Object)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                            <extensions>
                                                <oga:settings>
                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[append(java.lang.Object)]]></oga:property>
                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                </oga:settings>
                                                <oga:meta x="273" y="288"/>
                                            </extensions>
                                        </node>
                                        <node id="787a87183b9c42c0" name="StringBuffer#toString()" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                            <extensions>
                                                <oga:settings>
                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[toString()]]></oga:property>
                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                </oga:settings>
                                                <oga:meta x="491" y="293"/>
                                            </extensions>
                                        </node>
                                        <link dest="787a87183b9c42c0" destField="obj" source="5e03fbd1a98243ee" sourceField="value"/>
                                        <link dest="5e03fbd1a98243ee" destField="obj" source="60fb4208bddc42a0" sourceField="value"/>
                                        <extensions>
                                            <oga:notes>
                                                <oga:note color="0xffff96" height="219" title="Macro Published Inpus" width="259" x="37" y="473"/>
                                            </oga:notes>
                                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                        </extensions>
                                    </graph>
                                    <ogcn:published_input field="arg1" name="arg1" ref="5e03fbd1a98243ee"/>
                                    <ogcn:published_output field="value" name="value" ref="787a87183b9c42c0"/>
                                    <extensions>
                                        <oga:meta x="481" y="438"/>
                                    </extensions>
                                </ogcn:macro>
                                <node id="50d9e7e8" name="Output Table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.TableDataSource]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="706" y="562"/>
                                    </extensions>
                                </node>
                                <node id="e5a82a5f8e04526" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                    <input name="data" optional="false">Data to print</input>
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="dataTemplate"><![CDATA[$DATA]]></oga:property>
                                            <oga:property key="showText"><![CDATA[false]]></oga:property>
                                            <oga:property key="showTable"><![CDATA[true]]></oga:property>
                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="702" y="394"/>
                                    </extensions>
                                </node>
                                <link dest="23634b3ea246481e" destField="arg1" source="2368550fe0c14b71" sourceField="obj"/>
                                <link dest="e5a82a5f8e04526" destField="buffer" source="23634b3ea246481e" sourceField="value"/>
                                <link dest="e5a82a5f8e04526" destField="data" source="84104c69dc1b406a" sourceField="obj"/>
                                <link dest="50d9e7e8" destField="obj" source="84104c69dc1b406a" sourceField="obj"/>
                                <extensions>
                                    <oga:notes>
                                        <oga:note color="0xffff96" height="671" title="Published Inputs" width="314" x="24" y="82">This input is ignore, it is used to control order of operations only.</oga:note>
                                    </oga:notes>
                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                </extensions>
                            </graph>
                            <ogcn:published_input field="input" name="input" ref="c285c589718b48d4"/>
                            <ogcn:published_input field="obj" name="table" ref="84104c69dc1b406a"/>
                            <ogcn:published_input field="obj" name="speaker" ref="2368550fe0c14b71"/>
                            <ogcn:published_output field="buffer" name="buffer" ref="e5a82a5f8e04526"/>
                            <ogcn:published_output field="obj" name="table" ref="50d9e7e8"/>
                            <extensions>
                                <oga:meta x="785" y="420"/>
                            </extensions>
                        </ogcn:macro>
                        <node id="3a7f826d" name="Add to Global Summary" type="class:ca.phon.app.opgraph.nodes.PhonScriptNode">
                            <input name="speaker" optional="false"/>
                            <input name="globalSummary" optional="false"/>
                            <input name="summary" optional="false"/>
                            <output name="table" type="ca.phon.query.report.datasource.DefaultTableDataSource"/>
                            <extensions>
                                <oga:settings>
                                    <oga:property key="__script"><![CDATA[function init(inputs, outputs) {
	inputs.add("speaker", "", false, false);
	inputs.add("globalSummary", "", false, false);
	inputs.add("summary", "", false, false);

	outputs.add("table", "", false, Packages.ca.phon.query.report.datasource.DefaultTableDataSource);
}

function run(context) {
	var speaker = context.get("speaker");
	var globalSummary = context.get("globalSummary");
	var summary = context.get("summary");

	var target = 0;
	var correct = 0;
	var substituted = 0;
	var deleted = 0;
	var epenthesized = 0;

	if(summary.rowCount > 0) {
		for(var rowIdx = 0; rowIdx < summary.rowCount; rowIdx++) {
			target += summary.getValueAt(rowIdx, "# Target").intValue();
			correct += summary.getValueAt(rowIdx, "# Correct").intValue();
			substituted += summary.getValueAt(rowIdx, "# Substituted").intValue();
			deleted += summary.getValueAt(rowIdx, "# Deleted").intValue();
			epenthesized += summary.getValueAt(rowIdx, "# Epenthesized").intValue();		
		}
	
		var pc = (correct / (correct+substituted+deleted+epenthesized)) * 100.0;
	
		var idx = 0;
		var rowData = [];
	
		rowData[idx++] = speaker;
		rowData[idx++] = speaker.role;
		rowData[idx++] = new java.lang.Integer(target);
		rowData[idx++] = new java.lang.Integer(correct);
		rowData[idx++] = new java.lang.Integer(substituted);
		rowData[idx++] = new java.lang.Integer(deleted);
		rowData[idx++] = new java.lang.Integer(epenthesized);
		rowData[idx++] = new java.lang.Float(pc);

		globalSummary.addRow(rowData);
	}

	context.put("table", globalSummary);
}
]]></oga:property>
                                </oga:settings>
                                <oga:meta x="368" y="585"/>
                            </extensions>
                        </node>
                        <ogcn:macro id="736321fa5f7a4890" name="Add to Summary Template" type="ca.gedge.opgraph.nodes.general.MacroNode">
                            <graph id="4bd2a80">
                                <node id="f43c9c1187d4b8b" name="Set Caption" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                    <input name="data" optional="false">Data to print</input>
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="dataTemplate"><![CDATA[
#set($caption = "<h3>$DATA</h3>")]]></oga:property>
                                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="15" y="15">
                                            <oga:default for="buffer" type="java.lang.String">Summary Template</oga:default>
                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                        </oga:meta>
                                    </extensions>
                                </node>
                                <node id="35f05bd14dcc4657" name="Add to Summary Template" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                    <input name="data" optional="false">Data to print</input>
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="dataTemplate"><![CDATA[
#set($tableName = "$DATA")
#set($table = $tables.get($tableName))
#printTableWithIdAndCaption( $table $tableName $caption [] )
]]></oga:property>
                                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="22" y="158">
                                            <oga:default for="buffer" type="java.lang.String">Summary Template</oga:default>
                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                        </oga:meta>
                                    </extensions>
                                </node>
                                <extensions>
                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                </extensions>
                            </graph>
                            <ogcn:published_input field="data" name="speaker" ref="f43c9c1187d4b8b"/>
                            <ogcn:published_input field="data" name="bufferName" ref="35f05bd14dcc4657"/>
                            <extensions>
                                <oga:meta x="772" y="651"/>
                            </extensions>
                        </ogcn:macro>
                        <link dest="cb86895b929e40c4" destField="speaker" source="6e7dac5ad324dd0" sourceField="obj"/>
                        <link dest="6e7dac5ad324dd0" destField="obj" source="f07c16119afe452e" sourceField="obj"/>
                        <link dest="cb86895b929e40c4" destField="tableMap" source="cd7f2adfba34488c" sourceField="obj"/>
                        <link dest="f597c5aaf39b442f" destField="table" source="cb86895b929e40c4" sourceField="table"/>
                        <link dest="f597c5aaf39b442f" destField="enabled" source="cb86895b929e40c4" sourceField="exists"/>
                        <link dest="f597c5aaf39b442f" destField="selectedSessions" source="28e03ab509b94a85" sourceField="obj"/>
                        <link dest="f597c5aaf39b442f" destField="speaker" source="6e7dac5ad324dd0" sourceField="obj"/>
                        <link dest="736321fa5f7a4890" destField="bufferName" source="cd62fc584cd94f19" sourceField="buffer"/>
                        <link dest="cd62fc584cd94f19" destField="table" source="ad6397d3e8824ec1" sourceField="table"/>
                        <link dest="736321fa5f7a4890" destField="speaker" source="6e7dac5ad324dd0" sourceField="obj"/>
                        <link dest="cd62fc584cd94f19" destField="speaker" source="6e7dac5ad324dd0" sourceField="obj"/>
                        <link dest="f597c5aaf39b442f" destField="summaryTable" source="ad6397d3e8824ec1" sourceField="table"/>
                        <link dest="cd62fc584cd94f19" destField="input" source="f597c5aaf39b442f" sourceField="collection"/>
                        <link dest="ad6397d3e8824ec1" destField="title" source="6b15e246103847d5" sourceField="obj"/>
                        <link dest="3a7f826d" destField="globalSummary" source="54074bf3" sourceField="obj"/>
                        <link dest="3a7f826d" destField="summary" source="cd62fc584cd94f19" sourceField="table"/>
                        <link dest="3a7f826d" destField="speaker" source="6e7dac5ad324dd0" sourceField="obj"/>
                        <extensions>
                            <oga:notes>
                                <oga:note color="0xffff96" height="565" title="Published Inputs" width="229" x="33" y="160"/>
                                <oga:note color="0xffc864" height="195" title="Report Template" width="356" x="686" y="591"/>
                            </oga:notes>
                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                        </extensions>
                    </graph>
                    <ogcn:published_input field="obj" name="tableMap" ref="cd7f2adfba34488c"/>
                    <ogcn:published_input field="obj" name="selectedSessions" ref="28e03ab509b94a85"/>
                    <ogcn:published_input field="obj" name="reportTitle" ref="6b15e246103847d5"/>
                    <ogcn:published_input field="obj" name="globalSummary" ref="54074bf3"/>
                    <ogcn:published_output field="table" name="table" ref="3a7f826d"/>
                    <extensions>
                        <oga:settings>
                            <oga:property key="ca.gedge.opgraph.nodes.reflect.IterableClassNode.className"><![CDATA[java.util.ArrayList]]></oga:property>
                        </oga:settings>
                        <oga:meta x="851" y="191"/>
                    </extensions>
                </ogcn:macro>
                <ogcn:macro id="366ce046" name="Print Global Summary" type="ca.gedge.opgraph.nodes.general.MacroNode">
                    <graph id="2ce58dc1">
                        <node id="4d74e36a" name="table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                </oga:settings>
                                <oga:meta x="15" y="15"/>
                            </extensions>
                        </node>
                        <node id="845839cb6e6d4bd5" type="class:ca.phon.app.opgraph.nodes.PhonScriptNode">
                            <input name="table" optional="false"/>
                            <output name="table" type="ca.phon.query.report.datasource.DefaultTableDataSource"/>
                            <extensions>
                                <oga:settings>
                                    <oga:property key="__script"><![CDATA[function init(inputs, outputs) {
	inputs.add("table", "", false, false);

	outputs.add("table", "", false, Packages.ca.phon.query.report.datasource.DefaultTableDataSource);
}

function run(context) {
	var summary = context.get("table");

	var target = 0;
	var correct = 0;
	var substituted = 0;
	var deleted = 0;
	var epenthesized = 0;

	for(var rowIdx = 0; rowIdx < summary.rowCount; rowIdx++) {
		target += summary.getValueAt(rowIdx, "# Target").intValue();
		correct += summary.getValueAt(rowIdx, "# Correct").intValue();
		substituted += summary.getValueAt(rowIdx, "# Substituted").intValue();
		deleted += summary.getValueAt(rowIdx, "# Deleted").intValue();
		epenthesized += summary.getValueAt(rowIdx, "# Epenthesized").intValue();		
	}

	var pc = (correct / (correct+substituted+deleted+epenthesized)) * 100.0;

	var idx = 0;
	var rowData = [];

	rowData[idx++] = "Total";
	rowData[idx++] = "";
	rowData[idx++] = new java.lang.Integer(target);
	rowData[idx++] = new java.lang.Integer(correct);
	rowData[idx++] = new java.lang.Integer(substituted);
	rowData[idx++] = new java.lang.Integer(deleted);
	rowData[idx++] = new java.lang.Integer(epenthesized);
	rowData[idx++] = new java.lang.Float(pc);

	summary.addRow(rowData);

	context.put("table", summary);
}
]]></oga:property>
                                </oga:settings>
                                <oga:meta x="242" y="15"/>
                            </extensions>
                        </node>
                        <node id="ad7051ee88a34aed" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                            <input name="data" optional="false">Data to print</input>
                            <extensions>
                                <oga:settings>
                                    <oga:property key="dataTemplate"><![CDATA[$DATA]]></oga:property>
                                    <oga:property key="showText"><![CDATA[false]]></oga:property>
                                    <oga:property key="showTable"><![CDATA[true]]></oga:property>
                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                </oga:settings>
                                <oga:meta x="477" y="15">
                                    <oga:default for="buffer" type="java.lang.String">Summary_All</oga:default>
                                    <oga:default for="append" type="java.lang.Boolean">false</oga:default>
                                </oga:meta>
                            </extensions>
                        </node>
                        <node id="21217f82" name="Print to Global Summary Template" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                            <input name="data" optional="false">Data to print</input>
                            <extensions>
                                <oga:settings>
                                    <oga:property key="dataTemplate"><![CDATA[
#set($caption = "<h3>All Participants</h3>")
#set($tableName = "$DATA")
#set($table = $tables.get($tableName))
#printTableWithIdAndCaption( $table $tableName $caption [] )
]]></oga:property>
                                    <oga:property key="showText"><![CDATA[true]]></oga:property>
                                    <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                </oga:settings>
                                <oga:meta x="676" y="16">
                                    <oga:default for="buffer" type="java.lang.String">Global Summary</oga:default>
                                </oga:meta>
                            </extensions>
                        </node>
                        <link dest="845839cb6e6d4bd5" destField="table" source="4d74e36a" sourceField="obj"/>
                        <link dest="ad7051ee88a34aed" destField="data" source="845839cb6e6d4bd5" sourceField="table"/>
                        <link dest="21217f82" destField="data" source="ad7051ee88a34aed" sourceField="buffer"/>
                        <extensions>
                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                        </extensions>
                    </graph>
                    <ogcn:published_input field="obj" name="table" ref="4d74e36a"/>
                    <extensions>
                        <oga:meta x="947" y="428"/>
                    </extensions>
                </ogcn:macro>
                <ogcn:macro id="35186832950f431f" name="Finish Report Template" type="ca.gedge.opgraph.nodes.general.MacroNode">
                    <graph id="768251f5">
                        <node id="433d7fb296094574" type="class:ca.gedge.opgraph.nodes.general.PassThroughNode">
                            <extensions>
                                <oga:meta x="66" y="65"/>
                            </extensions>
                        </node>
                        <ogcn:macro id="5500c5ff33274694" name="Add Buffer to Template" type="ca.gedge.opgraph.nodes.general.MacroNode">
                            <graph id="5b709610">
                                <node id="6d96a272fabe47fe" name="String#&lt;init&gt;(String)" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>(java.lang.String)]]></oga:property>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="55" y="74"/>
                                    </extensions>
                                </node>
                                <node id="5bbf9daa27cb4c5a" name="String#&lt;init&gt;(String)" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>(java.lang.String)]]></oga:property>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="57" y="166"/>
                                    </extensions>
                                </node>
                                <ogcn:macro id="4ec0cdf1a1084bfd" name="Add to Template" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                    <graph id="10f4f7d">
                                        <node id="5d6db7a95a084121" type="class:ca.phon.app.opgraph.nodes.log.GetBufferNode">
                                            <extensions>
                                                <oga:meta x="517" y="52">
                                                    <oga:default for="buffer" type="java.lang.String"/>
                                                </oga:meta>
                                            </extensions>
                                        </node>
                                        <node id="70954aa2240e4943" type="class:ca.phon.app.opgraph.nodes.log.GetBufferNode">
                                            <extensions>
                                                <oga:meta x="518" y="147">
                                                    <oga:default for="buffer" type="java.lang.String"/>
                                                </oga:meta>
                                            </extensions>
                                        </node>
                                        <node id="deed15b490b64be0" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                            <input name="data" optional="false">Data to print</input>
                                            <extensions>
                                                <oga:settings>
                                                    <oga:property key="dataTemplate"><![CDATA[
#h2("Summary")

$DATA
]]></oga:property>
                                                    <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                    <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                </oga:settings>
                                                <oga:meta x="707" y="94">
                                                    <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                    <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                </oga:meta>
                                            </extensions>
                                        </node>
                                        <node id="3a8e1ee8eed74900" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                            <input name="data" optional="false">Data to print</input>
                                            <extensions>
                                                <oga:settings>
                                                    <oga:property key="dataTemplate"><![CDATA[
$DATA
]]></oga:property>
                                                    <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                    <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                </oga:settings>
                                                <oga:meta x="705" y="235">
                                                    <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                    <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                </oga:meta>
                                            </extensions>
                                        </node>
                                        <link dest="deed15b490b64be0" destField="data" source="5d6db7a95a084121" sourceField="text"/>
                                        <link dest="3a8e1ee8eed74900" destField="data" source="70954aa2240e4943" sourceField="text"/>
                                        <extensions>
                                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                        </extensions>
                                    </graph>
                                    <ogcn:published_input field="buffer" name="buffer" ref="70954aa2240e4943"/>
                                    <ogcn:published_input field="buffer" name="globalBuffer" ref="5d6db7a95a084121"/>
                                    <extensions>
                                        <oga:meta x="305" y="28"/>
                                    </extensions>
                                </ogcn:macro>
                                <node id="4667b6f458ae4ddd" type="class:ca.phon.app.opgraph.nodes.log.CloseBufferNode">
                                    <extensions>
                                        <oga:meta x="316" y="154"/>
                                    </extensions>
                                </node>
                                <node id="b38fdfe3d6344534" type="class:ca.phon.app.opgraph.nodes.log.CloseBufferNode">
                                    <extensions>
                                        <oga:meta x="321" y="257"/>
                                    </extensions>
                                </node>
                                <link dest="4667b6f458ae4ddd" destField="buffer" source="6d96a272fabe47fe" sourceField="value"/>
                                <link dest="4ec0cdf1a1084bfd" destField="buffer" source="6d96a272fabe47fe" sourceField="value"/>
                                <link dest="4ec0cdf1a1084bfd" destField="globalBuffer" source="5bbf9daa27cb4c5a" sourceField="value"/>
                                <link dest="b38fdfe3d6344534" destField="buffer" source="5bbf9daa27cb4c5a" sourceField="value"/>
                                <extensions>
                                    <oga:notes>
                                        <oga:note color="0xffff96" height="263" title="Published Inputs" width="234" x="35" y="20"/>
                                    </oga:notes>
                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                </extensions>
                            </graph>
                            <ogcn:published_input field="arg1" name="arg1" ref="6d96a272fabe47fe"/>
                            <ogcn:published_input field="arg1" name="arg11" ref="5bbf9daa27cb4c5a"/>
                            <extensions>
                                <oga:meta x="339" y="175">
                                    <oga:default for="arg1" type="java.lang.String">Summary Template</oga:default>
                                    <oga:default for="arg11" type="java.lang.String">Global Summary</oga:default>
                                </oga:meta>
                            </extensions>
                        </ogcn:macro>
                        <ogcn:macro id="a54d0d3da6c6453c" name="Add Buffer to Template" type="ca.gedge.opgraph.nodes.general.MacroNode">
                            <graph id="32ed4071">
                                <node id="10975a3101fb4713" name="String#&lt;init&gt;(String)" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>(java.lang.String)]]></oga:property>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="55" y="74"/>
                                    </extensions>
                                </node>
                                <ogcn:macro id="2ee23abd69674991" name="Add to Template" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                    <graph id="203af6be">
                                        <node id="d24749f645764345" type="class:ca.phon.app.opgraph.nodes.log.GetBufferNode">
                                            <extensions>
                                                <oga:meta x="518" y="147">
                                                    <oga:default for="buffer" type="java.lang.String"/>
                                                </oga:meta>
                                            </extensions>
                                        </node>
                                        <node id="dc3408c814b64135" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                            <input name="data" optional="false">Data to print</input>
                                            <extensions>
                                                <oga:settings>
                                                    <oga:property key="dataTemplate"><![CDATA[
#h2("Breakdown")

$DATA
]]></oga:property>
                                                    <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                    <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                </oga:settings>
                                                <oga:meta x="677" y="151">
                                                    <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                    <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                </oga:meta>
                                            </extensions>
                                        </node>
                                        <link dest="dc3408c814b64135" destField="data" source="d24749f645764345" sourceField="text"/>
                                    </graph>
                                    <ogcn:published_input field="buffer" name="buffer" ref="d24749f645764345"/>
                                    <extensions>
                                        <oga:meta x="305" y="28"/>
                                    </extensions>
                                </ogcn:macro>
                                <node id="fa9627baac534edb" type="class:ca.phon.app.opgraph.nodes.log.CloseBufferNode">
                                    <extensions>
                                        <oga:meta x="316" y="125"/>
                                    </extensions>
                                </node>
                                <link dest="fa9627baac534edb" destField="buffer" source="10975a3101fb4713" sourceField="value"/>
                                <link dest="2ee23abd69674991" destField="buffer" source="10975a3101fb4713" sourceField="value"/>
                                <extensions>
                                    <oga:notes>
                                        <oga:note color="0xffff96" height="220" title="Published Inputs" width="234" x="35" y="20"/>
                                    </oga:notes>
                                </extensions>
                            </graph>
                            <ogcn:published_input field="arg1" name="arg1" ref="10975a3101fb4713"/>
                            <extensions>
                                <oga:meta x="341" y="282">
                                    <oga:default for="arg1" type="java.lang.String">Breakdown Template</oga:default>
                                </oga:meta>
                            </extensions>
                        </ogcn:macro>
                        <extensions>
                            <oga:notes>
                                <oga:note color="0xffff96" height="213" title="Published Inputs" width="260" x="31" y="21">This input is ignored</oga:note>
                            </oga:notes>
                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                        </extensions>
                    </graph>
                    <ogcn:published_input field="input" name="input" ref="433d7fb296094574"/>
                    <extensions>
                        <oga:meta x="954" y="619"/>
                    </extensions>
                </ogcn:macro>
                <link dest="35186832950f431f" destField="input" source="9be63edf7454f48" sourceField="collection"/>
                <link dest="2fb344a5f7134d66" destField="reportTitle" source="e6d45b5e5a1847a0" sourceField="obj"/>
                <link dest="51a10b46c3124671" destField="results" source="e6f07f6f7dc34e29" sourceField="obj"/>
                <link dest="9be63edf7454f48" destField="tableMap" source="ff306d8463c54561" sourceField="tableMap"/>
                <link dest="51a10b46c3124671" destField="project" source="1f17ec8476fc478a" sourceField="obj"/>
                <link dest="9be63edf7454f48" destField="selectedSessions" source="2ee97062ccbd4ee1" sourceField="obj"/>
                <link dest="af8397839e8a46c1" destField="script" source="419c72194f554b81" sourceField="obj"/>
                <link dest="9be63edf7454f48" destField="collection" source="5f8fe0460f3f4fd8" sourceField="obj"/>
                <link dest="af8397839e8a46c1" destField="parameters" source="2fb344a5f7134d66" sourceField="obj"/>
                <link dest="ff306d8463c54561" destField="table" source="51a10b46c3124671" sourceField="table"/>
                <link dest="2fb344a5f7134d66" destField="parameters" source="9ad0f5182254d47" sourceField="obj"/>
                <link dest="9be63edf7454f48" destField="reportTitle" source="e6d45b5e5a1847a0" sourceField="obj"/>
                <link dest="9be63edf7454f48" destField="globalSummary" source="cd24c50e7acb44b8" sourceField="table"/>
                <link dest="cd24c50e7acb44b8" destField="title" source="e6d45b5e5a1847a0" sourceField="obj"/>
                <link dest="366ce046" destField="table" source="9be63edf7454f48" sourceField="table"/>
                <extensions>
                    <oga:notes>
                        <oga:note color="0xffff96" height="1054" title="Published Inputs" width="383" x="9" y="7"/>
                    </oga:notes>
                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                </extensions>
            </graph>
            <ogcn:published_input field="obj" name="reportTitle" ref="e6d45b5e5a1847a0"/>
            <ogcn:published_input field="obj" name="project" ref="1f17ec8476fc478a"/>
            <ogcn:published_input field="obj" name="results" ref="e6f07f6f7dc34e29"/>
            <ogcn:published_input field="obj" name="selected sessions" ref="2ee97062ccbd4ee1"/>
            <ogcn:published_input field="obj" name="selected participants" ref="5f8fe0460f3f4fd8"/>
            <ogcn:published_input field="obj" name="script" ref="419c72194f554b81"/>
            <ogcn:published_input field="obj" name="parameters" ref="9ad0f5182254d47"/>
            <extensions>
                <oga:meta x="796" y="151">
                    <oga:default for="reportTitle" type="java.lang.String">PCC</oga:default>
                </oga:meta>
            </extensions>
        </ogcn:macro>
        <link dest="4b18886ea00b48b3" destField="selected sessions" source="5e629711" sourceField="obj"/>
        <link dest="4b18886ea00b48b3" destField="selected participants" source="6b8dfd59" sourceField="obj"/>
        <link dest="4b18886ea00b48b3" destField="results" source="62a83f9c" sourceField="results"/>
        <link dest="4b18886ea00b48b3" destField="project" source="62a83f9c" sourceField="project"/>
        <link dest="4b18886ea00b48b3" destField="script" source="62a83f9c" sourceField="script"/>
        <link dest="62a83f9c" destField="project" source="1d6fc11b" sourceField="obj"/>
        <link dest="62a83f9c" destField="sessions" source="5e629711" sourceField="obj"/>
        <link dest="10ac3417" destField="params" source="62a83f9c" sourceField="parameters"/>
        <link dest="4b18886ea00b48b3" destField="reportTitle" source="10ac3417" sourceField="pcType"/>
        <link dest="62a83f9c" destField="parameters" source="dc4dad38c60648c1" sourceField="parameters"/>
        <link dest="4b18886ea00b48b3" destField="parameters" source="dc4dad38c60648c1" sourceField="parameters"/>
        <extensions>
            <opqry:nodewizard type="ca.phon.app.opgraph.analysis.AnalysisWizardExtension">
                <opqry:info format="html" title="PCC &amp; PVC">
                    <opqry:message/>
                </opqry:info>
                <opqry:node ref="dc4dad38c60648c1" showAsStep="true">
                    <opqry:info format="html" title="Parameters">
                        <opqry:message/>
                    </opqry:info>
                </opqry:node>
                <opqry:report-template name="Report Prefix"/>
                <opqry:report-template name="Report Suffix"/>
            </opqry:nodewizard>
            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
            <oga:notes>
                <oga:note color="0xffff96" height="542" title="Inputs" width="365" x="26" y="11">Default inputs for all Analysis documents</oga:note>
                <oga:note color="0x9696ff" height="542" title="PCC Query" width="296" x="425" y="12">Creates a table of results, one for each word in the selected sessions, with the PCC calculations for each word.</oga:note>
                <oga:note color="0x96ff96" height="541" title="Report" width="277" x="750" y="14">Basic report with Summary and Breakdown sections.  Summary contains totals for the PCC columns created in Query stage</oga:note>
            </oga:notes>
        </extensions>
    </graph>
</opgraph>
