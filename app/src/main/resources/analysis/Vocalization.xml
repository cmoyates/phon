<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<opgraph xmlns="http://gedge.ca/ns/opgraph" xmlns:nes="https://www.phon.ca/ns/node_editor" xmlns:oga="http://gedge.ca/ns/opgraph-app" xmlns:ogcn="http://gedge.ca/ns/opgraph-common-nodes" xmlns:opqry="https://phon.ca/ns/opgraph_query" xmlns:qry="http://phon.ling.mun.ca/ns/query">
    <graph id="root">
        <node id="55f4fba4" name="Project" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
            <extensions>
                <oga:settings>
                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.project.Project]]></oga:property>
                    <oga:property key="contextKey"><![CDATA[_project]]></oga:property>
                </oga:settings>
                <oga:meta x="15" y="15"/>
            </extensions>
        </node>
        <node id="1ae2322c" name="Selected Sessions" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
            <extensions>
                <oga:settings>
                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.util.ArrayList]]></oga:property>
                    <oga:property key="contextKey"><![CDATA[_selectedSessions]]></oga:property>
                </oga:settings>
                <oga:meta x="15" y="256"/>
            </extensions>
        </node>
        <node id="3da0e5db" name="Selected Participants" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
            <extensions>
                <oga:settings>
                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.util.ArrayList]]></oga:property>
                    <oga:property key="contextKey"><![CDATA[_selectedParticipants]]></oga:property>
                </oga:settings>
                <oga:meta x="15" y="357"/>
            </extensions>
        </node>
        <node id="dc596f57c3774064" name="Parameters" type="class:ca.phon.app.opgraph.nodes.PhonScriptNode">
            <extensions>
                <oga:settings>
                    <oga:property key="__script"><![CDATA[var reportTitleParamInfo = {
	"id": "reportTitle",
	"title": "Report Title",
	"def": "Report",
	"prompt": "Enter report title"
};
var reportTitleParam;
var reportTitle = reportTitleParamInfo.def;

function setup_params(params) {
	reportTitleParam = new StringScriptParam(
			reportTitleParamInfo.id,
			reportTitleParamInfo.title,
			reportTitleParamInfo.def);
     reportTitleParam.setPrompt(reportTitleParamInfo.prompt);
	params.add(reportTitleParam);
}
]]></oga:property>
                    <oga:property key="reportTitle"><![CDATA[Vocalization Analysis]]></oga:property>
                </oga:settings>
                <oga:meta x="15" y="458"/>
            </extensions>
        </node>
        <opqry:queryNode id="29ac654b" name="Query : Data Tiers" type="ca.phon.app.opgraph.nodes.query.QueryNode">
            <qry:query xmlns="http://phon.ling.mun.ca/ns/query" date="2017-08-01T14:56:45.129-02:30" name="Data Tiers" uuid="b2604561-856a-409f-83d1-f848962d43d7">
                <script>
                    <url ref="Data Tiers" rel="stock"/>
                    <param id="filters.alignedWord.patternFilter.allowOverlap">false</param>
                    <param id="filters.alignedWord.patternFilter.caseSensitive">false</param>
                    <param id="filters.alignedWord.patternFilter.exactMatch">true</param>
                    <param id="filters.alignedWord.patternFilter.filter">.+</param>
                    <param id="filters.alignedWord.patternFilter.filterType">Regular expression</param>
                    <param id="filters.alignedWord.tier">IPA Actual</param>
                    <param id="filters.primary.patternFilter.filter">.+</param>
                    <param id="filters.primary.patternFilter.filterType">Regular expression</param>
                    <param id="filters.primary.tier">Orthography</param>
                    <param id="filters.word.searchByWord">true</param>
                    <param id="filters.wordTiers.tiers">Actual Syllabification</param>
                </script>
            </qry:query>
            <extensions>
                <oga:settings/>
                <oga:meta x="326" y="15"/>
            </extensions>
        </opqry:queryNode>
        <ogcn:macro id="41a5af28" name="Print Report Title" type="ca.gedge.opgraph.nodes.general.MacroNode">
            <graph id="2ba1606d">
                <node id="444d7ec1" name="parameters" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                    <extensions>
                        <oga:settings>
                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.util.Map]]></oga:property>
                        </oga:settings>
                    </extensions>
                </node>
                <ogcn:macro id="6be9cf3f68b64e43" name="Get Report Title" type="ca.gedge.opgraph.nodes.general.MacroNode">
                    <graph id="34a7022e">
                        <node id="496aae2d8c5f45ee" name="String#&lt;init&gt;(String)" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>(java.lang.String)]]></oga:property>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                </oga:settings>
                                <oga:meta x="15" y="15">
                                    <oga:default for="arg1" type="java.lang.String">reportTitle</oga:default>
                                </oga:meta>
                            </extensions>
                        </node>
                        <node id="7b1133368cbf4c65" name="Map#get(Object)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[get(java.lang.Object)]]></oga:property>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.util.Map]]></oga:property>
                                </oga:settings>
                                <oga:meta x="218" y="16"/>
                            </extensions>
                        </node>
                        <node id="9c8aa94acf7f4599" name="Object#toString()" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[toString()]]></oga:property>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.Object]]></oga:property>
                                </oga:settings>
                                <oga:meta x="392" y="15"/>
                            </extensions>
                        </node>
                        <link dest="7b1133368cbf4c65" destField="arg1" source="496aae2d8c5f45ee" sourceField="value"/>
                        <link dest="9c8aa94acf7f4599" destField="obj" source="7b1133368cbf4c65" sourceField="value"/>
                    </graph>
                    <ogcn:published_input field="obj" name="parameters" ref="7b1133368cbf4c65"/>
                    <ogcn:published_output field="value" name="reportTitle" ref="9c8aa94acf7f4599"/>
                    <extensions>
                        <oga:meta x="258" y="437"/>
                    </extensions>
                </ogcn:macro>
                <node id="16a1b6aa" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                    <input name="data" optional="false">Data to print</input>
                    <extensions>
                        <oga:settings>
                            <oga:property key="dataTemplate"><![CDATA[
#h1("$DATA")
]]></oga:property>
                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                        </oga:settings>
                        <oga:meta x="481" y="437">
                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                        </oga:meta>
                    </extensions>
                </node>
                <link dest="6be9cf3f68b64e43" destField="parameters" source="444d7ec1" sourceField="obj"/>
                <link dest="16a1b6aa" destField="data" source="6be9cf3f68b64e43" sourceField="reportTitle"/>
            </graph>
            <ogcn:published_input field="obj" name="parameters" ref="444d7ec1"/>
            <extensions>
                <oga:meta x="326" y="456"/>
            </extensions>
        </ogcn:macro>
        <node id="61e6ae5ee8ed4084" type="class:ca.phon.app.opgraph.nodes.table.ResultsToTableNode">
            <extensions>
                <oga:settings>
                    <oga:property key="includeMetadata"><![CDATA[true]]></oga:property>
                    <oga:property key="includeTierInfo"><![CDATA[true]]></oga:property>
                    <oga:property key="includeSpeakerInfo"><![CDATA[true]]></oga:property>
                    <oga:property key="includeSessionInfo"><![CDATA[true]]></oga:property>
                </oga:settings>
                <oga:meta x="561" y="15"/>
            </extensions>
        </node>
        <ogcn:macro id="61208600" name="For Each Participant" type="ca.gedge.opgraph.nodes.reflect.IterableClassNode">
            <graph id="4e315891">
                <node id="282a70f9" name="Current Object" type="class:ca.gedge.opgraph.nodes.reflect.ContextualItemClassNode">
                    <extensions>
                        <oga:settings>
                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ContextualItemClassNode.key"><![CDATA[currentValue]]></oga:property>
                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ContextualItemClassNode.declaredClass"><![CDATA[java.lang.Object]]></oga:property>
                        </oga:settings>
                        <oga:meta x="24" y="23"/>
                    </extensions>
                </node>
                <node id="cbab76efb3454ab5" name="Result Table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                    <extensions>
                        <oga:settings>
                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.TableDataSource]]></oga:property>
                        </oga:settings>
                        <oga:meta x="46" y="188"/>
                    </extensions>
                </node>
                <ogcn:macro id="55aaa72dc82b4f91" name="Create Summary Table" type="ca.gedge.opgraph.nodes.general.MacroNode">
                    <graph id="27d0f1f6">
                        <node id="2346342eeb134cfe" name="DefaultTableDataSource#&lt;init&gt;()" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>()]]></oga:property>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                </oga:settings>
                                <oga:meta x="576" y="555"/>
                            </extensions>
                        </node>
                        <node id="60acbaa7700b42af" name="Setup Table Columns" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="__script"><![CDATA[
function init(inputs, outputs) {
	
}

function tableOp(context, table) {
	var colIdx = 0;

	table.setColumnTitle(colIdx++, "Category");
	table.setColumnTitle(colIdx++, "Description");
	table.setColumnTitle(colIdx++, "Value");
}
]]></oga:property>
                                </oga:settings>
                                <oga:meta x="855" y="541"/>
                            </extensions>
                        </node>
                        <link dest="60acbaa7700b42af" destField="table" source="2346342eeb134cfe" sourceField="value"/>
                        <extensions>
                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                        </extensions>
                    </graph>
                    <ogcn:published_output field="table" name="table" ref="60acbaa7700b42af"/>
                    <extensions>
                        <oga:meta x="320" y="428"/>
                    </extensions>
                </ogcn:macro>
                <node id="5fc29abaa09040c1" name="To Participant Object" type="class:ca.gedge.opgraph.nodes.reflect.ObjectCastNode">
                    <extensions>
                        <oga:settings>
                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectCastNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                        </oga:settings>
                        <oga:meta x="176" y="27"/>
                    </extensions>
                </node>
                <node id="e60ae088c39c4be1" name="Partition Table (Vocalizations vs Words)" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                    <output name="trueTable" type="ca.phon.query.report.datasource.DefaultTableDataSource">Table of rows from input table which match filter</output>
                    <output name="falseTable" type="ca.phon.query.report.datasource.DefaultTableDataSource">Table of rows from output table which do not match the filter</output>
                    <extensions>
                        <oga:settings>
                            <oga:property key="filters.column.exactMatch"><![CDATA[true]]></oga:property>
                            <oga:property key="filters.column.filterType"><![CDATA[Plain text]]></oga:property>
                            <oga:property key="columnName"><![CDATA[Orthography]]></oga:property>
                            <oga:property key="__script"><![CDATA[/*
 * Phon - An open source tool for research in phonology.
 * Copyright (C) 2005 - 201, Gregory Hedlund <ghedlund@mun.ca> and Yvan Rose <yrose@mun.ca>
 * Dept of Linguistics, Memorial University <https://phon.ca>
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

 /**
  * Partition Table.js
  *
  * Script for use with ca.phon.app.opgraph.nodes.table.TableScriptNode
  *
  * Partition table using a standard query filter and column name.
  */
var PatternFilter = require("lib/PatternFilter").PatternFilter;

var columnParamInfo = {
	"id": "columnName",
	"title": "Column Name",
	"def": "",
	"prompt": "Enter column name"
}

var filters = {
    "column": new PatternFilter("filters.column")
}

function setup_params(params) {
	var columnParam = new StringScriptParam(
		columnParamInfo.id,
		columnParamInfo.title,
		columnParamInfo.def);
	columnParam.setPrompt(columnParamInfo.prompt);
	params.add(columnParam);

	filters.column.param_setup(params);
}

// add custom inputs/outputs here
function init(inputs, outputs) {
	outputs.add("trueTable", "Table of rows from input table which match filter", false, DefaultTableDataSource);
	outputs.add("falseTable", "Table of rows from output table which do not match the filter", false, DefaultTableDataSource);
}

// run operation on table
function tableOp(context, table) {
	// find table column index
	col = table.getColumnIndex(columnName);
	if(col < 0)
		return; // column not found

	// create output tables
	trueTable = new DefaultTableDataSource();
	falseTable = new DefaultTableDataSource();
	for(c = 0; c < table.columnCount; c++) {
	    var colTitle = table.getColumnTitle(c);
	    trueTable.setColumnTitle(c, colTitle);
	    falseTable.setColumnTitle(c, colTitle);
	}

	for(row = 0; row < table.rowCount; row++) {
		rowData = table.getRow(row);
		rowMatches = filterRow(table, row, col);

		if(rowMatches == true) {
			trueTable.addRow(rowData);
		} else {
			falseTable.addRow(rowData);
		}
	}

	context.put("trueTable", trueTable);
	context.put("falseTable", falseTable);
}

function filterRow(table, row, col) {
	var value = table.getValueAt(row, col);
	if(value == null) return false;

	return filters.column.check_filter(value);
}
]]></oga:property>
                            <oga:property key="filters.column.allowOverlap"><![CDATA[false]]></oga:property>
                            <oga:property key="filters.column.caseSensitive"><![CDATA[false]]></oga:property>
                            <oga:property key="filters.column.filter"><![CDATA[yyy]]></oga:property>
                        </oga:settings>
                        <oga:meta x="306" y="273"/>
                    </extensions>
                </node>
                <ogcn:macro id="4f8f6618" name="Setup Report Buffer For Speaker" type="ca.gedge.opgraph.nodes.general.MacroNode">
                    <graph id="620c43a8">
                        <node id="7f79b0c5" name="String#&lt;init&gt;()" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>()]]></oga:property>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                </oga:settings>
                                <oga:meta x="466" y="117"/>
                            </extensions>
                        </node>
                        <node id="6eef917b" name="speaker" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                </oga:settings>
                                <oga:meta x="53" y="150"/>
                            </extensions>
                        </node>
                        <ogcn:macro id="75708706" name="Setup Buffer Name" type="ca.gedge.opgraph.nodes.general.MacroNode">
                            <graph id="12b74dee">
                                <node id="42f49fd4" name="StringBuffer#&lt;init&gt;(String)" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>(java.lang.String)]]></oga:property>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="280" y="23">
                                            <oga:default for="arg1" type="java.lang.String">Report Template_</oga:default>
                                        </oga:meta>
                                    </extensions>
                                </node>
                                <node id="614e78aa" name="participant" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="37" y="268"/>
                                    </extensions>
                                </node>
                                <node id="2051e008" name="StringBuffer#append(Object)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[append(java.lang.Object)]]></oga:property>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="512" y="200"/>
                                    </extensions>
                                </node>
                                <node id="169c0f4d" name="StringBuffer#toString()" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[toString()]]></oga:property>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="843" y="232"/>
                                    </extensions>
                                </node>
                                <link dest="169c0f4d" destField="obj" source="2051e008" sourceField="value"/>
                                <link dest="2051e008" destField="arg1" source="614e78aa" sourceField="obj"/>
                                <link dest="2051e008" destField="obj" source="42f49fd4" sourceField="value"/>
                            </graph>
                            <ogcn:published_input field="obj" name="speaker" ref="614e78aa"/>
                            <ogcn:published_output field="value" name="bufferName" ref="169c0f4d"/>
                            <extensions>
                                <oga:meta x="429" y="197"/>
                            </extensions>
                        </ogcn:macro>
                        <node id="f9aea4b" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                            <input name="data" optional="false">Data to print</input>
                            <extensions>
                                <oga:settings>
                                    <oga:property key="dataTemplate"><![CDATA[$DATA]]></oga:property>
                                    <oga:property key="showText"><![CDATA[true]]></oga:property>
                                    <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                </oga:settings>
                                <oga:meta x="772" y="203">
                                    <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                    <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                </oga:meta>
                            </extensions>
                        </node>
                        <link dest="f9aea4b" destField="buffer" source="75708706" sourceField="bufferName"/>
                        <link dest="75708706" destField="speaker" source="6eef917b" sourceField="obj"/>
                        <link dest="f9aea4b" destField="data" source="7f79b0c5" sourceField="value"/>
                        <extensions>
                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                        </extensions>
                    </graph>
                    <ogcn:published_input field="obj" name="speaker" ref="6eef917b"/>
                    <ogcn:published_output field="buffer" name="bufferName" ref="f9aea4b"/>
                    <extensions>
                        <oga:meta x="309" y="155"/>
                    </extensions>
                </ogcn:macro>
                <ogcn:macro id="607a331e" name="Vocalizations" type="ca.gedge.opgraph.nodes.general.MacroNode">
                    <graph id="1e36dcad">
                        <node id="63be7001" name="bufferName" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                </oga:settings>
                                <oga:meta x="15" y="15"/>
                            </extensions>
                        </node>
                        <node id="28737cd4" name="speaker" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                </oga:settings>
                                <oga:meta x="15" y="156"/>
                            </extensions>
                        </node>
                        <node id="3303e4cd" name="table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                </oga:settings>
                                <oga:meta x="15" y="477"/>
                            </extensions>
                        </node>
                        <node id="b559e3f830b34106" name="Summary Table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.TableDataSource]]></oga:property>
                                </oga:settings>
                                <oga:meta x="25" y="643"/>
                            </extensions>
                        </node>
                        <node id="bfbf3172e44b4532" name="Split Table by Speaker" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                            <output name="keySet" type="java.util.Set">Unique values from given column name</output>
                            <output name="tableMap" type="java.util.Map">Map of key -&gt; table values</output>
                            <extensions>
                                <oga:settings>
                                    <oga:property key="columnName"><![CDATA[Speaker]]></oga:property>
                                    <oga:property key="__script"><![CDATA[/*
 * Phon - An open source tool for research in phonology.
 * Copyright (C) 2005 - 2017, Gregory Hedlund <ghedlund@mun.ca> and Yvan Rose <yrose@mun.ca>
 * Dept of Linguistics, Memorial University <https://phon.ca>
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

 /**
  * Split Table.js
  *
  * Script for use with ca.phon.app.opgraph.nodes.table.TableScriptNode
  *
  * Split table based on column name.  Two outputs
  * are produced, a set of keys from the column used in the filter  and a
  * map of key -> table values.
  */

var columnParamInfo = {
	"id": "columnName",
	"title": "Column Name",
	"def": "",
	"prompt": "Enter column name"
}

function setup_params(params) {
	var columnParam = new StringScriptParam(
		columnParamInfo.id,
		columnParamInfo.title,
		columnParamInfo.def);
	columnParam.setPrompt(columnParamInfo.prompt);
	params.add(columnParam);
}

// add custom inputs/outputs here
function init(inputs, outputs) {
	outputs.add("keySet", "Unique values from given column name", false, java.util.Set);
	outputs.add("tableMap", "Map of key -> table values", false, java.util.Map);
}

/*
 * Create a new table with the same schema as the inputTable
 */
function setupTable(inputTable) {
    var table = new DefaultTableDataSource();
    for(c = 0; c < inputTable.columnCount; c++) {
	    var colTitle = inputTable.getColumnTitle(c);
	    table.setColumnTitle(c, colTitle);
	}
	return table;
}

// run operation on table
function tableOp(context, table) {
	// find table column index
	col = table.getColumnIndex(columnName);

	if(col < 0)
		return; // column not found

	var tableMap = new java.util.LinkedHashMap();

	for(row = 0; row < table.rowCount; row++) {
	    // use string value as row key
		var rowKey = Packages.ca.phon.formatter.FormatterUtil.format(table.getValueAt(row, col));

		var keyTable = tableMap.get(rowKey);
		if(keyTable == null) {
		    keyTable = setupTable(table);
		    tableMap.put(rowKey, keyTable);
		}
		keyTable.addRow(table.getRow(row));
	}

	context.put("keySet", tableMap.keySet());
	context.put("tableMap", tableMap);
}
]]></oga:property>
                                </oga:settings>
                                <oga:meta x="242" y="477"/>
                            </extensions>
                        </node>
                        <ogcn:macro id="bbf482c5a66541f7" name="Get Table of Results For Speaker" type="ca.gedge.opgraph.nodes.general.MacroNode">
                            <graph id="477be7ad">
                                <node id="5642bea05e5c4b06" name="Object#toString()" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[toString()]]></oga:property>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.Object]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="105" y="70"/>
                                    </extensions>
                                </node>
                                <node id="57334ef9ad744f65" name="Map#get(Object)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[get(java.lang.Object)]]></oga:property>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.util.Map]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="296" y="73"/>
                                    </extensions>
                                </node>
                                <node id="4df6ff3399a848c7" type="class:ca.phon.app.opgraph.nodes.PhonScriptNode">
                                    <output name="exists" type="java.lang.Boolean">does table exist</output>
                                    <output name="table" type="ca.phon.query.report.datasource.DefaultTableDataSource">table if exists, undefined otherwise</output>
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="__script"><![CDATA[
// setup input/output fields
function init(inputFields, outputFields) {
	inputFields.add("table", "");
	outputFields.add("exists", "does table exist", false, java.lang.Boolean);
	outputFields.add("table", "table if exists, undefined otherwise", false, Packages.ca.phon.query.report.datasource.DefaultTableDataSource);
}

function run(context) {
	var tableExists =
		(context.containsKey("table") && context.get("table") != null);
	context.put("exists", tableExists);
	context.put("table", context.get("table"));
}
]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="514" y="94"/>
                                    </extensions>
                                </node>
                                <link dest="57334ef9ad744f65" destField="arg1" source="5642bea05e5c4b06" sourceField="value"/>
                                <link dest="4df6ff3399a848c7" destField="table" source="57334ef9ad744f65" sourceField="value"/>
                                <extensions>
                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                </extensions>
                            </graph>
                            <ogcn:published_input field="obj" name="speaker" ref="5642bea05e5c4b06"/>
                            <ogcn:published_input field="obj" name="tableMap" ref="57334ef9ad744f65"/>
                            <ogcn:published_output field="exists" name="exists" ref="4df6ff3399a848c7"/>
                            <ogcn:published_output field="table" name="table" ref="4df6ff3399a848c7"/>
                            <extensions>
                                <oga:meta x="345" y="166"/>
                            </extensions>
                        </ogcn:macro>
                        <ogcn:macro id="350c5a14" name="If Speaker Has Results" type="ca.gedge.opgraph.nodes.general.MacroNode">
                            <graph id="7e7e7543">
                                <node id="60a76f15" name="Table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="38" y="55"/>
                                    </extensions>
                                </node>
                                <node id="68d90fd6bd914ea2" name="Participant" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="39" y="264"/>
                                    </extensions>
                                </node>
                                <node id="d4b8b57a48a64b53" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="57" y="612"/>
                                    </extensions>
                                </node>
                                <node id="95cfaf8923b44bb7" name="Summary Table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.TableDataSource]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="53" y="718"/>
                                    </extensions>
                                </node>
                                <node id="7f149b7d" name="Split Table by Session" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                    <output name="keySet" type="java.util.Set">Unique values from given column name</output>
                                    <output name="tableMap" type="java.util.Map">Map of key -&gt; table values</output>
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="columnName"><![CDATA[Session]]></oga:property>
                                            <oga:property key="__script"><![CDATA[/*
 * Phon - An open source tool for research in phonology.
 * Copyright (C) 2005 - 2017, Gregory Hedlund <ghedlund@mun.ca> and Yvan Rose <yrose@mun.ca>
 * Dept of Linguistics, Memorial University <https://phon.ca>
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

 /**
  * Split Table.js
  *
  * Script for use with ca.phon.app.opgraph.nodes.table.TableScriptNode
  *
  * Split table based on column name.  Two outputs
  * are produced, a set of keys from the column used in the filter  and a
  * map of key -> table values.
  */

var columnParamInfo = {
	"id": "columnName",
	"title": "Column Name",
	"def": "",
	"prompt": "Enter column name"
}

function setup_params(params) {
	var columnParam = new StringScriptParam(
		columnParamInfo.id,
		columnParamInfo.title,
		columnParamInfo.def);
	columnParam.setPrompt(columnParamInfo.prompt);
	params.add(columnParam);
}

// add custom inputs/outputs here
function init(inputs, outputs) {
	outputs.add("keySet", "Unique values from given column name", false, java.util.Set);
	outputs.add("tableMap", "Map of key -> table values", false, java.util.Map);
}

/*
 * Create a new table with the same schema as the inputTable
 */
function setupTable(inputTable) {
    var table = new DefaultTableDataSource();
    for(c = 0; c < inputTable.columnCount; c++) {
	    var colTitle = inputTable.getColumnTitle(c);
	    table.setColumnTitle(c, colTitle);
	}
	return table;
}

// run operation on table
function tableOp(context, table) {
	// find table column index
	col = table.getColumnIndex(columnName);

	if(col < 0)
		return; // column not found

	var tableMap = new java.util.LinkedHashMap();

	for(row = 0; row < table.rowCount; row++) {
	    // use string value as row key
		var rowKey = Packages.ca.phon.formatter.FormatterUtil.format(table.getValueAt(row, col));

		var keyTable = tableMap.get(rowKey);
		if(keyTable == null) {
		    keyTable = setupTable(table);
		    tableMap.put(rowKey, keyTable);
		}
		keyTable.addRow(table.getRow(row));
	}

	context.put("keySet", tableMap.keySet());
	context.put("tableMap", tableMap);
}
]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="350" y="67"/>
                                    </extensions>
                                </node>
                                <ogcn:macro id="5aee518f" name="Vocalization Analysis" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                    <graph id="4801401e">
                                        <node id="c81dda4" name="result total" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                            <extensions>
                                                <oga:settings>
                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.Integer]]></oga:property>
                                                </oga:settings>
                                                <oga:meta x="15" y="15"/>
                                            </extensions>
                                        </node>
                                        <node id="45508fae" name="speaker" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                            <extensions>
                                                <oga:settings>
                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                </oga:settings>
                                                <oga:meta x="13" y="116"/>
                                            </extensions>
                                        </node>
                                        <node id="578fcaef" name="table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                            <extensions>
                                                <oga:settings>
                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                                </oga:settings>
                                                <oga:meta x="11" y="437"/>
                                            </extensions>
                                        </node>
                                        <node id="7cbf1d09" name="tableMap" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                            <extensions>
                                                <oga:settings>
                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.util.Map]]></oga:property>
                                                </oga:settings>
                                                <oga:meta x="15" y="578"/>
                                            </extensions>
                                        </node>
                                        <node id="e70f62ef9803475e" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                            <extensions>
                                                <oga:settings>
                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                    <oga:property key="contextKey"/>
                                                </oga:settings>
                                                <oga:meta x="22" y="672"/>
                                            </extensions>
                                        </node>
                                        <node id="fe996f4347094d31" name="Summary Table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                            <extensions>
                                                <oga:settings>
                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.TableDataSource]]></oga:property>
                                                    <oga:property key="contextKey"/>
                                                </oga:settings>
                                                <oga:meta x="20" y="778"/>
                                            </extensions>
                                        </node>
                                        <ogcn:macro id="71606628" name="All Vocalizations" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                            <graph id="1e5f74a4">
                                                <node id="61761de3" name="speaker" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="15" y="15"/>
                                                    </extensions>
                                                </node>
                                                <node id="4413c5e1" name="tableMap" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.util.Map]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="15" y="336"/>
                                                    </extensions>
                                                </node>
                                                <node id="a1606265db404383" name="Summary Table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.TableDataSource]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="21" y="470"/>
                                                    </extensions>
                                                </node>
                                                <node id="9b3dbf40ff934c17" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="18" y="589"/>
                                                    </extensions>
                                                </node>
                                                <ogcn:macro id="9fb837e3dd39441b" name="Setup Buffer Name" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                    <graph id="6b80ea4d">
                                                        <node id="890e53f198643a0" name="StringBuffer#&lt;init&gt;(String)" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>(java.lang.String)]]></oga:property>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="15">
                                                                    <oga:default for="arg1" type="java.lang.String"/>
                                                                </oga:meta>
                                                            </extensions>
                                                        </node>
                                                        <node id="48913680b4364ec0" name="Participant" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="146"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="e39e414a958c430d" name="StringBuffer#append(String)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[append(java.lang.String)]]></oga:property>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="256" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="8e39f3647eb3497f" name="StringBuffer#toString()" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[toString()]]></oga:property>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="507" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <link dest="8e39f3647eb3497f" destField="obj" source="e39e414a958c430d" sourceField="value"/>
                                                        <link dest="e39e414a958c430d" destField="obj" source="890e53f198643a0" sourceField="value"/>
                                                        <link dest="e39e414a958c430d" destField="arg1" source="48913680b4364ec0" sourceField="name"/>
                                                        <extensions>
                                                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                        </extensions>
                                                    </graph>
                                                    <ogcn:published_input field="obj" name="speaker" ref="48913680b4364ec0"/>
                                                    <ogcn:published_input field="arg1" name="arg1" ref="890e53f198643a0"/>
                                                    <ogcn:published_output field="value" name="value" ref="8e39f3647eb3497f"/>
                                                    <extensions>
                                                        <oga:meta x="241" y="15">
                                                            <oga:default for="arg1" type="java.lang.String">Total</oga:default>
                                                        </oga:meta>
                                                    </extensions>
                                                </ogcn:macro>
                                                <node id="4584344a" name="Create Totals Table" type="class:ca.phon.app.opgraph.nodes.PhonScriptNode">
                                                    <input name="tableMap" optional="false"/>
                                                    <output name="totalsTable" type="ca.phon.query.report.datasource.DefaultTableDataSource"/>
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="__script"><![CDATA[function init(inputs, outputs) {
	inputs.add("tableMap", "", false, false);

	outputs.add("totalsTable", "", false, Packages.ca.phon.query.report.datasource.DefaultTableDataSource);
}

function run(context) {
	var tableMap = context.get("tableMap");
	var totalsTable = new Packages.ca.phon.query.report.datasource.DefaultTableDataSource();

	totalsTable.setColumnTitle(0, "Session");
	totalsTable.setColumnTitle(1, "Count");

	var keySet = tableMap.keySet();
	var itr = keySet.iterator();
	var total = 0;
	while(itr.hasNext()) {
		var session = itr.next();
		var count = tableMap.get(session).rowCount;
		total += count;

		var rowData = [];
		rowData[0] = session;
		rowData[1] = new java.lang.Integer(count);

		totalsTable.addRow(rowData);
	}

	var rowData = [ "Total", new java.lang.Integer(total) ];
	totalsTable.addRow(rowData);

	context.put("totalsTable", totalsTable);
}
]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="198" y="335"/>
                                                    </extensions>
                                                </node>
                                                <node id="5f701d30" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                    <input name="data" optional="false">Data to print</input>
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="dataTemplate"><![CDATA[$DATA]]></oga:property>
                                                            <oga:property key="showText"><![CDATA[false]]></oga:property>
                                                            <oga:property key="showTable"><![CDATA[true]]></oga:property>
                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="426" y="15"/>
                                                    </extensions>
                                                </node>
                                                <node id="5d862a89" name="Add #Voc/Session" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="__script"><![CDATA[function init(inputs, outputs) {
	inputs.add("totalsTable", "");
}

function tableOp(context, table) {
	var totalsTable = context.get("totalsTable");

	var totalVocalizations = totalsTable.getValueAt(totalsTable.rowCount-1, totalsTable.columnCount-1);
	var numSessions = totalsTable.rowCount-1;

	var freq = new java.lang.Float(totalVocalizations/numSessions);
	
	var colIdx = 0;
	var rowData = [];
	rowData[colIdx++] = "Vocalizations";
	rowData[colIdx++] = "# of vocalizations / session";
	rowData[colIdx++] = freq;

	table.addRow(rowData);
}
]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="501" y="445"/>
                                                    </extensions>
                                                </node>
                                                <ogcn:macro id="1db19bc0aaed4791" name="Add to Report Template" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                    <graph id="6feab1e1">
                                                        <node id="5abc3b51e6843fc" name="Report Template Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="26" y="116"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="d3163ab74e8e4042" name="Set Caption" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                            <input name="data" optional="false">Data to print</input>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="dataTemplate"><![CDATA[
#h3("Vocalizations")

#set($caption = "<h4>Total</h4>")
]]></oga:property>
                                                                    <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                    <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="277" y="60">
                                                                    <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                    <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                </oga:meta>
                                                            </extensions>
                                                        </node>
                                                        <node id="fb614350bf4b4317" name="Add to Template" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                            <input name="data" optional="false">Data to print</input>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="dataTemplate"><![CDATA[
#set($tableName = "$DATA")
#if($tables.containsKey($tableName))
#set($table = $tables.get($tableName))
#printTableWithIdAndCaption( $table $tableName $caption [] )
#else
$caption

No Results
#end
]]></oga:property>
                                                                    <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                    <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="280" y="189">
                                                                    <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                    <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                </oga:meta>
                                                            </extensions>
                                                        </node>
                                                        <link dest="fb614350bf4b4317" destField="buffer" source="5abc3b51e6843fc" sourceField="obj"/>
                                                        <link dest="d3163ab74e8e4042" destField="buffer" source="5abc3b51e6843fc" sourceField="obj"/>
                                                        <extensions>
                                                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                        </extensions>
                                                    </graph>
                                                    <ogcn:published_input field="data" name="speaker" ref="d3163ab74e8e4042"/>
                                                    <ogcn:published_input field="data" name="bufferName" ref="fb614350bf4b4317"/>
                                                    <ogcn:published_input field="obj" name="reportTemplateName" ref="5abc3b51e6843fc"/>
                                                    <extensions>
                                                        <oga:meta x="608" y="15"/>
                                                    </extensions>
                                                </ogcn:macro>
                                                <link dest="4584344a" destField="tableMap" source="4413c5e1" sourceField="obj"/>
                                                <link dest="5f701d30" destField="data" source="4584344a" sourceField="totalsTable"/>
                                                <link dest="1db19bc0aaed4791" destField="bufferName" source="5f701d30" sourceField="buffer"/>
                                                <link dest="5f701d30" destField="buffer" source="9fb837e3dd39441b" sourceField="value"/>
                                                <link dest="1db19bc0aaed4791" destField="speaker" source="61761de3" sourceField="obj"/>
                                                <link dest="9fb837e3dd39441b" destField="speaker" source="61761de3" sourceField="obj"/>
                                                <link dest="5d862a89" destField="table" source="a1606265db404383" sourceField="obj"/>
                                                <link dest="5d862a89" destField="totalsTable" source="4584344a" sourceField="totalsTable"/>
                                                <link dest="1db19bc0aaed4791" destField="reportTemplateName" source="9b3dbf40ff934c17" sourceField="obj"/>
                                                <extensions>
                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                </extensions>
                                            </graph>
                                            <ogcn:published_input field="obj" name="tableMap" ref="4413c5e1"/>
                                            <ogcn:published_input field="obj" name="speaker" ref="61761de3"/>
                                            <ogcn:published_input field="obj" name="summaryTable" ref="a1606265db404383"/>
                                            <ogcn:published_input field="obj" name="bufferName" ref="9b3dbf40ff934c17"/>
                                            <extensions>
                                                <oga:meta x="270" y="12"/>
                                            </extensions>
                                        </ogcn:macro>
                                        <ogcn:macro id="5c298b00" name="Listing" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                            <graph id="6c869ce8">
                                                <node id="77fcdc08" name="data" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="15" y="15"/>
                                                    </extensions>
                                                </node>
                                                <node id="6907e174" name="speaker" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="15" y="156"/>
                                                    </extensions>
                                                </node>
                                                <node id="9783912953c44809" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="15" y="477"/>
                                                    </extensions>
                                                </node>
                                                <ogcn:macro id="2b7f7797b438469c" name="Setup Buffer Name" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                    <graph id="4b81b9c2">
                                                        <node id="1246289b498f4209" name="StringBuffer#&lt;init&gt;(String)" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>(java.lang.String)]]></oga:property>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="15">
                                                                    <oga:default for="arg1" type="java.lang.String"/>
                                                                </oga:meta>
                                                            </extensions>
                                                        </node>
                                                        <node id="9da44f96f0248dc" name="Participant" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="146"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="53da17768cd7475c" name="StringBuffer#append(String)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[append(java.lang.String)]]></oga:property>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="256" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="f622e05eda0e468f" name="StringBuffer#toString()" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[toString()]]></oga:property>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="507" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <link dest="f622e05eda0e468f" destField="obj" source="53da17768cd7475c" sourceField="value"/>
                                                        <link dest="53da17768cd7475c" destField="obj" source="1246289b498f4209" sourceField="value"/>
                                                        <link dest="53da17768cd7475c" destField="arg1" source="9da44f96f0248dc" sourceField="name"/>
                                                        <extensions>
                                                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                        </extensions>
                                                    </graph>
                                                    <ogcn:published_input field="obj" name="speaker" ref="9da44f96f0248dc"/>
                                                    <ogcn:published_input field="arg1" name="arg1" ref="1246289b498f4209"/>
                                                    <ogcn:published_output field="value" name="value" ref="f622e05eda0e468f"/>
                                                    <extensions>
                                                        <oga:meta x="269" y="144">
                                                            <oga:default for="arg1" type="java.lang.String">Listing_</oga:default>
                                                        </oga:meta>
                                                    </extensions>
                                                </ogcn:macro>
                                                <node id="23037170" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                    <input name="data" optional="false">Data to print</input>
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="dataTemplate"><![CDATA[$DATA]]></oga:property>
                                                            <oga:property key="showText"><![CDATA[false]]></oga:property>
                                                            <oga:property key="showTable"><![CDATA[true]]></oga:property>
                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="482" y="126"/>
                                                    </extensions>
                                                </node>
                                                <ogcn:macro id="984965bd195941b7" name="Add to Report Template" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                    <graph id="6df24be4">
                                                        <node id="2a9601681f334544" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="62" y="111"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="d53cd18625e14d06" name="Set Caption" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                            <input name="data" optional="false">Data to print</input>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="dataTemplate"><![CDATA[
#set($caption = "<h4>Listing</h4>")
]]></oga:property>
                                                                    <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                    <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="270" y="76">
                                                                    <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                    <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                </oga:meta>
                                                            </extensions>
                                                        </node>
                                                        <node id="ad051d7bf6a741bd" name="Add to Template" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                            <input name="data" optional="false">Data to print</input>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="dataTemplate"><![CDATA[
#set($tableName = "$DATA")
#if($tables.containsKey($tableName))
#set($table = $tables.get($tableName))
#printTableWithIdAndCaption( $table $tableName $caption ["Session", "Record #", "IPA Actual (Word)"] )
#else
$caption

No Results
#end
]]></oga:property>
                                                                    <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                    <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="274" y="205">
                                                                    <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                    <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                </oga:meta>
                                                            </extensions>
                                                        </node>
                                                        <link dest="d53cd18625e14d06" destField="buffer" source="2a9601681f334544" sourceField="obj"/>
                                                        <link dest="ad051d7bf6a741bd" destField="buffer" source="2a9601681f334544" sourceField="obj"/>
                                                        <extensions>
                                                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                        </extensions>
                                                    </graph>
                                                    <ogcn:published_input field="data" name="speaker" ref="d53cd18625e14d06"/>
                                                    <ogcn:published_input field="data" name="bufferName" ref="ad051d7bf6a741bd"/>
                                                    <ogcn:published_input field="obj" name="obj" ref="2a9601681f334544"/>
                                                    <extensions>
                                                        <oga:meta x="696" y="124"/>
                                                    </extensions>
                                                </ogcn:macro>
                                                <link dest="23037170" destField="buffer" source="2b7f7797b438469c" sourceField="value"/>
                                                <link dest="23037170" destField="data" source="77fcdc08" sourceField="obj"/>
                                                <link dest="2b7f7797b438469c" destField="speaker" source="6907e174" sourceField="obj"/>
                                                <link dest="984965bd195941b7" destField="bufferName" source="23037170" sourceField="buffer"/>
                                                <link dest="984965bd195941b7" destField="speaker" source="6907e174" sourceField="obj"/>
                                                <link dest="984965bd195941b7" destField="obj" source="9783912953c44809" sourceField="obj"/>
                                            </graph>
                                            <ogcn:published_input field="obj" name="data" ref="77fcdc08"/>
                                            <ogcn:published_input field="obj" name="speaker" ref="6907e174"/>
                                            <ogcn:published_input field="obj" name="bufferName" ref="9783912953c44809"/>
                                            <extensions>
                                                <oga:meta x="476" y="12"/>
                                            </extensions>
                                        </ogcn:macro>
                                        <ogcn:macro id="39f91ef7" name="Initial Consonants" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                            <graph id="4d7ea55e">
                                                <node id="1c7877d" name="speaker" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="23" y="29"/>
                                                    </extensions>
                                                </node>
                                                <node id="4ceebc1" name="table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="26" y="343"/>
                                                    </extensions>
                                                </node>
                                                <node id="7cea9759a7104c0e" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="28" y="579"/>
                                                    </extensions>
                                                </node>
                                                <node id="bf992c580e0040f7" name="Summary Table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.TableDataSource]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="32" y="682"/>
                                                    </extensions>
                                                </node>
                                                <ogcn:macro id="3fd5be49" name="Initial Consonants" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                    <graph id="4e3350cd">
                                                        <node id="57fbc98f" name="speaker" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="4582b1f9" name="table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="336"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="3940eee8ae2648ac" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="477"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="1e4b8d36" name="Add Initial Consonant Column" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="__script"><![CDATA[importClass(Packages.ca.phon.ipa.IPATranscriptBuilder)

function init(inputs, outputs) {

}

function tableOp(context, table) {
	var colIdx = table.columnCount;

	table.setColumnTitle(colIdx, "Initial C");

	for(var row = 0; row < table.rowCount; row++) {
		var rowData = table.getRow(row);
		var ipa = (new IPATranscriptBuilder()).append(table.getValueAt(row, "IPA Actual (Word)")).toIPATranscript();
		ipa = ipa.removePunctuation();

		var initialC = "";
		if(ipa.matches("^\\c.*")) {
			initialC = (new IPATranscriptBuilder()).append(ipa.elementAt(0)).toIPATranscript();
		}

		rowData[colIdx] = initialC;
	}
}
]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="242" y="336"/>
                                                            </extensions>
                                                        </node>
                                                        <ogcn:macro id="d0e4e5315d954c27" name="Setup Buffer Name" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                            <graph id="7e6ed2d0">
                                                                <node id="2bad1d607024dae" name="StringBuffer#&lt;init&gt;(String)" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>(java.lang.String)]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="15" y="15">
                                                                            <oga:default for="arg1" type="java.lang.String"/>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <node id="15db6653a6294c18" name="Participant" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="15" y="146"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="d674f76e48834437" name="StringBuffer#append(String)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[append(java.lang.String)]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="256" y="15"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="353dcf36533c4ef9" name="StringBuffer#toString()" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[toString()]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="507" y="15"/>
                                                                    </extensions>
                                                                </node>
                                                                <link dest="353dcf36533c4ef9" destField="obj" source="d674f76e48834437" sourceField="value"/>
                                                                <link dest="d674f76e48834437" destField="obj" source="2bad1d607024dae" sourceField="value"/>
                                                                <link dest="d674f76e48834437" destField="arg1" source="15db6653a6294c18" sourceField="name"/>
                                                                <extensions>
                                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                                </extensions>
                                                            </graph>
                                                            <ogcn:published_input field="obj" name="speaker" ref="15db6653a6294c18"/>
                                                            <ogcn:published_input field="arg1" name="arg1" ref="2bad1d607024dae"/>
                                                            <ogcn:published_output field="value" name="value" ref="353dcf36533c4ef9"/>
                                                            <extensions>
                                                                <oga:meta x="580" y="601">
                                                                    <oga:default for="arg1" type="java.lang.String">Initial Consonants_</oga:default>
                                                                </oga:meta>
                                                            </extensions>
                                                        </ogcn:macro>
                                                        <node id="26edcb08" name="Partition Table" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                            <output name="trueTable" type="ca.phon.query.report.datasource.DefaultTableDataSource">Table of rows from input table which match filter</output>
                                                            <output name="falseTable" type="ca.phon.query.report.datasource.DefaultTableDataSource">Table of rows from output table which do not match the filter</output>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="filters.column.filterType"><![CDATA[Regular expression]]></oga:property>
                                                                    <oga:property key="columnName"><![CDATA[Initial C]]></oga:property>
                                                                    <oga:property key="__script"><![CDATA[/*
 * Phon - An open source tool for research in phonology.
 * Copyright (C) 2005 - 201, Gregory Hedlund <ghedlund@mun.ca> and Yvan Rose <yrose@mun.ca>
 * Dept of Linguistics, Memorial University <https://phon.ca>
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

 /**
  * Partition Table.js
  *
  * Script for use with ca.phon.app.opgraph.nodes.table.TableScriptNode
  *
  * Partition table using a standard query filter and column name.
  */
var PatternFilter = require("lib/PatternFilter").PatternFilter;

var columnParamInfo = {
	"id": "columnName",
	"title": "Column Name",
	"def": "",
	"prompt": "Enter column name"
}

var filters = {
    "column": new PatternFilter("filters.column")
}

function setup_params(params) {
	var columnParam = new StringScriptParam(
		columnParamInfo.id,
		columnParamInfo.title,
		columnParamInfo.def);
	columnParam.setPrompt(columnParamInfo.prompt);
	params.add(columnParam);

	filters.column.param_setup(params);
}

// add custom inputs/outputs here
function init(inputs, outputs) {
	outputs.add("trueTable", "Table of rows from input table which match filter", false, DefaultTableDataSource);
	outputs.add("falseTable", "Table of rows from output table which do not match the filter", false, DefaultTableDataSource);
}

// run operation on table
function tableOp(context, table) {
	// find table column index
	col = table.getColumnIndex(columnName);
	if(col < 0)
		return; // column not found

	// create output tables
	trueTable = new DefaultTableDataSource();
	falseTable = new DefaultTableDataSource();
	for(c = 0; c < table.columnCount; c++) {
	    var colTitle = table.getColumnTitle(c);
	    trueTable.setColumnTitle(c, colTitle);
	    falseTable.setColumnTitle(c, colTitle);
	}

	for(row = 0; row < table.rowCount; row++) {
		rowData = table.getRow(row);
		rowMatches = filterRow(table, row, col);

		if(rowMatches == true) {
			trueTable.addRow(rowData);
		} else {
			falseTable.addRow(rowData);
		}
	}

	context.put("trueTable", trueTable);
	context.put("falseTable", falseTable);
}

function filterRow(table, row, col) {
	var value = table.getValueAt(row, col);
	if(value == null) return false;

	return filters.column.check_filter(value);
}
]]></oga:property>
                                                                    <oga:property key="filters.column.filter"><![CDATA[.+]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="503" y="336"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="d66aa6a" name="DefaultTableDataSource" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="738" y="336"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="157e22dd" type="class:ca.phon.app.opgraph.nodes.table.InventoryNode">
                                                            <extensions>
                                                                <opqry:inventoryoptions>
                                                                    <opqry:column caseSensitive="false" column="Initial C" ignoreDiacritics="true"/>
                                                                </opqry:inventoryoptions>
                                                                <oga:settings/>
                                                                <oga:meta x="965" y="336"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="5142a794" name="Add Frequency Column" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                            <input name="total" optional="false"/>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="__script"><![CDATA[function init(inputs, outputs) {
	inputs.add("total", "", false, false);
}

function tableOp(context, table) {
	var total = context.get("total");
	var colIdx = table.columnCount;
	table.setColumnTitle(colIdx, "%");

	for(var row = 0; row < table.rowCount; row++) {
		var rowData = table.getRow(row);
		var count = rowData[1];
		var freq = (count / total) * 100.0;

		rowData[2] = freq;
	}
}
]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="246" y="494"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="397afdf3" type="class:ca.phon.app.opgraph.nodes.table.SortNode">
                                                            <extensions>
                                                                <opqry:sortoptions>
                                                                    <opqry:sortBy column="Initial C" order="ascending" type="ipa"/>
                                                                </opqry:sortoptions>
                                                                <oga:settings/>
                                                                <oga:meta x="481" y="494"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="7235e753" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                            <input name="data" optional="false">Data to print</input>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="dataTemplate"><![CDATA[$DATA]]></oga:property>
                                                                    <oga:property key="showText"><![CDATA[false]]></oga:property>
                                                                    <oga:property key="showTable"><![CDATA[true]]></oga:property>
                                                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="777" y="496"/>
                                                            </extensions>
                                                        </node>
                                                        <ogcn:macro id="2ce1efd1b9734758" name="Add to Report Template" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                            <graph id="1683b551">
                                                                <node id="37b2ee47b655425e" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="18" y="155"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="e2df1b41e4cd4602" name="Set Caption" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                                    <input name="data" optional="false">Data to print</input>
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="dataTemplate"><![CDATA[
#set($caption = "<h4>Initial Consonants</h4>")
]]></oga:property>
                                                                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="223" y="75">
                                                                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <node id="15480cdd4d7c44ef" name="Add to Template" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                                    <input name="data" optional="false">Data to print</input>
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="dataTemplate"><![CDATA[
#set($tableName = "$DATA")
#if($tables.containsKey($tableName))
#set($table = $tables.get($tableName))
#printTableWithIdAndCaption( $table $tableName $caption [] )
#else
$caption

No Results
#end
]]></oga:property>
                                                                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="226" y="204">
                                                                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <link dest="e2df1b41e4cd4602" destField="buffer" source="37b2ee47b655425e" sourceField="obj"/>
                                                                <link dest="15480cdd4d7c44ef" destField="buffer" source="37b2ee47b655425e" sourceField="obj"/>
                                                                <extensions>
                                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                                </extensions>
                                                            </graph>
                                                            <ogcn:published_input field="data" name="speaker" ref="e2df1b41e4cd4602"/>
                                                            <ogcn:published_input field="data" name="bufferName" ref="15480cdd4d7c44ef"/>
                                                            <ogcn:published_input field="obj" name="reportTemplateName" ref="37b2ee47b655425e"/>
                                                            <extensions>
                                                                <oga:meta x="959" y="496"/>
                                                            </extensions>
                                                        </ogcn:macro>
                                                        <link dest="26edcb08" destField="table" source="1e4b8d36" sourceField="table"/>
                                                        <link dest="d0e4e5315d954c27" destField="speaker" source="57fbc98f" sourceField="obj"/>
                                                        <link dest="2ce1efd1b9734758" destField="speaker" source="57fbc98f" sourceField="obj"/>
                                                        <link dest="7235e753" destField="data" source="397afdf3" sourceField="table"/>
                                                        <link dest="2ce1efd1b9734758" destField="bufferName" source="7235e753" sourceField="buffer"/>
                                                        <link dest="7235e753" destField="buffer" source="d0e4e5315d954c27" sourceField="value"/>
                                                        <link dest="1e4b8d36" destField="table" source="4582b1f9" sourceField="obj"/>
                                                        <link dest="5142a794" destField="table" source="157e22dd" sourceField="table"/>
                                                        <link dest="397afdf3" destField="table" source="5142a794" sourceField="table"/>
                                                        <link dest="2ce1efd1b9734758" destField="reportTemplateName" source="3940eee8ae2648ac" sourceField="obj"/>
                                                        <link dest="d66aa6a" destField="obj" source="26edcb08" sourceField="trueTable"/>
                                                        <link dest="157e22dd" destField="table" source="d66aa6a" sourceField="obj"/>
                                                        <link dest="5142a794" destField="total" source="d66aa6a" sourceField="rowCount"/>
                                                        <extensions>
                                                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                        </extensions>
                                                    </graph>
                                                    <ogcn:published_input field="obj" name="speaker" ref="57fbc98f"/>
                                                    <ogcn:published_input field="obj" name="table" ref="4582b1f9"/>
                                                    <ogcn:published_input field="obj" name="bufferName" ref="3940eee8ae2648ac"/>
                                                    <ogcn:published_output field="table" name="table" ref="157e22dd"/>
                                                    <extensions>
                                                        <oga:meta x="300" y="27"/>
                                                    </extensions>
                                                </ogcn:macro>
                                                <ogcn:macro id="37993d4121c64985" name="Initial Consonants (by Session)" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                    <graph id="1f7bd088">
                                                        <node id="cba87bdb9f4473f" name="speaker" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="1fe296e468a143cc" name="table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="336"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="f64efbf247a43c3" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="578"/>
                                                            </extensions>
                                                        </node>
                                                        <ogcn:macro id="3e38c47bc57c4820" name="Setup Buffer Name" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                            <graph id="23d8c4da">
                                                                <node id="36141faa30144b28" name="StringBuffer#&lt;init&gt;(String)" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>(java.lang.String)]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="15" y="15">
                                                                            <oga:default for="arg1" type="java.lang.String"/>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <node id="75b169e16a0b4649" name="Participant" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="15" y="146"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="d02558744eeb4bd9" name="StringBuffer#append(String)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[append(java.lang.String)]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="256" y="15"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="15a1e71b2584c30" name="StringBuffer#toString()" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[toString()]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="507" y="15"/>
                                                                    </extensions>
                                                                </node>
                                                                <link dest="15a1e71b2584c30" destField="obj" source="d02558744eeb4bd9" sourceField="value"/>
                                                                <link dest="d02558744eeb4bd9" destField="obj" source="36141faa30144b28" sourceField="value"/>
                                                                <link dest="d02558744eeb4bd9" destField="arg1" source="75b169e16a0b4649" sourceField="name"/>
                                                                <extensions>
                                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                                </extensions>
                                                            </graph>
                                                            <ogcn:published_input field="obj" name="speaker" ref="75b169e16a0b4649"/>
                                                            <ogcn:published_input field="arg1" name="arg1" ref="36141faa30144b28"/>
                                                            <ogcn:published_output field="value" name="value" ref="15a1e71b2584c30"/>
                                                            <extensions>
                                                                <oga:meta x="241" y="15">
                                                                    <oga:default for="arg1" type="java.lang.String">Initial Consonants (by Session)_</oga:default>
                                                                </oga:meta>
                                                            </extensions>
                                                        </ogcn:macro>
                                                        <node id="575dcc9dac31425d" name="Add Initial Consonant Column" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="__script"><![CDATA[importClass(Packages.ca.phon.ipa.IPATranscriptBuilder)

function init(inputs, outputs) {

}

function tableOp(context, table) {
	var colIdx = table.columnCount;

	table.setColumnTitle(colIdx, "Initial C");

	for(var row = 0; row < table.rowCount; row++) {
		var rowData = table.getRow(row);
		var ipa = (new IPATranscriptBuilder()).append(table.getValueAt(row, "IPA Actual (Word)")).toIPATranscript();
		ipa = ipa.removePunctuation();

		var initialC = "";
		if(ipa.matches("^\\c.*")) {
			initialC = (new IPATranscriptBuilder()).append(ipa.elementAt(0)).toIPATranscript();
		}

		rowData[colIdx] = initialC;
	}
}
]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="242" y="336"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="d2d0e4adf72b455b" name="Partition Table" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                            <output name="trueTable" type="ca.phon.query.report.datasource.DefaultTableDataSource">Table of rows from input table which match filter</output>
                                                            <output name="falseTable" type="ca.phon.query.report.datasource.DefaultTableDataSource">Table of rows from output table which do not match the filter</output>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="filters.column.filterType"><![CDATA[Regular expression]]></oga:property>
                                                                    <oga:property key="columnName"><![CDATA[Initial C]]></oga:property>
                                                                    <oga:property key="__script"><![CDATA[/*
 * Phon - An open source tool for research in phonology.
 * Copyright (C) 2005 - 201, Gregory Hedlund <ghedlund@mun.ca> and Yvan Rose <yrose@mun.ca>
 * Dept of Linguistics, Memorial University <https://phon.ca>
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

 /**
  * Partition Table.js
  *
  * Script for use with ca.phon.app.opgraph.nodes.table.TableScriptNode
  *
  * Partition table using a standard query filter and column name.
  */
var PatternFilter = require("lib/PatternFilter").PatternFilter;

var columnParamInfo = {
	"id": "columnName",
	"title": "Column Name",
	"def": "",
	"prompt": "Enter column name"
}

var filters = {
    "column": new PatternFilter("filters.column")
}

function setup_params(params) {
	var columnParam = new StringScriptParam(
		columnParamInfo.id,
		columnParamInfo.title,
		columnParamInfo.def);
	columnParam.setPrompt(columnParamInfo.prompt);
	params.add(columnParam);

	filters.column.param_setup(params);
}

// add custom inputs/outputs here
function init(inputs, outputs) {
	outputs.add("trueTable", "Table of rows from input table which match filter", false, DefaultTableDataSource);
	outputs.add("falseTable", "Table of rows from output table which do not match the filter", false, DefaultTableDataSource);
}

// run operation on table
function tableOp(context, table) {
	// find table column index
	col = table.getColumnIndex(columnName);
	if(col < 0)
		return; // column not found

	// create output tables
	trueTable = new DefaultTableDataSource();
	falseTable = new DefaultTableDataSource();
	for(c = 0; c < table.columnCount; c++) {
	    var colTitle = table.getColumnTitle(c);
	    trueTable.setColumnTitle(c, colTitle);
	    falseTable.setColumnTitle(c, colTitle);
	}

	for(row = 0; row < table.rowCount; row++) {
		rowData = table.getRow(row);
		rowMatches = filterRow(table, row, col);

		if(rowMatches == true) {
			trueTable.addRow(rowData);
		} else {
			falseTable.addRow(rowData);
		}
	}

	context.put("trueTable", trueTable);
	context.put("falseTable", falseTable);
}

function filterRow(table, row, col) {
	var value = table.getValueAt(row, col);
	if(value == null) return false;

	return filters.column.check_filter(value);
}
]]></oga:property>
                                                                    <oga:property key="filters.column.filter"><![CDATA[.+]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="503" y="336"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="e4b60d5da7634e1c" type="class:ca.phon.app.opgraph.nodes.table.InventoryNode">
                                                            <extensions>
                                                                <opqry:inventoryoptions>
                                                                    <opqry:groupBy caseSensitive="false" column="Session" ignoreDiacritics="true"/>
                                                                    <opqry:column caseSensitive="false" column="Initial C" ignoreDiacritics="true"/>
                                                                </opqry:inventoryoptions>
                                                                <oga:settings/>
                                                                <oga:meta x="738" y="336"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="41dceaee2c4a46ae" name="Add Frequency Columns" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                            <output name="freqTable" type="ca.phon.query.report.datasource.DefaultTableDataSource"/>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="__script"><![CDATA[function init(inputs, outputs) {
	//inputs.add("tableMap", "", false, false);

	outputs.add("freqTable", "", false, Packages.ca.phon.query.report.datasource.DefaultTableDataSource);
}

function tableOp(context, table) {
	//var tableMap = context.get("tableMap");
	var freqTable = new Packages.ca.phon.query.report.datasource.DefaultTableDataSource();

	// setup columns
	freqTable.setColumnTitle(0, table.getColumnTitle(0));

	var colIdx = 1;
	for(var col = 1; col < table.columnCount; col++) {
		freqTable.setColumnTitle(colIdx++, table.getColumnTitle(col));
		freqTable.setColumnTitle(colIdx++, "% " + table.getColumnTitle(col));
	}

	// calculate column totals
	var columnTotals = [];
	for(var col = 1; col < table.columnCount; col++) {
		var sessionName = table.getColumnTitle(col);
		var total = 0;
		for(var row = 0; row < table.rowCount; row++) {
			total += table.getValueAt(row, col).intValue();
		}

		columnTotals[sessionName] = total;
	}

	for(var row = 0; row < table.rowCount; row++) {
		var rowData = [];
		var tableData = table.getRow(row);

		rowData[0] = tableData[0];
		colIdx = 1;

		for(var col = 1; col < table.columnCount; col++) {
			var total = columnTotals[table.getColumnTitle(col)];
			
			
			var count = tableData[col];
			var freq = (count / total) * 100.0;

			rowData[colIdx++] = new java.lang.Integer(count);
			rowData[colIdx++] = freq;
		}

		freqTable.addRow(rowData);
	}

	context.put("freqTable", freqTable);
}
]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="913" y="336"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="da71e3439700466e" type="class:ca.phon.app.opgraph.nodes.table.SortNode">
                                                            <extensions>
                                                                <opqry:sortoptions>
                                                                    <opqry:sortBy column="Initial C" order="ascending" type="ipa"/>
                                                                </opqry:sortoptions>
                                                                <oga:settings/>
                                                                <oga:meta x="1148" y="336"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="6965f08f0a4b4299" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                            <input name="data" optional="false">Data to print</input>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="dataTemplate"><![CDATA[$DATA]]></oga:property>
                                                                    <oga:property key="showText"><![CDATA[false]]></oga:property>
                                                                    <oga:property key="showTable"><![CDATA[true]]></oga:property>
                                                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="426" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <ogcn:macro id="2757403bb10d4c6a" name="Add to Report Template" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                            <graph id="35ad2c03">
                                                                <node id="9148e05bdd5d43bc" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="19" y="171"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="23fa7ff5b4ea43b2" name="Set Caption" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                                    <input name="data" optional="false">Data to print</input>
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="dataTemplate"><![CDATA[
#set($caption = "<h4>Initial Consonants (by Session)</h4>")
]]></oga:property>
                                                                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="211" y="99">
                                                                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <node id="d59a8cafd1654e11" name="Add to Template" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                                    <input name="data" optional="false">Data to print</input>
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="dataTemplate"><![CDATA[
#set($tableName = "$DATA")
#if($tables.containsKey($tableName))
#set($table = $tables.get($tableName))
#printTableWithIdAndCaption( $table $tableName $caption [] )
#else
$caption

No Results
#end
]]></oga:property>
                                                                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="214" y="228">
                                                                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <link dest="23fa7ff5b4ea43b2" destField="buffer" source="9148e05bdd5d43bc" sourceField="obj"/>
                                                                <link dest="d59a8cafd1654e11" destField="buffer" source="9148e05bdd5d43bc" sourceField="obj"/>
                                                                <extensions>
                                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                                </extensions>
                                                            </graph>
                                                            <ogcn:published_input field="data" name="speaker" ref="23fa7ff5b4ea43b2"/>
                                                            <ogcn:published_input field="data" name="bufferName" ref="d59a8cafd1654e11"/>
                                                            <ogcn:published_input field="obj" name="reportTemplateName" ref="9148e05bdd5d43bc"/>
                                                            <extensions>
                                                                <oga:meta x="608" y="15"/>
                                                            </extensions>
                                                        </ogcn:macro>
                                                        <link dest="d2d0e4adf72b455b" destField="table" source="575dcc9dac31425d" sourceField="table"/>
                                                        <link dest="3e38c47bc57c4820" destField="speaker" source="cba87bdb9f4473f" sourceField="obj"/>
                                                        <link dest="2757403bb10d4c6a" destField="speaker" source="cba87bdb9f4473f" sourceField="obj"/>
                                                        <link dest="6965f08f0a4b4299" destField="data" source="da71e3439700466e" sourceField="table"/>
                                                        <link dest="2757403bb10d4c6a" destField="bufferName" source="6965f08f0a4b4299" sourceField="buffer"/>
                                                        <link dest="6965f08f0a4b4299" destField="buffer" source="3e38c47bc57c4820" sourceField="value"/>
                                                        <link dest="575dcc9dac31425d" destField="table" source="1fe296e468a143cc" sourceField="obj"/>
                                                        <link dest="e4b60d5da7634e1c" destField="table" source="d2d0e4adf72b455b" sourceField="trueTable"/>
                                                        <link dest="41dceaee2c4a46ae" destField="table" source="e4b60d5da7634e1c" sourceField="table"/>
                                                        <link dest="da71e3439700466e" destField="table" source="41dceaee2c4a46ae" sourceField="freqTable"/>
                                                        <link dest="2757403bb10d4c6a" destField="reportTemplateName" source="f64efbf247a43c3" sourceField="obj"/>
                                                        <extensions>
                                                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                        </extensions>
                                                    </graph>
                                                    <ogcn:published_input field="obj" name="speaker" ref="cba87bdb9f4473f"/>
                                                    <ogcn:published_input field="obj" name="table" ref="1fe296e468a143cc"/>
                                                    <ogcn:published_input field="obj" name="bufferName" ref="f64efbf247a43c3"/>
                                                    <extensions>
                                                        <oga:meta x="296" y="208"/>
                                                    </extensions>
                                                </ogcn:macro>
                                                <node id="38a662c4" name="Add Row to Summary" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="__script"><![CDATA[function init(inputs, outputs) {
	inputs.add("inventory", "");
}

function tableOp(context, table) {
	var inventory = context.get("inventory");

	var rowData = [];
	var colIdx = 0;

	rowData[colIdx++] = "";
	rowData[colIdx++] = "# of unique initial consonants";
	rowData[colIdx++] = new java.lang.Integer(inventory.rowCount);

	table.addRow(rowData);
}
]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="595" y="413"/>
                                                    </extensions>
                                                </node>
                                                <link dest="37993d4121c64985" destField="speaker" source="1c7877d" sourceField="obj"/>
                                                <link dest="3fd5be49" destField="table" source="4ceebc1" sourceField="obj"/>
                                                <link dest="3fd5be49" destField="speaker" source="1c7877d" sourceField="obj"/>
                                                <link dest="37993d4121c64985" destField="table" source="4ceebc1" sourceField="obj"/>
                                                <link dest="3fd5be49" destField="bufferName" source="7cea9759a7104c0e" sourceField="obj"/>
                                                <link dest="38a662c4" destField="table" source="bf992c580e0040f7" sourceField="obj"/>
                                                <link dest="38a662c4" destField="inventory" source="3fd5be49" sourceField="table"/>
                                                <link dest="37993d4121c64985" destField="bufferName" source="7cea9759a7104c0e" sourceField="obj"/>
                                                <extensions>
                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                </extensions>
                                            </graph>
                                            <ogcn:published_input field="obj" name="speaker" ref="1c7877d"/>
                                            <ogcn:published_input field="obj" name="table" ref="4ceebc1"/>
                                            <ogcn:published_input field="obj" name="bufferName" ref="7cea9759a7104c0e"/>
                                            <ogcn:published_input field="obj" name="summaryTable" ref="bf992c580e0040f7"/>
                                            <extensions>
                                                <oga:meta x="270" y="179"/>
                                            </extensions>
                                        </ogcn:macro>
                                        <ogcn:macro id="9bee85a827324705" name="Final Consonants" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                            <graph id="39654264">
                                                <node id="dcaa3f64052e4667" name="speaker" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="15" y="146"/>
                                                    </extensions>
                                                </node>
                                                <node id="be648f920a40a0" name="table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="15" y="439"/>
                                                    </extensions>
                                                </node>
                                                <node id="fa7015f475cd4627" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="17" y="675"/>
                                                    </extensions>
                                                </node>
                                                <node id="426e192785444d8e" name="Summary Table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.TableDataSource]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="20" y="778"/>
                                                    </extensions>
                                                </node>
                                                <ogcn:macro id="47ab9f734c8d4a3b" name="Final Consonants" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                    <graph id="31c341db">
                                                        <node id="80e97d2a3c2241e1" name="speaker" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="390d058f9a044b28" name="table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="336"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="bda95bc0fa934b71" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="19" y="485"/>
                                                            </extensions>
                                                        </node>
                                                        <ogcn:macro id="9652772da905453d" name="Setup Buffer Name" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                            <graph id="41dc6cc6">
                                                                <node id="6920880660024a22" name="StringBuffer#&lt;init&gt;(String)" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>(java.lang.String)]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="15" y="15">
                                                                            <oga:default for="arg1" type="java.lang.String"/>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <node id="76b46236243a45a9" name="Participant" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="15" y="146"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="bb746653c425459c" name="StringBuffer#append(String)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[append(java.lang.String)]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="256" y="15"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="4da5c016f6f0427a" name="StringBuffer#toString()" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[toString()]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="507" y="15"/>
                                                                    </extensions>
                                                                </node>
                                                                <link dest="4da5c016f6f0427a" destField="obj" source="bb746653c425459c" sourceField="value"/>
                                                                <link dest="bb746653c425459c" destField="obj" source="6920880660024a22" sourceField="value"/>
                                                                <link dest="bb746653c425459c" destField="arg1" source="76b46236243a45a9" sourceField="name"/>
                                                                <extensions>
                                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                                </extensions>
                                                            </graph>
                                                            <ogcn:published_input field="obj" name="speaker" ref="76b46236243a45a9"/>
                                                            <ogcn:published_input field="arg1" name="arg1" ref="6920880660024a22"/>
                                                            <ogcn:published_output field="value" name="value" ref="4da5c016f6f0427a"/>
                                                            <extensions>
                                                                <oga:meta x="241" y="15">
                                                                    <oga:default for="arg1" type="java.lang.String">Final Consonants_</oga:default>
                                                                </oga:meta>
                                                            </extensions>
                                                        </ogcn:macro>
                                                        <node id="83392f37c32b4f47" name="Add Final Consonant Column" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="__script"><![CDATA[importClass(Packages.ca.phon.ipa.IPATranscriptBuilder)

function init(inputs, outputs) {

}

function tableOp(context, table) {
	var colIdx = table.columnCount;

	table.setColumnTitle(colIdx, "Final C");

	for(var row = 0; row < table.rowCount; row++) {
		var rowData = table.getRow(row);
		var ipa = (new IPATranscriptBuilder()).append(table.getValueAt(row, "IPA Actual (Word)")).toIPATranscript();
		ipa = ipa.removePunctuation();

		var finalC = "";
		if(ipa.matches(".*\\c$")) {
			finalC = (new IPATranscriptBuilder()).append(ipa.elementAt(ipa.length()-1)).toIPATranscript();
		}

		rowData[colIdx] = finalC;
	}
}
]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="242" y="336"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="c8d9bf6512514970" name="Partition Table" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                            <output name="trueTable" type="ca.phon.query.report.datasource.DefaultTableDataSource">Table of rows from input table which match filter</output>
                                                            <output name="falseTable" type="ca.phon.query.report.datasource.DefaultTableDataSource">Table of rows from output table which do not match the filter</output>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="filters.column.exactMatch"><![CDATA[true]]></oga:property>
                                                                    <oga:property key="filters.column.filterType"><![CDATA[Regular expression]]></oga:property>
                                                                    <oga:property key="columnName"><![CDATA[Final C]]></oga:property>
                                                                    <oga:property key="__script"><![CDATA[/*
 * Phon - An open source tool for research in phonology.
 * Copyright (C) 2005 - 201, Gregory Hedlund <ghedlund@mun.ca> and Yvan Rose <yrose@mun.ca>
 * Dept of Linguistics, Memorial University <https://phon.ca>
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

 /**
  * Partition Table.js
  *
  * Script for use with ca.phon.app.opgraph.nodes.table.TableScriptNode
  *
  * Partition table using a standard query filter and column name.
  */
var PatternFilter = require("lib/PatternFilter").PatternFilter;

var columnParamInfo = {
	"id": "columnName",
	"title": "Column Name",
	"def": "",
	"prompt": "Enter column name"
}

var filters = {
    "column": new PatternFilter("filters.column")
}

function setup_params(params) {
	var columnParam = new StringScriptParam(
		columnParamInfo.id,
		columnParamInfo.title,
		columnParamInfo.def);
	columnParam.setPrompt(columnParamInfo.prompt);
	params.add(columnParam);

	filters.column.param_setup(params);
}

// add custom inputs/outputs here
function init(inputs, outputs) {
	outputs.add("trueTable", "Table of rows from input table which match filter", false, DefaultTableDataSource);
	outputs.add("falseTable", "Table of rows from output table which do not match the filter", false, DefaultTableDataSource);
}

// run operation on table
function tableOp(context, table) {
	// find table column index
	col = table.getColumnIndex(columnName);
	if(col < 0)
		return; // column not found

	// create output tables
	trueTable = new DefaultTableDataSource();
	falseTable = new DefaultTableDataSource();
	for(c = 0; c < table.columnCount; c++) {
	    var colTitle = table.getColumnTitle(c);
	    trueTable.setColumnTitle(c, colTitle);
	    falseTable.setColumnTitle(c, colTitle);
	}

	for(row = 0; row < table.rowCount; row++) {
		rowData = table.getRow(row);
		rowMatches = filterRow(table, row, col);

		if(rowMatches == true) {
			trueTable.addRow(rowData);
		} else {
			falseTable.addRow(rowData);
		}
	}

	context.put("trueTable", trueTable);
	context.put("falseTable", falseTable);
}

function filterRow(table, row, col) {
	var value = table.getValueAt(row, col);
	if(value == null) return false;

	return filters.column.check_filter(value);
}
]]></oga:property>
                                                                    <oga:property key="filters.column.allowOverlap"><![CDATA[false]]></oga:property>
                                                                    <oga:property key="filters.column.caseSensitive"><![CDATA[false]]></oga:property>
                                                                    <oga:property key="filters.column.filter"><![CDATA[.+]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="497" y="336"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="19c21fe28f584032" type="class:ca.phon.app.opgraph.nodes.table.InventoryNode">
                                                            <extensions>
                                                                <opqry:inventoryoptions>
                                                                    <opqry:column caseSensitive="false" column="Final C" ignoreDiacritics="true"/>
                                                                </opqry:inventoryoptions>
                                                                <oga:settings/>
                                                                <oga:meta x="732" y="336"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="43edc518" name="DefaultTableDataSource" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="683" y="475"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="140e94fe8d404799" name="Add Frequency Column" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                            <input name="total" optional="false"/>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="__script"><![CDATA[function init(inputs, outputs) {
	inputs.add("total", "", false, false);
}

function tableOp(context, table) {
	var total = context.get("total");
	var colIdx = table.columnCount;
	table.setColumnTitle(colIdx, "%");

	for(var row = 0; row < table.rowCount; row++) {
		var rowData = table.getRow(row);
		var count = rowData[1];
		var freq = (count / total) * 100.0;

		rowData[2] = freq;
	}
}
]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="907" y="336"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="af085cd0ea414e90" type="class:ca.phon.app.opgraph.nodes.table.SortNode">
                                                            <extensions>
                                                                <opqry:sortoptions>
                                                                    <opqry:sortBy column="Final C" order="ascending" type="ipa"/>
                                                                </opqry:sortoptions>
                                                                <oga:settings/>
                                                                <oga:meta x="242" y="477"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="941aba68558e4eda" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                            <input name="data" optional="false">Data to print</input>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="dataTemplate"><![CDATA[$DATA]]></oga:property>
                                                                    <oga:property key="showText"><![CDATA[false]]></oga:property>
                                                                    <oga:property key="showTable"><![CDATA[true]]></oga:property>
                                                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="426" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <ogcn:macro id="967e25fed06a45d5" name="Add to Report Template" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                            <graph id="18b1663c">
                                                                <node id="c1f55f84fdb74de8" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="21" y="249"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="32755b70291d4792" name="Set Caption" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                                    <input name="data" optional="false">Data to print</input>
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="dataTemplate"><![CDATA[
#set($caption = "<h4>Final Consonants</h4>")
]]></oga:property>
                                                                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="215" y="161">
                                                                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <node id="79475fce80924888" name="Add to Template" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                                    <input name="data" optional="false">Data to print</input>
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="dataTemplate"><![CDATA[
#set($tableName = "$DATA")
#if($tables.containsKey($tableName))
#set($table = $tables.get($tableName))
#printTableWithIdAndCaption( $table $tableName $caption [] )
#else
$caption

No Results
#end
]]></oga:property>
                                                                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="218" y="290">
                                                                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <link dest="32755b70291d4792" destField="buffer" source="c1f55f84fdb74de8" sourceField="obj"/>
                                                                <link dest="79475fce80924888" destField="buffer" source="c1f55f84fdb74de8" sourceField="obj"/>
                                                                <extensions>
                                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                                </extensions>
                                                            </graph>
                                                            <ogcn:published_input field="data" name="speaker" ref="32755b70291d4792"/>
                                                            <ogcn:published_input field="data" name="bufferName" ref="79475fce80924888"/>
                                                            <ogcn:published_input field="obj" name="reportTemplateName" ref="c1f55f84fdb74de8"/>
                                                            <extensions>
                                                                <oga:meta x="608" y="15"/>
                                                            </extensions>
                                                        </ogcn:macro>
                                                        <link dest="9652772da905453d" destField="speaker" source="80e97d2a3c2241e1" sourceField="obj"/>
                                                        <link dest="967e25fed06a45d5" destField="speaker" source="80e97d2a3c2241e1" sourceField="obj"/>
                                                        <link dest="941aba68558e4eda" destField="data" source="af085cd0ea414e90" sourceField="table"/>
                                                        <link dest="967e25fed06a45d5" destField="bufferName" source="941aba68558e4eda" sourceField="buffer"/>
                                                        <link dest="941aba68558e4eda" destField="buffer" source="9652772da905453d" sourceField="value"/>
                                                        <link dest="83392f37c32b4f47" destField="table" source="390d058f9a044b28" sourceField="obj"/>
                                                        <link dest="140e94fe8d404799" destField="table" source="19c21fe28f584032" sourceField="table"/>
                                                        <link dest="af085cd0ea414e90" destField="table" source="140e94fe8d404799" sourceField="table"/>
                                                        <link dest="c8d9bf6512514970" destField="table" source="83392f37c32b4f47" sourceField="table"/>
                                                        <link dest="19c21fe28f584032" destField="table" source="c8d9bf6512514970" sourceField="trueTable"/>
                                                        <link dest="43edc518" destField="obj" source="c8d9bf6512514970" sourceField="trueTable"/>
                                                        <link dest="140e94fe8d404799" destField="total" source="43edc518" sourceField="rowCount"/>
                                                        <link dest="967e25fed06a45d5" destField="reportTemplateName" source="bda95bc0fa934b71" sourceField="obj"/>
                                                        <extensions>
                                                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                        </extensions>
                                                    </graph>
                                                    <ogcn:published_input field="obj" name="speaker" ref="80e97d2a3c2241e1"/>
                                                    <ogcn:published_input field="obj" name="table" ref="390d058f9a044b28"/>
                                                    <ogcn:published_input field="obj" name="bufferName" ref="bda95bc0fa934b71"/>
                                                    <ogcn:published_output field="table" name="table" ref="19c21fe28f584032"/>
                                                    <extensions>
                                                        <oga:meta x="236" y="42"/>
                                                    </extensions>
                                                </ogcn:macro>
                                                <ogcn:macro id="a2bb4201f25d43e2" name="Final Consonants (by Session)" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                    <graph id="7c74b521">
                                                        <node id="16d6d864e68f4401" name="speaker" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="36f52067ce1f4419" name="table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="308"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="f3980f8b99674809" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="33" y="475"/>
                                                            </extensions>
                                                        </node>
                                                        <ogcn:macro id="f95553da65fe4df7" name="Setup Buffer Name" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                            <graph id="11e5c003">
                                                                <node id="2649c5d0d2574530" name="StringBuffer#&lt;init&gt;(String)" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>(java.lang.String)]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="15" y="15">
                                                                            <oga:default for="arg1" type="java.lang.String"/>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <node id="45d523a15fdf4a20" name="Participant" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="15" y="146"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="8898987594734735" name="StringBuffer#append(String)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[append(java.lang.String)]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="256" y="15"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="f3f0737d626d42b2" name="StringBuffer#toString()" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[toString()]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="507" y="15"/>
                                                                    </extensions>
                                                                </node>
                                                                <link dest="f3f0737d626d42b2" destField="obj" source="8898987594734735" sourceField="value"/>
                                                                <link dest="8898987594734735" destField="obj" source="2649c5d0d2574530" sourceField="value"/>
                                                                <link dest="8898987594734735" destField="arg1" source="45d523a15fdf4a20" sourceField="name"/>
                                                                <extensions>
                                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                                </extensions>
                                                            </graph>
                                                            <ogcn:published_input field="obj" name="speaker" ref="45d523a15fdf4a20"/>
                                                            <ogcn:published_input field="arg1" name="arg1" ref="2649c5d0d2574530"/>
                                                            <ogcn:published_output field="value" name="value" ref="f3f0737d626d42b2"/>
                                                            <extensions>
                                                                <oga:meta x="321" y="68">
                                                                    <oga:default for="arg1" type="java.lang.String">Final Consonants (by Session)_</oga:default>
                                                                </oga:meta>
                                                            </extensions>
                                                        </ogcn:macro>
                                                        <node id="a2fc327ba656458f" name="Add Final Consonant Column" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="__script"><![CDATA[importClass(Packages.ca.phon.ipa.IPATranscriptBuilder)

function init(inputs, outputs) {

}

function tableOp(context, table) {
	var colIdx = table.columnCount;

	table.setColumnTitle(colIdx, "Final C");

	for(var row = 0; row < table.rowCount; row++) {
		var rowData = table.getRow(row);
		var ipa = (new IPATranscriptBuilder()).append(table.getValueAt(row, "IPA Actual (Word)")).toIPATranscript();
		ipa = ipa.removePunctuation();

		var finalC = "";
		if(ipa.matches(".*\\c$")) {
			finalC = (new IPATranscriptBuilder()).append(ipa.elementAt(ipa.length()-1)).toIPATranscript();
		}

		rowData[colIdx] = finalC;
	}
}
]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="300" y="238"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="eb8416e76b304213" name="Partition Table" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                            <output name="trueTable" type="ca.phon.query.report.datasource.DefaultTableDataSource">Table of rows from input table which match filter</output>
                                                            <output name="falseTable" type="ca.phon.query.report.datasource.DefaultTableDataSource">Table of rows from output table which do not match the filter</output>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="filters.column.exactMatch"><![CDATA[true]]></oga:property>
                                                                    <oga:property key="filters.column.filterType"><![CDATA[Regular expression]]></oga:property>
                                                                    <oga:property key="columnName"><![CDATA[Final C]]></oga:property>
                                                                    <oga:property key="__script"><![CDATA[/*
 * Phon - An open source tool for research in phonology.
 * Copyright (C) 2005 - 201, Gregory Hedlund <ghedlund@mun.ca> and Yvan Rose <yrose@mun.ca>
 * Dept of Linguistics, Memorial University <https://phon.ca>
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

 /**
  * Partition Table.js
  *
  * Script for use with ca.phon.app.opgraph.nodes.table.TableScriptNode
  *
  * Partition table using a standard query filter and column name.
  */
var PatternFilter = require("lib/PatternFilter").PatternFilter;

var columnParamInfo = {
	"id": "columnName",
	"title": "Column Name",
	"def": "",
	"prompt": "Enter column name"
}

var filters = {
    "column": new PatternFilter("filters.column")
}

function setup_params(params) {
	var columnParam = new StringScriptParam(
		columnParamInfo.id,
		columnParamInfo.title,
		columnParamInfo.def);
	columnParam.setPrompt(columnParamInfo.prompt);
	params.add(columnParam);

	filters.column.param_setup(params);
}

// add custom inputs/outputs here
function init(inputs, outputs) {
	outputs.add("trueTable", "Table of rows from input table which match filter", false, DefaultTableDataSource);
	outputs.add("falseTable", "Table of rows from output table which do not match the filter", false, DefaultTableDataSource);
}

// run operation on table
function tableOp(context, table) {
	// find table column index
	col = table.getColumnIndex(columnName);
	if(col < 0)
		return; // column not found

	// create output tables
	trueTable = new DefaultTableDataSource();
	falseTable = new DefaultTableDataSource();
	for(c = 0; c < table.columnCount; c++) {
	    var colTitle = table.getColumnTitle(c);
	    trueTable.setColumnTitle(c, colTitle);
	    falseTable.setColumnTitle(c, colTitle);
	}

	for(row = 0; row < table.rowCount; row++) {
		rowData = table.getRow(row);
		rowMatches = filterRow(table, row, col);

		if(rowMatches == true) {
			trueTable.addRow(rowData);
		} else {
			falseTable.addRow(rowData);
		}
	}

	context.put("trueTable", trueTable);
	context.put("falseTable", falseTable);
}

function filterRow(table, row, col) {
	var value = table.getValueAt(row, col);
	if(value == null) return false;

	return filters.column.check_filter(value);
}
]]></oga:property>
                                                                    <oga:property key="filters.column.allowOverlap"><![CDATA[false]]></oga:property>
                                                                    <oga:property key="filters.column.caseSensitive"><![CDATA[false]]></oga:property>
                                                                    <oga:property key="filters.column.filter"><![CDATA[.+]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="519" y="242"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="93d898e7d3974832" type="class:ca.phon.app.opgraph.nodes.table.InventoryNode">
                                                            <extensions>
                                                                <opqry:inventoryoptions>
                                                                    <opqry:groupBy caseSensitive="false" column="Session" ignoreDiacritics="true"/>
                                                                    <opqry:column caseSensitive="false" column="Final C" ignoreDiacritics="true"/>
                                                                </opqry:inventoryoptions>
                                                                <oga:settings/>
                                                                <oga:meta x="726" y="238"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="2f70db5025ff4e1c" name="Add Frequency Columns" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                            <output name="freqTable" type="ca.phon.query.report.datasource.DefaultTableDataSource"/>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="__script"><![CDATA[function init(inputs, outputs) {
//	inputs.add("tableMap", "", false, false);

	outputs.add("freqTable", "", false, Packages.ca.phon.query.report.datasource.DefaultTableDataSource);
}

function tableOp(context, table) {
//	var tableMap = context.get("tableMap");
	var freqTable = new Packages.ca.phon.query.report.datasource.DefaultTableDataSource();

	// setup columns
	freqTable.setColumnTitle(0, table.getColumnTitle(0));

	var colIdx = 1;
	for(var col = 1; col < table.columnCount; col++) {
		freqTable.setColumnTitle(colIdx++, table.getColumnTitle(col));
		freqTable.setColumnTitle(colIdx++, "% " + table.getColumnTitle(col));
	}

	// calculate column totals
	var columnTotals = [];
	for(var col = 1; col < table.columnCount; col++) {
		var sessionName = table.getColumnTitle(col);
		var total = 0;
		for(var row = 0; row < table.rowCount; row++) {
			total += table.getValueAt(row, col).intValue();
		}

		columnTotals[sessionName] = total;
	}
	
	for(var row = 0; row < table.rowCount; row++) {
		var rowData = [];
		var tableData = table.getRow(row);

		rowData[0] = tableData[0];
		colIdx = 1;

		for(var col = 1; col < table.columnCount; col++) {
			var total = columnTotals[table.getColumnTitle(col)];
			var count = tableData[col];
			var freq = (count / total) * 100.0;

			rowData[colIdx++] = new java.lang.Integer(count);
			rowData[colIdx++] = freq;
		}

		freqTable.addRow(rowData);
	}

	context.put("freqTable", freqTable);
}
]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="684" y="449"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="a41037cab06c49d9" type="class:ca.phon.app.opgraph.nodes.table.SortNode">
                                                            <extensions>
                                                                <opqry:sortoptions>
                                                                    <opqry:sortBy column="Final C" order="ascending" type="ipa"/>
                                                                </opqry:sortoptions>
                                                                <oga:settings/>
                                                                <oga:meta x="879" y="238"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="21dcf03bfb1149fa" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                            <input name="data" optional="false">Data to print</input>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="dataTemplate"><![CDATA[$DATA]]></oga:property>
                                                                    <oga:property key="showText"><![CDATA[false]]></oga:property>
                                                                    <oga:property key="showTable"><![CDATA[true]]></oga:property>
                                                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="715" y="75"/>
                                                            </extensions>
                                                        </node>
                                                        <ogcn:macro id="84bcd69765fa42b7" name="Add to Report Template" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                            <graph id="4a923e27">
                                                                <node id="d9213760499a4a45" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="29" y="167"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="5cf269c3c60d42fe" name="Set Caption" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                                    <input name="data" optional="false">Data to print</input>
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="dataTemplate"><![CDATA[
#set($caption = "<h4>Final Consonants (by Session)</h4>")
]]></oga:property>
                                                                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="258" y="105">
                                                                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <node id="5eafac57c0664949" name="Add to Template" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                                    <input name="data" optional="false">Data to print</input>
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="dataTemplate"><![CDATA[
#set($tableName = "$DATA")
#if($tables.containsKey($tableName))
#set($table = $tables.get($tableName))
#printTableWithIdAndCaption( $table $tableName $caption [] )
#else
$caption

No Results
#end
]]></oga:property>
                                                                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="261" y="234">
                                                                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <link dest="5cf269c3c60d42fe" destField="buffer" source="d9213760499a4a45" sourceField="obj"/>
                                                                <link dest="5eafac57c0664949" destField="buffer" source="d9213760499a4a45" sourceField="obj"/>
                                                                <extensions>
                                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                                </extensions>
                                                            </graph>
                                                            <ogcn:published_input field="data" name="speaker" ref="5cf269c3c60d42fe"/>
                                                            <ogcn:published_input field="data" name="bufferName" ref="5eafac57c0664949"/>
                                                            <ogcn:published_input field="obj" name="reportTemplateName" ref="d9213760499a4a45"/>
                                                            <extensions>
                                                                <oga:meta x="874" y="75"/>
                                                            </extensions>
                                                        </ogcn:macro>
                                                        <link dest="f95553da65fe4df7" destField="speaker" source="16d6d864e68f4401" sourceField="obj"/>
                                                        <link dest="84bcd69765fa42b7" destField="speaker" source="16d6d864e68f4401" sourceField="obj"/>
                                                        <link dest="21dcf03bfb1149fa" destField="data" source="a41037cab06c49d9" sourceField="table"/>
                                                        <link dest="84bcd69765fa42b7" destField="bufferName" source="21dcf03bfb1149fa" sourceField="buffer"/>
                                                        <link dest="21dcf03bfb1149fa" destField="buffer" source="f95553da65fe4df7" sourceField="value"/>
                                                        <link dest="a2fc327ba656458f" destField="table" source="36f52067ce1f4419" sourceField="obj"/>
                                                        <link dest="2f70db5025ff4e1c" destField="table" source="93d898e7d3974832" sourceField="table"/>
                                                        <link dest="a41037cab06c49d9" destField="table" source="2f70db5025ff4e1c" sourceField="freqTable"/>
                                                        <link dest="eb8416e76b304213" destField="table" source="a2fc327ba656458f" sourceField="table"/>
                                                        <link dest="93d898e7d3974832" destField="table" source="eb8416e76b304213" sourceField="trueTable"/>
                                                        <link dest="84bcd69765fa42b7" destField="reportTemplateName" source="f3980f8b99674809" sourceField="obj"/>
                                                        <extensions>
                                                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                        </extensions>
                                                    </graph>
                                                    <ogcn:published_input field="obj" name="speaker" ref="16d6d864e68f4401"/>
                                                    <ogcn:published_input field="obj" name="table" ref="36f52067ce1f4419"/>
                                                    <ogcn:published_input field="obj" name="bufferName" ref="f3980f8b99674809"/>
                                                    <extensions>
                                                        <oga:meta x="415" y="212"/>
                                                    </extensions>
                                                </ogcn:macro>
                                                <node id="84fb765a142d40cd" name="Add Row to Summary" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="__script"><![CDATA[function init(inputs, outputs) {
	inputs.add("inventory", "");
}

function tableOp(context, table) {
	var inventory = context.get("inventory");

	var rowData = [];
	var colIdx = 0;

	rowData[colIdx++] = "";
	rowData[colIdx++] = "# of unique final consonants";
	rowData[colIdx++] = new java.lang.Integer(inventory.rowCount);

	table.addRow(rowData);
}
]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="520" y="583"/>
                                                    </extensions>
                                                </node>
                                                <link dest="a2bb4201f25d43e2" destField="speaker" source="dcaa3f64052e4667" sourceField="obj"/>
                                                <link dest="47ab9f734c8d4a3b" destField="table" source="be648f920a40a0" sourceField="obj"/>
                                                <link dest="47ab9f734c8d4a3b" destField="speaker" source="dcaa3f64052e4667" sourceField="obj"/>
                                                <link dest="a2bb4201f25d43e2" destField="table" source="be648f920a40a0" sourceField="obj"/>
                                                <link dest="47ab9f734c8d4a3b" destField="bufferName" source="fa7015f475cd4627" sourceField="obj"/>
                                                <link dest="84fb765a142d40cd" destField="inventory" source="47ab9f734c8d4a3b" sourceField="table"/>
                                                <link dest="84fb765a142d40cd" destField="table" source="426e192785444d8e" sourceField="obj"/>
                                                <link dest="a2bb4201f25d43e2" destField="bufferName" source="fa7015f475cd4627" sourceField="obj"/>
                                                <extensions>
                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                </extensions>
                                            </graph>
                                            <ogcn:published_input field="obj" name="speaker" ref="dcaa3f64052e4667"/>
                                            <ogcn:published_input field="obj" name="table" ref="be648f920a40a0"/>
                                            <ogcn:published_input field="obj" name="bufferName" ref="fa7015f475cd4627"/>
                                            <ogcn:published_input field="obj" name="summaryTable" ref="426e192785444d8e"/>
                                            <extensions>
                                                <oga:meta x="476" y="179"/>
                                            </extensions>
                                        </ogcn:macro>
                                        <ogcn:macro id="9dee81f2bd624468" name="Vowels" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                            <graph id="65a77f">
                                                <node id="4286091421414cd3" name="table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="15" y="15"/>
                                                    </extensions>
                                                </node>
                                                <node id="f69bce99bd234bf6" name="Participant" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="15" y="160"/>
                                                    </extensions>
                                                </node>
                                                <node id="468498d8b0074181" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="20" y="478"/>
                                                    </extensions>
                                                </node>
                                                <node id="b3c94cedb46a45c7" name="Summary Table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.TableDataSource]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="18" y="584"/>
                                                    </extensions>
                                                </node>
                                                <node id="6ac5430e4a2a4274" name="Create Vowel Table" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                    <output name="vowelTable" type="ca.phon.query.report.datasource.DefaultTableDataSource"/>
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="__script"><![CDATA[importClass(Packages.ca.phon.ipa.IPATranscriptBuilder)

function init(inputs, outputs) {
	outputs.add("vowelTable", "", false, Packages.ca.phon.query.report.datasource.DefaultTableDataSource);
}

function tableOp(context, table) {
	var vowelTable = new Packages.ca.phon.query.report.datasource.DefaultTableDataSource();

	// setup columns
	vowelTable.setColumnTitle(0, "Session");
	vowelTable.setColumnTitle(1, "Record");
	vowelTable.setColumnTitle(2, "Vowel");
	vowelTable.setColumnTitle(3, "Actual Syllabification (Word)");

	for(var row = 0; row < table.rowCount; row++) {
		var tableData = table.getRow(row);

		var actualSyllabification = table.getValueAt(row, "Actual Syllabification (Word)");
		var ipa = (new IPATranscriptBuilder()).append(actualSyllabification).toIPATranscript();
		var sylls = ipa.syllables();

		for(var syllIdx = 0; syllIdx < sylls.size(); syllIdx++) {
			var syll = sylls.get(syllIdx);
			var phonexPattern = Packages.ca.phon.phonex.PhonexPattern.compile(".:N+");
			var matcher = phonexPattern.matcher(syll);
			if(matcher.find()) {
				var nucleus = (new IPATranscriptBuilder()).append(matcher.group()).toIPATranscript();

				var rowData = [];
				rowData[0] = table.getValueAt(row, 0);
				rowData[1] = table.getValueAt(row, "Record #");
				rowData[2] = nucleus;
				rowData[3] = actualSyllabification;
				vowelTable.addRow(rowData);
			}
		}
	}

	context.put("vowelTable", vowelTable);
}
]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="302" y="41"/>
                                                    </extensions>
                                                </node>
                                                <ogcn:macro id="b22af37adc0e4a9b" name="Vowels (Total)" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                    <graph id="69491230">
                                                        <node id="598e44aa449b4309" name="obj" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="30ce4f66bf8f4c6c" name="speaker" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="297"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="8392bbd6e064719" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="618"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="cd1c7130d14a4351" type="class:ca.phon.app.opgraph.nodes.table.InventoryNode">
                                                            <extensions>
                                                                <opqry:inventoryoptions>
                                                                    <opqry:column caseSensitive="false" column="Vowel" ignoreDiacritics="true"/>
                                                                </opqry:inventoryoptions>
                                                                <oga:settings/>
                                                                <oga:meta x="242" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="10ea9b12e8f049b9" name="DefaultTableDataSource" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="242" y="156"/>
                                                            </extensions>
                                                        </node>
                                                        <ogcn:macro id="733c98b32c2e4d2d" name="Setup Buffer Name" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                            <graph id="5e2a5d15">
                                                                <node id="7a87f8d8852147eb" name="StringBuffer#&lt;init&gt;(String)" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>(java.lang.String)]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="15" y="15">
                                                                            <oga:default for="arg1" type="java.lang.String"/>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <node id="59be75fa8daa44d2" name="Participant" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="15" y="146"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="52bd63948b164fab" name="StringBuffer#append(String)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[append(java.lang.String)]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="256" y="15"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="d986160dcbcf4d7e" name="StringBuffer#toString()" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[toString()]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="507" y="15"/>
                                                                    </extensions>
                                                                </node>
                                                                <link dest="d986160dcbcf4d7e" destField="obj" source="52bd63948b164fab" sourceField="value"/>
                                                                <link dest="52bd63948b164fab" destField="obj" source="7a87f8d8852147eb" sourceField="value"/>
                                                                <link dest="52bd63948b164fab" destField="arg1" source="59be75fa8daa44d2" sourceField="name"/>
                                                                <extensions>
                                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                                </extensions>
                                                            </graph>
                                                            <ogcn:published_input field="obj" name="speaker" ref="59be75fa8daa44d2"/>
                                                            <ogcn:published_input field="arg1" name="arg1" ref="7a87f8d8852147eb"/>
                                                            <ogcn:published_output field="value" name="value" ref="d986160dcbcf4d7e"/>
                                                            <extensions>
                                                                <oga:meta x="241" y="297">
                                                                    <oga:default for="arg1" type="java.lang.String">Vowel Inventory_</oga:default>
                                                                </oga:meta>
                                                            </extensions>
                                                        </ogcn:macro>
                                                        <node id="1232952ac10d4297" name="Add Frequency Column" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                            <input name="total" optional="false"/>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="__script"><![CDATA[function init(inputs, outputs) {
	inputs.add("total", "", false, false);
}

function tableOp(context, table) {
	var total = context.get("total");
	var colIdx = table.columnCount;
	table.setColumnTitle(colIdx, "%");

	for(var row = 0; row < table.rowCount; row++) {
		var rowData = table.getRow(row);
		var count = rowData[1];
		var freq = (count / total) * 100.0;

		rowData[2] = freq;
	}
}
]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="417" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="ba92fb2d0d3844d9" type="class:ca.phon.app.opgraph.nodes.table.SortNode">
                                                            <extensions>
                                                                <opqry:sortoptions>
                                                                    <opqry:sortBy column="Vowel" order="ascending" type="plain"/>
                                                                </opqry:sortoptions>
                                                                <oga:settings/>
                                                                <oga:meta x="652" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="b7ae094ebc7a48f4" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                            <input name="data" optional="false">Data to print</input>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="dataTemplate"><![CDATA[$DATA]]></oga:property>
                                                                    <oga:property key="showText"><![CDATA[false]]></oga:property>
                                                                    <oga:property key="showTable"><![CDATA[true]]></oga:property>
                                                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="827" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <ogcn:macro id="7b2d6525577d4b08" name="Add to Report Template" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                            <graph id="352a9792">
                                                                <node id="7c2987b10e864f73" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="25" y="108"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="6c838b5323d24987" name="Set Caption" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                                    <input name="data" optional="false">Data to print</input>
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="dataTemplate"><![CDATA[
#set($caption = "<h4>Vowel Inventory</h4>")
]]></oga:property>
                                                                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="203" y="59">
                                                                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <node id="bd289cc636ca423f" name="Add to Template" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                                    <input name="data" optional="false">Data to print</input>
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="dataTemplate"><![CDATA[
#set($tableName = "$DATA")
#if($tables.containsKey($tableName))
#set($table = $tables.get($tableName))
#printTableWithIdAndCaption( $table $tableName $caption [] )
#else
$caption

No Results
#end
]]></oga:property>
                                                                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="206" y="188">
                                                                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <link dest="6c838b5323d24987" destField="buffer" source="7c2987b10e864f73" sourceField="obj"/>
                                                                <link dest="bd289cc636ca423f" destField="buffer" source="7c2987b10e864f73" sourceField="obj"/>
                                                                <extensions>
                                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                                </extensions>
                                                            </graph>
                                                            <ogcn:published_input field="data" name="speaker" ref="6c838b5323d24987"/>
                                                            <ogcn:published_input field="data" name="bufferName" ref="bd289cc636ca423f"/>
                                                            <ogcn:published_input field="obj" name="reportTemplateName" ref="7c2987b10e864f73"/>
                                                            <extensions>
                                                                <oga:meta x="1009" y="15"/>
                                                            </extensions>
                                                        </ogcn:macro>
                                                        <link dest="ba92fb2d0d3844d9" destField="table" source="1232952ac10d4297" sourceField="table"/>
                                                        <link dest="b7ae094ebc7a48f4" destField="data" source="ba92fb2d0d3844d9" sourceField="table"/>
                                                        <link dest="733c98b32c2e4d2d" destField="speaker" source="30ce4f66bf8f4c6c" sourceField="obj"/>
                                                        <link dest="7b2d6525577d4b08" destField="speaker" source="30ce4f66bf8f4c6c" sourceField="obj"/>
                                                        <link dest="1232952ac10d4297" destField="total" source="10ea9b12e8f049b9" sourceField="rowCount"/>
                                                        <link dest="10ea9b12e8f049b9" destField="obj" source="598e44aa449b4309" sourceField="obj"/>
                                                        <link dest="b7ae094ebc7a48f4" destField="buffer" source="733c98b32c2e4d2d" sourceField="value"/>
                                                        <link dest="7b2d6525577d4b08" destField="bufferName" source="b7ae094ebc7a48f4" sourceField="buffer"/>
                                                        <link dest="1232952ac10d4297" destField="table" source="cd1c7130d14a4351" sourceField="table"/>
                                                        <link dest="cd1c7130d14a4351" destField="table" source="598e44aa449b4309" sourceField="obj"/>
                                                        <link dest="7b2d6525577d4b08" destField="reportTemplateName" source="8392bbd6e064719" sourceField="obj"/>
                                                        <extensions>
                                                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                        </extensions>
                                                    </graph>
                                                    <ogcn:published_input field="obj" name="speaker" ref="30ce4f66bf8f4c6c"/>
                                                    <ogcn:published_input field="obj" name="obj" ref="598e44aa449b4309"/>
                                                    <ogcn:published_input field="obj" name="bufferName" ref="8392bbd6e064719"/>
                                                    <ogcn:published_output field="table" name="table" ref="cd1c7130d14a4351"/>
                                                    <extensions>
                                                        <oga:meta x="559" y="27"/>
                                                    </extensions>
                                                </ogcn:macro>
                                                <ogcn:macro id="65bf101fb2f14ead" name="Vowels (by Session)" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                    <graph id="5164fbe8">
                                                        <node id="76e8171f93824e4d" name="table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="453fc2350efc478e" name="speaker" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="297"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="bba80f2b5fa4204" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="618"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="e8096b1c415d4b71" type="class:ca.phon.app.opgraph.nodes.table.InventoryNode">
                                                            <extensions>
                                                                <opqry:inventoryoptions>
                                                                    <opqry:groupBy caseSensitive="false" column="Session" ignoreDiacritics="true"/>
                                                                    <opqry:column caseSensitive="false" column="Vowel" ignoreDiacritics="true"/>
                                                                </opqry:inventoryoptions>
                                                                <oga:settings/>
                                                                <oga:meta x="242" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="b65dd07081f94f95" name="Split Table" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                            <output name="keySet" type="java.util.Set">Unique values from given column name</output>
                                                            <output name="tableMap" type="java.util.Map">Map of key -&gt; table values</output>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="columnName"><![CDATA[Session]]></oga:property>
                                                                    <oga:property key="__script"><![CDATA[/*
 * Phon - An open source tool for research in phonology.
 * Copyright (C) 2005 - 2017, Gregory Hedlund <ghedlund@mun.ca> and Yvan Rose <yrose@mun.ca>
 * Dept of Linguistics, Memorial University <https://phon.ca>
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

 /**
  * Split Table.js
  *
  * Script for use with ca.phon.app.opgraph.nodes.table.TableScriptNode
  *
  * Split table based on column name.  Two outputs
  * are produced, a set of keys from the column used in the filter  and a
  * map of key -> table values.
  */

var columnParamInfo = {
	"id": "columnName",
	"title": "Column Name",
	"def": "",
	"prompt": "Enter column name"
}

function setup_params(params) {
	var columnParam = new StringScriptParam(
		columnParamInfo.id,
		columnParamInfo.title,
		columnParamInfo.def);
	columnParam.setPrompt(columnParamInfo.prompt);
	params.add(columnParam);
}

// add custom inputs/outputs here
function init(inputs, outputs) {
	outputs.add("keySet", "Unique values from given column name", false, java.util.Set);
	outputs.add("tableMap", "Map of key -> table values", false, java.util.Map);
}

/*
 * Create a new table with the same schema as the inputTable
 */
function setupTable(inputTable) {
    var table = new DefaultTableDataSource();
    for(c = 0; c < inputTable.columnCount; c++) {
	    var colTitle = inputTable.getColumnTitle(c);
	    table.setColumnTitle(c, colTitle);
	}
	return table;
}

// run operation on table
function tableOp(context, table) {
	// find table column index
	col = table.getColumnIndex(columnName);

	if(col < 0)
		return; // column not found

	var tableMap = new java.util.LinkedHashMap();

	for(row = 0; row < table.rowCount; row++) {
	    // use string value as row key
		var rowKey = Packages.ca.phon.formatter.FormatterUtil.format(table.getValueAt(row, col));

		var keyTable = tableMap.get(rowKey);
		if(keyTable == null) {
		    keyTable = setupTable(table);
		    tableMap.put(rowKey, keyTable);
		}
		keyTable.addRow(table.getRow(row));
	}

	context.put("keySet", tableMap.keySet());
	context.put("tableMap", tableMap);
}
]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="242" y="156"/>
                                                            </extensions>
                                                        </node>
                                                        <ogcn:macro id="a84edd9fd9184180" name="Setup Buffer Name" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                            <graph id="6b695a8c">
                                                                <node id="d9ed09013a49449c" name="StringBuffer#&lt;init&gt;(String)" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>(java.lang.String)]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="15" y="15">
                                                                            <oga:default for="arg1" type="java.lang.String"/>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <node id="23d7e1fdd6874eb9" name="Participant" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="15" y="146"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="fab81f0030e3406b" name="StringBuffer#append(String)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[append(java.lang.String)]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="256" y="15"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="ae004a49d79a4085" name="StringBuffer#toString()" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[toString()]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="507" y="15"/>
                                                                    </extensions>
                                                                </node>
                                                                <link dest="ae004a49d79a4085" destField="obj" source="fab81f0030e3406b" sourceField="value"/>
                                                                <link dest="fab81f0030e3406b" destField="obj" source="d9ed09013a49449c" sourceField="value"/>
                                                                <link dest="fab81f0030e3406b" destField="arg1" source="23d7e1fdd6874eb9" sourceField="name"/>
                                                                <extensions>
                                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                                </extensions>
                                                            </graph>
                                                            <ogcn:published_input field="obj" name="speaker" ref="23d7e1fdd6874eb9"/>
                                                            <ogcn:published_input field="arg1" name="arg1" ref="d9ed09013a49449c"/>
                                                            <ogcn:published_output field="value" name="value" ref="ae004a49d79a4085"/>
                                                            <extensions>
                                                                <oga:meta x="241" y="297">
                                                                    <oga:default for="arg1" type="java.lang.String">Vowel Inventory (by Session)_</oga:default>
                                                                </oga:meta>
                                                            </extensions>
                                                        </ogcn:macro>
                                                        <node id="35abd40b9b9f4fb0" name="Add Frequency Columns" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                            <input name="tableMap" optional="false"/>
                                                            <output name="freqTable" type="ca.phon.query.report.datasource.DefaultTableDataSource"/>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="__script"><![CDATA[function init(inputs, outputs) {
	inputs.add("tableMap", "", false, false);

	outputs.add("freqTable", "", false, Packages.ca.phon.query.report.datasource.DefaultTableDataSource);
}

function tableOp(context, table) {
	var tableMap = context.get("tableMap");
	var freqTable = new Packages.ca.phon.query.report.datasource.DefaultTableDataSource();

	// setup columns
	freqTable.setColumnTitle(0, table.getColumnTitle(0));

	var colIdx = 1;
	for(var col = 1; col < table.columnCount; col++) {
		freqTable.setColumnTitle(colIdx++, table.getColumnTitle(col));
		freqTable.setColumnTitle(colIdx++, "% " + table.getColumnTitle(col));
	}

	for(var row = 0; row < table.rowCount; row++) {
		var rowData = [];
		var tableData = table.getRow(row);

		rowData[0] = tableData[0];
		colIdx = 1;

		for(var col = 1; col < table.columnCount; col++) {
			var total = tableMap.get(table.getColumnTitle(col)).rowCount;
			var count = tableData[col];
			var freq = (count / total) * 100.0;

			rowData[colIdx++] = new java.lang.Integer(count);
			rowData[colIdx++] = freq;
		}

		freqTable.addRow(rowData);
	}

	context.put("freqTable", freqTable);
}
]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="417" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="f25fd64007f74beb" type="class:ca.phon.app.opgraph.nodes.table.SortNode">
                                                            <extensions>
                                                                <opqry:sortoptions>
                                                                    <opqry:sortBy column="Vowel" order="ascending" type="plain"/>
                                                                </opqry:sortoptions>
                                                                <oga:settings/>
                                                                <oga:meta x="652" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="a7876fffb3de4666" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                            <input name="data" optional="false">Data to print</input>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="dataTemplate"><![CDATA[$DATA]]></oga:property>
                                                                    <oga:property key="showText"><![CDATA[false]]></oga:property>
                                                                    <oga:property key="showTable"><![CDATA[true]]></oga:property>
                                                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="827" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <ogcn:macro id="2e9d54b2ee794331" name="Add to Report Template" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                            <graph id="1dc0f39c">
                                                                <node id="74881e462e034083" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="18" y="213"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="62e290107bd64979" name="Set Caption" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                                    <input name="data" optional="false">Data to print</input>
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="dataTemplate"><![CDATA[
#set($caption = "<h4>Vowel Inventory (by Session)</h4>")
]]></oga:property>
                                                                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="205" y="139">
                                                                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <node id="426b2500e544331" name="Add to Template" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                                    <input name="data" optional="false">Data to print</input>
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="dataTemplate"><![CDATA[
#set($tableName = "$DATA")
#if($tables.containsKey($tableName))
#set($table = $tables.get($tableName))
#printTableWithIdAndCaption( $table $tableName $caption [] )
#else
$caption

No Results
#end
]]></oga:property>
                                                                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="208" y="268">
                                                                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <link dest="62e290107bd64979" destField="buffer" source="74881e462e034083" sourceField="obj"/>
                                                                <link dest="426b2500e544331" destField="buffer" source="74881e462e034083" sourceField="obj"/>
                                                                <extensions>
                                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                                </extensions>
                                                            </graph>
                                                            <ogcn:published_input field="data" name="speaker" ref="62e290107bd64979"/>
                                                            <ogcn:published_input field="data" name="bufferName" ref="426b2500e544331"/>
                                                            <ogcn:published_input field="obj" name="reportTemplateName" ref="74881e462e034083"/>
                                                            <extensions>
                                                                <oga:meta x="1009" y="15"/>
                                                            </extensions>
                                                        </ogcn:macro>
                                                        <link dest="a7876fffb3de4666" destField="data" source="f25fd64007f74beb" sourceField="table"/>
                                                        <link dest="a84edd9fd9184180" destField="speaker" source="453fc2350efc478e" sourceField="obj"/>
                                                        <link dest="2e9d54b2ee794331" destField="speaker" source="453fc2350efc478e" sourceField="obj"/>
                                                        <link dest="a7876fffb3de4666" destField="buffer" source="a84edd9fd9184180" sourceField="value"/>
                                                        <link dest="2e9d54b2ee794331" destField="bufferName" source="a7876fffb3de4666" sourceField="buffer"/>
                                                        <link dest="e8096b1c415d4b71" destField="table" source="76e8171f93824e4d" sourceField="obj"/>
                                                        <link dest="b65dd07081f94f95" destField="table" source="76e8171f93824e4d" sourceField="obj"/>
                                                        <link dest="35abd40b9b9f4fb0" destField="tableMap" source="b65dd07081f94f95" sourceField="tableMap"/>
                                                        <link dest="35abd40b9b9f4fb0" destField="table" source="e8096b1c415d4b71" sourceField="table"/>
                                                        <link dest="f25fd64007f74beb" destField="table" source="35abd40b9b9f4fb0" sourceField="freqTable"/>
                                                        <link dest="2e9d54b2ee794331" destField="reportTemplateName" source="bba80f2b5fa4204" sourceField="obj"/>
                                                        <extensions>
                                                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                        </extensions>
                                                    </graph>
                                                    <ogcn:published_input field="obj" name="speaker" ref="453fc2350efc478e"/>
                                                    <ogcn:published_input field="obj" name="obj" ref="76e8171f93824e4d"/>
                                                    <ogcn:published_input field="obj" name="bufferName" ref="bba80f2b5fa4204"/>
                                                    <extensions>
                                                        <oga:meta x="557" y="175"/>
                                                    </extensions>
                                                </ogcn:macro>
                                                <node id="6abedfe79ca14089" name="Add Row to Summary" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="__script"><![CDATA[function init(inputs, outputs) {
	inputs.add("inventory", "");
}

function tableOp(context, table) {
	var inventory = context.get("inventory");

	var rowData = [];
	var colIdx = 0;

	rowData[colIdx++] = "";
	rowData[colIdx++] = "# of unique vowels";
	rowData[colIdx++] = new java.lang.Integer(inventory.rowCount);

	table.addRow(rowData);
}
]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="597" y="413"/>
                                                    </extensions>
                                                </node>
                                                <link dest="6ac5430e4a2a4274" destField="table" source="4286091421414cd3" sourceField="obj"/>
                                                <link dest="b22af37adc0e4a9b" destField="speaker" source="f69bce99bd234bf6" sourceField="obj"/>
                                                <link dest="65bf101fb2f14ead" destField="speaker" source="f69bce99bd234bf6" sourceField="obj"/>
                                                <link dest="65bf101fb2f14ead" destField="obj" source="6ac5430e4a2a4274" sourceField="vowelTable"/>
                                                <link dest="b22af37adc0e4a9b" destField="obj" source="6ac5430e4a2a4274" sourceField="vowelTable"/>
                                                <link dest="b22af37adc0e4a9b" destField="bufferName" source="468498d8b0074181" sourceField="obj"/>
                                                <link dest="65bf101fb2f14ead" destField="bufferName" source="468498d8b0074181" sourceField="obj"/>
                                                <link dest="6abedfe79ca14089" destField="inventory" source="b22af37adc0e4a9b" sourceField="table"/>
                                                <link dest="6abedfe79ca14089" destField="table" source="b3c94cedb46a45c7" sourceField="obj"/>
                                                <extensions>
                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                </extensions>
                                            </graph>
                                            <ogcn:published_input field="obj" name="table" ref="4286091421414cd3"/>
                                            <ogcn:published_input field="obj" name="obj" ref="f69bce99bd234bf6"/>
                                            <ogcn:published_input field="obj" name="bufferName" ref="468498d8b0074181"/>
                                            <ogcn:published_input field="obj" name="summaryTable" ref="b3c94cedb46a45c7"/>
                                            <extensions>
                                                <oga:meta x="660" y="179"/>
                                            </extensions>
                                        </ogcn:macro>
                                        <ogcn:macro id="fbb7c1ceae774d2a" name="Vocalization Structure" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                            <graph id="77a0b1df">
                                                <node id="db2fcf7cec6341e0" name="TableDataSource" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.TableDataSource]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="13" y="26"/>
                                                    </extensions>
                                                </node>
                                                <node id="d3c301bd634242c2" name="Participant" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="13" y="147"/>
                                                    </extensions>
                                                </node>
                                                <node id="a44025d200db4ad6" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="13" y="468"/>
                                                    </extensions>
                                                </node>
                                                <node id="85ac255934fb4b3d" name="Summary Table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.TableDataSource]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="13" y="569"/>
                                                    </extensions>
                                                </node>
                                                <node id="b74ab4e5fde149c6" name="Add IPA Cover Column" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="__script"><![CDATA[importClass(Packages.ca.phon.ipa.IPATranscriptBuilder)

function init(inputs, outputs) {
}

var symbolMap = "H={glottal}; G=\\g; C=\\c; V=\\v";

function tableOp(context, table) {
	var structureColIdx = table.columnCount;
	table.setColumnTitle(structureColIdx, "Structure");

	for(var row = 0; row < table.rowCount; row++) {
		var tableData = table.getRow(row);

		var actualSyllabification = table.getValueAt(row, "Actual Syllabification (Word)");
		var ipa = (new IPATranscriptBuilder()).append(actualSyllabification).toIPATranscript();

		tableData[structureColIdx] = ipa.cover(symbolMap);
	}
}
]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="281" y="115"/>
                                                    </extensions>
                                                </node>
                                                <ogcn:macro id="d6dcaea1e62046f7" name="Structures (Total)" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                    <graph id="5f51aa46">
                                                        <node id="7d0ef2fe71254e04" name="TableDataSource" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.TableDataSource]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="5c8fc34cf2af4389" name="speaker" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="156"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="dfb1169db3844027" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="17" y="474"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="a12598f7c4e34dcc" type="class:ca.phon.app.opgraph.nodes.table.InventoryNode">
                                                            <extensions>
                                                                <opqry:inventoryoptions>
                                                                    <opqry:column caseSensitive="false" column="Structure" ignoreDiacritics="true"/>
                                                                </opqry:inventoryoptions>
                                                                <oga:settings/>
                                                                <oga:meta x="242" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <ogcn:macro id="771d9807b4946a1" name="Setup Buffer Name" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                            <graph id="c449290">
                                                                <node id="2d3cee440e084941" name="StringBuffer#&lt;init&gt;(String)" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>(java.lang.String)]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="15" y="15">
                                                                            <oga:default for="arg1" type="java.lang.String"/>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <node id="b2076b125f5f46e9" name="Participant" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="15" y="146"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="3d6454dbd8164002" name="StringBuffer#append(String)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[append(java.lang.String)]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="256" y="15"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="eea155121c344e5b" name="StringBuffer#toString()" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[toString()]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="507" y="15"/>
                                                                    </extensions>
                                                                </node>
                                                                <link dest="eea155121c344e5b" destField="obj" source="3d6454dbd8164002" sourceField="value"/>
                                                                <link dest="3d6454dbd8164002" destField="obj" source="2d3cee440e084941" sourceField="value"/>
                                                                <link dest="3d6454dbd8164002" destField="arg1" source="b2076b125f5f46e9" sourceField="name"/>
                                                                <extensions>
                                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                                </extensions>
                                                            </graph>
                                                            <ogcn:published_input field="obj" name="speaker" ref="b2076b125f5f46e9"/>
                                                            <ogcn:published_input field="arg1" name="arg1" ref="2d3cee440e084941"/>
                                                            <ogcn:published_output field="value" name="value" ref="eea155121c344e5b"/>
                                                            <extensions>
                                                                <oga:meta x="241" y="156">
                                                                    <oga:default for="arg1" type="java.lang.String">Vocalization Structure_</oga:default>
                                                                </oga:meta>
                                                            </extensions>
                                                        </ogcn:macro>
                                                        <node id="8ecf968b16c24594" name="Add Frequency Column" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                            <input name="total" optional="false"/>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="__script"><![CDATA[function init(inputs, outputs) {
	inputs.add("total", "", false, false);
}

function tableOp(context, table) {
	var total = context.get("total");
	var colIdx = table.columnCount;
	table.setColumnTitle(colIdx, "%");

	for(var row = 0; row < table.rowCount; row++) {
		var rowData = table.getRow(row);
		var count = rowData[1];
		var freq = (count / total) * 100.0;

		rowData[2] = freq;
	}
}
]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="417" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="33ee13c79ef4cc3" type="class:ca.phon.app.opgraph.nodes.table.SortNode">
                                                            <extensions>
                                                                <opqry:sortoptions>
                                                                    <opqry:sortBy column="Structure" order="ascending" type="plain"/>
                                                                </opqry:sortoptions>
                                                                <oga:settings/>
                                                                <oga:meta x="656" y="30"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="177756b09f2c4e9c" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                            <input name="data" optional="false">Data to print</input>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="dataTemplate"><![CDATA[$DATA]]></oga:property>
                                                                    <oga:property key="showText"><![CDATA[false]]></oga:property>
                                                                    <oga:property key="showTable"><![CDATA[true]]></oga:property>
                                                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="449" y="320"/>
                                                            </extensions>
                                                        </node>
                                                        <ogcn:macro id="6083f3b1fec0421a" name="Add to Report Template" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                            <graph id="58df3e1">
                                                                <node id="de8581e5cfac497f" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="35" y="157"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="fc87f3a92fe4bdf" name="Set Caption" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                                    <input name="data" optional="false">Data to print</input>
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="dataTemplate"><![CDATA[
#set($caption = "<h4>Vocalization Structure</h4>")
]]></oga:property>
                                                                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="265" y="74">
                                                                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <node id="ca9f4a047b4c47aa" name="Add to Template" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                                    <input name="data" optional="false">Data to print</input>
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="dataTemplate"><![CDATA[
#set($tableName = "$DATA")
#if($tables.containsKey($tableName))
#set($table = $tables.get($tableName))
#printTableWithIdAndCaption( $table $tableName $caption [] )
#else
$caption

No Results
#end
]]></oga:property>
                                                                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="268" y="203">
                                                                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <link dest="fc87f3a92fe4bdf" destField="buffer" source="de8581e5cfac497f" sourceField="obj"/>
                                                                <link dest="ca9f4a047b4c47aa" destField="buffer" source="de8581e5cfac497f" sourceField="obj"/>
                                                                <extensions>
                                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                                </extensions>
                                                            </graph>
                                                            <ogcn:published_input field="data" name="speaker" ref="fc87f3a92fe4bdf"/>
                                                            <ogcn:published_input field="data" name="bufferName" ref="ca9f4a047b4c47aa"/>
                                                            <ogcn:published_input field="obj" name="reportTemplateName" ref="de8581e5cfac497f"/>
                                                            <extensions>
                                                                <oga:meta x="631" y="320"/>
                                                            </extensions>
                                                        </ogcn:macro>
                                                        <link dest="33ee13c79ef4cc3" destField="table" source="8ecf968b16c24594" sourceField="table"/>
                                                        <link dest="177756b09f2c4e9c" destField="data" source="33ee13c79ef4cc3" sourceField="table"/>
                                                        <link dest="771d9807b4946a1" destField="speaker" source="5c8fc34cf2af4389" sourceField="obj"/>
                                                        <link dest="6083f3b1fec0421a" destField="speaker" source="5c8fc34cf2af4389" sourceField="obj"/>
                                                        <link dest="177756b09f2c4e9c" destField="buffer" source="771d9807b4946a1" sourceField="value"/>
                                                        <link dest="6083f3b1fec0421a" destField="bufferName" source="177756b09f2c4e9c" sourceField="buffer"/>
                                                        <link dest="8ecf968b16c24594" destField="table" source="a12598f7c4e34dcc" sourceField="table"/>
                                                        <link dest="8ecf968b16c24594" destField="total" source="7d0ef2fe71254e04" sourceField="rowCount"/>
                                                        <link dest="a12598f7c4e34dcc" destField="table" source="7d0ef2fe71254e04" sourceField="obj"/>
                                                        <link dest="6083f3b1fec0421a" destField="reportTemplateName" source="dfb1169db3844027" sourceField="obj"/>
                                                        <extensions>
                                                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                        </extensions>
                                                    </graph>
                                                    <ogcn:published_input field="obj" name="speaker" ref="5c8fc34cf2af4389"/>
                                                    <ogcn:published_input field="obj" name="obj" ref="7d0ef2fe71254e04"/>
                                                    <ogcn:published_input field="obj" name="bufferName" ref="dfb1169db3844027"/>
                                                    <ogcn:published_output field="table" name="table" ref="a12598f7c4e34dcc"/>
                                                    <extensions>
                                                        <oga:meta x="564" y="26"/>
                                                    </extensions>
                                                </ogcn:macro>
                                                <ogcn:macro id="458fd744de5a4a6a" name="Structures (by Session)" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                    <graph id="5f2ac2b6">
                                                        <node id="b1a785f5231a4cf2" name="TableDataSource" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.TableDataSource]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="9b93f7a2752f43bd" name="speaker" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="297"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="18fde0bbe23b43f1" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="618"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="d622557e1ee74372" type="class:ca.phon.app.opgraph.nodes.table.InventoryNode">
                                                            <extensions>
                                                                <opqry:inventoryoptions>
                                                                    <opqry:groupBy caseSensitive="false" column="Session" ignoreDiacritics="true"/>
                                                                    <opqry:column caseSensitive="false" column="Structure" ignoreDiacritics="true"/>
                                                                </opqry:inventoryoptions>
                                                                <oga:settings/>
                                                                <oga:meta x="242" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="cc5ba6cc895f4fec" name="Split Table" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                            <output name="keySet" type="java.util.Set">Unique values from given column name</output>
                                                            <output name="tableMap" type="java.util.Map">Map of key -&gt; table values</output>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="columnName"><![CDATA[Session]]></oga:property>
                                                                    <oga:property key="__script"><![CDATA[/*
 * Phon - An open source tool for research in phonology.
 * Copyright (C) 2005 - 2017, Gregory Hedlund <ghedlund@mun.ca> and Yvan Rose <yrose@mun.ca>
 * Dept of Linguistics, Memorial University <https://phon.ca>
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

 /**
  * Split Table.js
  *
  * Script for use with ca.phon.app.opgraph.nodes.table.TableScriptNode
  *
  * Split table based on column name.  Two outputs
  * are produced, a set of keys from the column used in the filter  and a
  * map of key -> table values.
  */

var columnParamInfo = {
	"id": "columnName",
	"title": "Column Name",
	"def": "",
	"prompt": "Enter column name"
}

function setup_params(params) {
	var columnParam = new StringScriptParam(
		columnParamInfo.id,
		columnParamInfo.title,
		columnParamInfo.def);
	columnParam.setPrompt(columnParamInfo.prompt);
	params.add(columnParam);
}

// add custom inputs/outputs here
function init(inputs, outputs) {
	outputs.add("keySet", "Unique values from given column name", false, java.util.Set);
	outputs.add("tableMap", "Map of key -> table values", false, java.util.Map);
}

/*
 * Create a new table with the same schema as the inputTable
 */
function setupTable(inputTable) {
    var table = new DefaultTableDataSource();
    for(c = 0; c < inputTable.columnCount; c++) {
	    var colTitle = inputTable.getColumnTitle(c);
	    table.setColumnTitle(c, colTitle);
	}
	return table;
}

// run operation on table
function tableOp(context, table) {
	// find table column index
	col = table.getColumnIndex(columnName);

	if(col < 0)
		return; // column not found

	var tableMap = new java.util.LinkedHashMap();

	for(row = 0; row < table.rowCount; row++) {
	    // use string value as row key
		var rowKey = Packages.ca.phon.formatter.FormatterUtil.format(table.getValueAt(row, col));

		var keyTable = tableMap.get(rowKey);
		if(keyTable == null) {
		    keyTable = setupTable(table);
		    tableMap.put(rowKey, keyTable);
		}
		keyTable.addRow(table.getRow(row));
	}

	context.put("keySet", tableMap.keySet());
	context.put("tableMap", tableMap);
}
]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="242" y="156"/>
                                                            </extensions>
                                                        </node>
                                                        <ogcn:macro id="ce3a7de449dd4232" name="Setup Buffer Name" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                            <graph id="68c754e2">
                                                                <node id="c61173250dd4a3d" name="StringBuffer#&lt;init&gt;(String)" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>(java.lang.String)]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="15" y="15">
                                                                            <oga:default for="arg1" type="java.lang.String"/>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <node id="d9b6501b1e694091" name="Participant" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="15" y="146"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="d5562c4a97484642" name="StringBuffer#append(String)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[append(java.lang.String)]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="256" y="15"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="d2b59e7842d247e4" name="StringBuffer#toString()" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[toString()]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="507" y="15"/>
                                                                    </extensions>
                                                                </node>
                                                                <link dest="d2b59e7842d247e4" destField="obj" source="d5562c4a97484642" sourceField="value"/>
                                                                <link dest="d5562c4a97484642" destField="obj" source="c61173250dd4a3d" sourceField="value"/>
                                                                <link dest="d5562c4a97484642" destField="arg1" source="d9b6501b1e694091" sourceField="name"/>
                                                                <extensions>
                                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                                </extensions>
                                                            </graph>
                                                            <ogcn:published_input field="obj" name="speaker" ref="d9b6501b1e694091"/>
                                                            <ogcn:published_input field="arg1" name="arg1" ref="c61173250dd4a3d"/>
                                                            <ogcn:published_output field="value" name="value" ref="d2b59e7842d247e4"/>
                                                            <extensions>
                                                                <oga:meta x="241" y="297">
                                                                    <oga:default for="arg1" type="java.lang.String">Vocalization Structure (by Session)_</oga:default>
                                                                </oga:meta>
                                                            </extensions>
                                                        </ogcn:macro>
                                                        <node id="d579bb6fd1f1483a" name="Add Frequency Columns" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                            <input name="tableMap" optional="false"/>
                                                            <output name="freqTable" type="ca.phon.query.report.datasource.DefaultTableDataSource"/>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="__script"><![CDATA[function init(inputs, outputs) {
	inputs.add("tableMap", "", false, false);

	outputs.add("freqTable", "", false, Packages.ca.phon.query.report.datasource.DefaultTableDataSource);
}

function tableOp(context, table) {
	var tableMap = context.get("tableMap");
	var freqTable = new Packages.ca.phon.query.report.datasource.DefaultTableDataSource();

	// setup columns
	freqTable.setColumnTitle(0, table.getColumnTitle(0));

	var colIdx = 1;
	for(var col = 1; col < table.columnCount; col++) {
		freqTable.setColumnTitle(colIdx++, table.getColumnTitle(col));
		freqTable.setColumnTitle(colIdx++, "% " + table.getColumnTitle(col));
	}

	for(var row = 0; row < table.rowCount; row++) {
		var rowData = [];
		var tableData = table.getRow(row);

		rowData[0] = tableData[0];
		colIdx = 1;

		for(var col = 1; col < table.columnCount; col++) {
			var total = tableMap.get(table.getColumnTitle(col)).rowCount;
			var count = tableData[col];
			var freq = (count / total) * 100.0;

			rowData[colIdx++] = new java.lang.Integer(count);
			rowData[colIdx++] = freq;
		}

		freqTable.addRow(rowData);
	}

	context.put("freqTable", freqTable);
}
]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="417" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="c7bf51c1114b4074" type="class:ca.phon.app.opgraph.nodes.table.SortNode">
                                                            <extensions>
                                                                <opqry:sortoptions>
                                                                    <opqry:sortBy column="Structure" order="ascending" type="plain"/>
                                                                </opqry:sortoptions>
                                                                <oga:settings/>
                                                                <oga:meta x="652" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="7237bf01dd524687" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                            <input name="data" optional="false">Data to print</input>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="dataTemplate"><![CDATA[$DATA]]></oga:property>
                                                                    <oga:property key="showText"><![CDATA[false]]></oga:property>
                                                                    <oga:property key="showTable"><![CDATA[true]]></oga:property>
                                                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="827" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <ogcn:macro id="56a985fdb892459c" name="Add to Report Template" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                            <graph id="13fce616">
                                                                <node id="aed66fa0034545e0" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="33" y="148"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="2d6b3fb1015c40b3" name="Set Caption" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                                    <input name="data" optional="false">Data to print</input>
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="dataTemplate"><![CDATA[
#set($caption = "<h4>Vocalization Structure (by Session)</h4>")
]]></oga:property>
                                                                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="233" y="73">
                                                                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <node id="cb868c6669664f33" name="Add to Template" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                                    <input name="data" optional="false">Data to print</input>
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="dataTemplate"><![CDATA[
#set($tableName = "$DATA")
#if($tables.containsKey($tableName))
#set($table = $tables.get($tableName))
#printTableWithIdAndCaption( $table $tableName $caption [] )
#else
$caption

No Results
#end
]]></oga:property>
                                                                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="236" y="202">
                                                                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <link dest="2d6b3fb1015c40b3" destField="buffer" source="aed66fa0034545e0" sourceField="obj"/>
                                                                <link dest="cb868c6669664f33" destField="buffer" source="aed66fa0034545e0" sourceField="obj"/>
                                                                <extensions>
                                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                                </extensions>
                                                            </graph>
                                                            <ogcn:published_input field="data" name="speaker" ref="2d6b3fb1015c40b3"/>
                                                            <ogcn:published_input field="data" name="bufferName" ref="cb868c6669664f33"/>
                                                            <ogcn:published_input field="obj" name="reportTemplateName" ref="aed66fa0034545e0"/>
                                                            <extensions>
                                                                <oga:meta x="1009" y="15"/>
                                                            </extensions>
                                                        </ogcn:macro>
                                                        <link dest="7237bf01dd524687" destField="data" source="c7bf51c1114b4074" sourceField="table"/>
                                                        <link dest="ce3a7de449dd4232" destField="speaker" source="9b93f7a2752f43bd" sourceField="obj"/>
                                                        <link dest="56a985fdb892459c" destField="speaker" source="9b93f7a2752f43bd" sourceField="obj"/>
                                                        <link dest="7237bf01dd524687" destField="buffer" source="ce3a7de449dd4232" sourceField="value"/>
                                                        <link dest="56a985fdb892459c" destField="bufferName" source="7237bf01dd524687" sourceField="buffer"/>
                                                        <link dest="d579bb6fd1f1483a" destField="tableMap" source="cc5ba6cc895f4fec" sourceField="tableMap"/>
                                                        <link dest="d579bb6fd1f1483a" destField="table" source="d622557e1ee74372" sourceField="table"/>
                                                        <link dest="c7bf51c1114b4074" destField="table" source="d579bb6fd1f1483a" sourceField="freqTable"/>
                                                        <link dest="d622557e1ee74372" destField="table" source="b1a785f5231a4cf2" sourceField="obj"/>
                                                        <link dest="cc5ba6cc895f4fec" destField="table" source="b1a785f5231a4cf2" sourceField="obj"/>
                                                        <link dest="56a985fdb892459c" destField="reportTemplateName" source="18fde0bbe23b43f1" sourceField="obj"/>
                                                        <extensions>
                                                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                        </extensions>
                                                    </graph>
                                                    <ogcn:published_input field="obj" name="speaker" ref="9b93f7a2752f43bd"/>
                                                    <ogcn:published_input field="obj" name="obj" ref="b1a785f5231a4cf2"/>
                                                    <ogcn:published_input field="obj" name="bufferName" ref="18fde0bbe23b43f1"/>
                                                    <extensions>
                                                        <oga:meta x="564" y="167"/>
                                                    </extensions>
                                                </ogcn:macro>
                                                <node id="eec3ffcea7204cf7" name="Add to Summary" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="__script"><![CDATA[function init(inputs, outputs) {
	inputs.add("inventory", "");
}

function tableOp(context, table) {
	var inventory = context.get("inventory");

	var rowData = [];
	var colIdx = 0;

	// add % vocalizations with CV or CVC
	var countCV = 0;
	var countCC = 0;
	var total = 0;
	for(var row = 0; row < inventory.rowCount; row++) {
		var pattern = inventory.getValueAt(row, 0);
		var c = inventory.getValueAt(row, 1);

		if(pattern.toString().contains("CV")) {
			countCV += c.intValue();
		}

		if(pattern.toString().contains("CC")) {
			countCC += c.intValue();
		}
		
		total += c.intValue();
	}
	var freqCV = (countCV / total) * 100.0; 
	var freqCC = (countCC / total) * 100.0;
	
	rowData[colIdx++] = "";
	rowData[colIdx++] = "% of vocalizations that include a CV sequence";
	rowData[colIdx++] = new java.lang.Float(freqCV);
	table.addRow(rowData);

	rowData = [];
	colIdx = 0;

	rowData[colIdx++] = "";
	rowData[colIdx++] = "% of vocalizations that include at least one CC sequence";
	rowData[colIdx++] = new java.lang.Float(freqCC);
	table.addRow(rowData);
}
]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="600" y="414"/>
                                                    </extensions>
                                                </node>
                                                <link dest="d6dcaea1e62046f7" destField="speaker" source="d3c301bd634242c2" sourceField="obj"/>
                                                <link dest="458fd744de5a4a6a" destField="speaker" source="d3c301bd634242c2" sourceField="obj"/>
                                                <link dest="b74ab4e5fde149c6" destField="table" source="db2fcf7cec6341e0" sourceField="obj"/>
                                                <link dest="d6dcaea1e62046f7" destField="obj" source="b74ab4e5fde149c6" sourceField="table"/>
                                                <link dest="458fd744de5a4a6a" destField="obj" source="b74ab4e5fde149c6" sourceField="table"/>
                                                <link dest="d6dcaea1e62046f7" destField="bufferName" source="a44025d200db4ad6" sourceField="obj"/>
                                                <link dest="458fd744de5a4a6a" destField="bufferName" source="a44025d200db4ad6" sourceField="obj"/>
                                                <link dest="eec3ffcea7204cf7" destField="inventory" source="d6dcaea1e62046f7" sourceField="table"/>
                                                <link dest="eec3ffcea7204cf7" destField="table" source="85ac255934fb4b3d" sourceField="obj"/>
                                                <extensions>
                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                </extensions>
                                            </graph>
                                            <ogcn:published_input field="obj" name="speaker" ref="d3c301bd634242c2"/>
                                            <ogcn:published_input field="obj" name="table" ref="db2fcf7cec6341e0"/>
                                            <ogcn:published_input field="obj" name="bufferName" ref="a44025d200db4ad6"/>
                                            <ogcn:published_input field="obj" name="summaryTable" ref="85ac255934fb4b3d"/>
                                            <extensions>
                                                <oga:meta x="270" y="342"/>
                                            </extensions>
                                        </ogcn:macro>
                                        <ogcn:macro id="35376622" name="Syllable Structure" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                            <graph id="1f9fc029">
                                                <node id="47c22615" name="table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                                            <oga:property key="contextKey"/>
                                                        </oga:settings>
                                                        <oga:meta x="15" y="15"/>
                                                    </extensions>
                                                </node>
                                                <node id="cf6050cb379e46e4" name="Participant" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="15" y="160"/>
                                                    </extensions>
                                                </node>
                                                <node id="b1d5d41efed14492" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="16" y="479"/>
                                                    </extensions>
                                                </node>
                                                <node id="3dc067559584ced" name="Summary Table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.TableDataSource]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="14" y="585"/>
                                                    </extensions>
                                                </node>
                                                <node id="45faec77" name="Create Syllable Table" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                    <output name="syllTable" type="ca.phon.query.report.datasource.DefaultTableDataSource"/>
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="__script"><![CDATA[importClass(Packages.ca.phon.ipa.IPATranscriptBuilder)

function init(inputs, outputs) {
	outputs.add("syllTable", "", false, Packages.ca.phon.query.report.datasource.DefaultTableDataSource);
}


var symbolMap = "H={glottal}; G=\\g; C=\\c; V=\\v";

function tableOp(context, table) {
	var syllTable = new Packages.ca.phon.query.report.datasource.DefaultTableDataSource();

	// setup columns
	syllTable.setColumnTitle(0, "Session");
	syllTable.setColumnTitle(1, "Record");
	syllTable.setColumnTitle(2, "Syllable");
	syllTable.setColumnTitle(3, "Structure");

	for(var row = 0; row < table.rowCount; row++) {
		var tableData = table.getRow(row);

		var ipa = (new IPATranscriptBuilder()).append(table.getValueAt(row, "Actual Syllabification (Word)")).toIPATranscript();
		var sylls = ipa.syllables();


		for(var syllIdx = 0; syllIdx < sylls.size(); syllIdx++) {
			var syll = sylls.get(syllIdx);

			var rowData = [];
			rowData[0] = table.getValueAt(row, 0);
			rowData[1] = table.getValueAt(row, "Record #");
			rowData[2] = syll;
			rowData[3] = syll.cover(symbolMap);
			syllTable.addRow(rowData);
		}
	}

	context.put("syllTable", syllTable);
}
]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="275" y="21"/>
                                                    </extensions>
                                                </node>
                                                <ogcn:macro id="3c1623ed" name="Syllable Strucutre (Total)" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                    <graph id="4632b987">
                                                        <node id="77c929c0" name="obj" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="1f50f0d1" name="speaker" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="16" y="172"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="a489ad0325df499c" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="18" y="498"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="197b49e3" type="class:ca.phon.app.opgraph.nodes.table.InventoryNode">
                                                            <extensions>
                                                                <opqry:inventoryoptions>
                                                                    <opqry:column caseSensitive="false" column="Structure" ignoreDiacritics="true"/>
                                                                </opqry:inventoryoptions>
                                                                <oga:settings/>
                                                                <oga:meta x="241" y="24"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="1a8e8504" name="DefaultTableDataSource" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="244" y="151"/>
                                                            </extensions>
                                                        </node>
                                                        <ogcn:macro id="22295b99a85b41d8" name="Setup Buffer Name" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                            <graph id="24b83d07">
                                                                <node id="a42d55557e4145d9" name="StringBuffer#&lt;init&gt;(String)" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>(java.lang.String)]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="15" y="15">
                                                                            <oga:default for="arg1" type="java.lang.String"/>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <node id="4cda613c85bf4515" name="Participant" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="15" y="146"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="fd5d7ffcb2f24ee9" name="StringBuffer#append(String)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[append(java.lang.String)]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="256" y="15"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="c2912363c64643ec" name="StringBuffer#toString()" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[toString()]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="507" y="15"/>
                                                                    </extensions>
                                                                </node>
                                                                <link dest="c2912363c64643ec" destField="obj" source="fd5d7ffcb2f24ee9" sourceField="value"/>
                                                                <link dest="fd5d7ffcb2f24ee9" destField="obj" source="a42d55557e4145d9" sourceField="value"/>
                                                                <link dest="fd5d7ffcb2f24ee9" destField="arg1" source="4cda613c85bf4515" sourceField="name"/>
                                                                <extensions>
                                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                                </extensions>
                                                            </graph>
                                                            <ogcn:published_input field="obj" name="speaker" ref="4cda613c85bf4515"/>
                                                            <ogcn:published_input field="arg1" name="arg1" ref="a42d55557e4145d9"/>
                                                            <ogcn:published_output field="value" name="value" ref="c2912363c64643ec"/>
                                                            <extensions>
                                                                <oga:meta x="651" y="151">
                                                                    <oga:default for="arg1" type="java.lang.String">Syllable Structure_</oga:default>
                                                                </oga:meta>
                                                            </extensions>
                                                        </ogcn:macro>
                                                        <node id="a8e35bac8bd74fce" name="Add Frequency Column" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                            <input name="total" optional="false"/>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="__script"><![CDATA[function init(inputs, outputs) {
	inputs.add("total", "", false, false);
}

function tableOp(context, table) {
	var total = context.get("total");
	var colIdx = table.columnCount;
	table.setColumnTitle(colIdx, "%");

	for(var row = 0; row < table.rowCount; row++) {
		var rowData = table.getRow(row);
		var count = rowData[1];
		var freq = (count / total) * 100.0;

		rowData[2] = freq;
	}
}
]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="417" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="784b6f83" type="class:ca.phon.app.opgraph.nodes.table.SortNode">
                                                            <extensions>
                                                                <opqry:sortoptions>
                                                                    <opqry:sortBy column="Structure" order="ascending" type="plain"/>
                                                                </opqry:sortoptions>
                                                                <oga:settings/>
                                                                <oga:meta x="652" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="11874384" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                            <input name="data" optional="false">Data to print</input>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="dataTemplate"><![CDATA[$DATA]]></oga:property>
                                                                    <oga:property key="showText"><![CDATA[false]]></oga:property>
                                                                    <oga:property key="showTable"><![CDATA[true]]></oga:property>
                                                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="827" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <ogcn:macro id="7808a1862cb14e24" name="Add to Report Template" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                            <graph id="167011db">
                                                                <node id="e94fc103277348c4" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="12" y="175"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="e78ab7126a704199" name="Set Caption" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                                    <input name="data" optional="false">Data to print</input>
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="dataTemplate"><![CDATA[
#set($caption = "<h4>Syllable Structure</h4>")
]]></oga:property>
                                                                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="201" y="94">
                                                                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <node id="f9e6b51722254bc9" name="Add to Template" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                                    <input name="data" optional="false">Data to print</input>
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="dataTemplate"><![CDATA[
#set($tableName = "$DATA")
#if($tables.containsKey($tableName))
#set($table = $tables.get($tableName))
#printTableWithIdAndCaption( $table $tableName $caption [] )
#else
$caption

No Results
#end
]]></oga:property>
                                                                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="203" y="223">
                                                                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <link dest="e78ab7126a704199" destField="buffer" source="e94fc103277348c4" sourceField="obj"/>
                                                                <link dest="f9e6b51722254bc9" destField="buffer" source="e94fc103277348c4" sourceField="obj"/>
                                                                <extensions>
                                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                                </extensions>
                                                            </graph>
                                                            <ogcn:published_input field="data" name="speaker" ref="e78ab7126a704199"/>
                                                            <ogcn:published_input field="data" name="bufferName" ref="f9e6b51722254bc9"/>
                                                            <ogcn:published_input field="obj" name="reportTemplateName" ref="e94fc103277348c4"/>
                                                            <extensions>
                                                                <oga:meta x="1018" y="15"/>
                                                            </extensions>
                                                        </ogcn:macro>
                                                        <link dest="784b6f83" destField="table" source="a8e35bac8bd74fce" sourceField="table"/>
                                                        <link dest="11874384" destField="data" source="784b6f83" sourceField="table"/>
                                                        <link dest="22295b99a85b41d8" destField="speaker" source="1f50f0d1" sourceField="obj"/>
                                                        <link dest="7808a1862cb14e24" destField="speaker" source="1f50f0d1" sourceField="obj"/>
                                                        <link dest="a8e35bac8bd74fce" destField="total" source="1a8e8504" sourceField="rowCount"/>
                                                        <link dest="1a8e8504" destField="obj" source="77c929c0" sourceField="obj"/>
                                                        <link dest="11874384" destField="buffer" source="22295b99a85b41d8" sourceField="value"/>
                                                        <link dest="7808a1862cb14e24" destField="bufferName" source="11874384" sourceField="buffer"/>
                                                        <link dest="a8e35bac8bd74fce" destField="table" source="197b49e3" sourceField="table"/>
                                                        <link dest="197b49e3" destField="table" source="77c929c0" sourceField="obj"/>
                                                        <link dest="7808a1862cb14e24" destField="reportTemplateName" source="a489ad0325df499c" sourceField="obj"/>
                                                        <extensions>
                                                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                        </extensions>
                                                    </graph>
                                                    <ogcn:published_input field="obj" name="speaker" ref="1f50f0d1"/>
                                                    <ogcn:published_input field="obj" name="obj" ref="77c929c0"/>
                                                    <ogcn:published_input field="obj" name="bufferName" ref="a489ad0325df499c"/>
                                                    <ogcn:published_output field="table" name="table" ref="197b49e3"/>
                                                    <extensions>
                                                        <oga:meta x="557" y="29"/>
                                                    </extensions>
                                                </ogcn:macro>
                                                <ogcn:macro id="304f07bd533d4538" name="Syllable Strucutre (by Session)" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                    <graph id="7e619ec1">
                                                        <node id="4c22960fe18b4e7c" name="table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="34a75653eea64d15" name="speaker" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="390"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="85c509f79a8443d6" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="21" y="723"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="9b7b38075b0b44fc" type="class:ca.phon.app.opgraph.nodes.table.InventoryNode">
                                                            <extensions>
                                                                <opqry:inventoryoptions>
                                                                    <opqry:groupBy caseSensitive="false" column="Session" ignoreDiacritics="true"/>
                                                                    <opqry:column caseSensitive="false" column="Structure" ignoreDiacritics="true"/>
                                                                </opqry:inventoryoptions>
                                                                <oga:settings/>
                                                                <oga:meta x="204" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="7c90b8bc" name="Split Table" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                            <output name="keySet" type="java.util.Set">Unique values from given column name</output>
                                                            <output name="tableMap" type="java.util.Map">Map of key -&gt; table values</output>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="columnName"><![CDATA[Session]]></oga:property>
                                                                    <oga:property key="__script"><![CDATA[/*
 * Phon - An open source tool for research in phonology.
 * Copyright (C) 2005 - 2017, Gregory Hedlund <ghedlund@mun.ca> and Yvan Rose <yrose@mun.ca>
 * Dept of Linguistics, Memorial University <https://phon.ca>
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

 /**
  * Split Table.js
  *
  * Script for use with ca.phon.app.opgraph.nodes.table.TableScriptNode
  *
  * Split table based on column name.  Two outputs
  * are produced, a set of keys from the column used in the filter  and a
  * map of key -> table values.
  */

var columnParamInfo = {
	"id": "columnName",
	"title": "Column Name",
	"def": "",
	"prompt": "Enter column name"
}

function setup_params(params) {
	var columnParam = new StringScriptParam(
		columnParamInfo.id,
		columnParamInfo.title,
		columnParamInfo.def);
	columnParam.setPrompt(columnParamInfo.prompt);
	params.add(columnParam);
}

// add custom inputs/outputs here
function init(inputs, outputs) {
	outputs.add("keySet", "Unique values from given column name", false, java.util.Set);
	outputs.add("tableMap", "Map of key -> table values", false, java.util.Map);
}

/*
 * Create a new table with the same schema as the inputTable
 */
function setupTable(inputTable) {
    var table = new DefaultTableDataSource();
    for(c = 0; c < inputTable.columnCount; c++) {
	    var colTitle = inputTable.getColumnTitle(c);
	    table.setColumnTitle(c, colTitle);
	}
	return table;
}

// run operation on table
function tableOp(context, table) {
	// find table column index
	col = table.getColumnIndex(columnName);

	if(col < 0)
		return; // column not found

	var tableMap = new java.util.LinkedHashMap();

	for(row = 0; row < table.rowCount; row++) {
	    // use string value as row key
		var rowKey = Packages.ca.phon.formatter.FormatterUtil.format(table.getValueAt(row, col));

		var keyTable = tableMap.get(rowKey);
		if(keyTable == null) {
		    keyTable = setupTable(table);
		    tableMap.put(rowKey, keyTable);
		}
		keyTable.addRow(table.getRow(row));
	}

	context.put("keySet", tableMap.keySet());
	context.put("tableMap", tableMap);
}
]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="148" y="168"/>
                                                            </extensions>
                                                        </node>
                                                        <ogcn:macro id="a2012897bda44f8" name="Setup Buffer Name" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                            <graph id="73e87531">
                                                                <node id="e0004fc6644d405e" name="StringBuffer#&lt;init&gt;(String)" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>(java.lang.String)]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="15" y="15">
                                                                            <oga:default for="arg1" type="java.lang.String"/>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <node id="15291fa43e874202" name="Participant" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="15" y="146"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="d95498c8bf064f1e" name="StringBuffer#append(String)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[append(java.lang.String)]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="256" y="15"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="3c933f56c09043ef" name="StringBuffer#toString()" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[toString()]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="507" y="15"/>
                                                                    </extensions>
                                                                </node>
                                                                <link dest="3c933f56c09043ef" destField="obj" source="d95498c8bf064f1e" sourceField="value"/>
                                                                <link dest="d95498c8bf064f1e" destField="obj" source="e0004fc6644d405e" sourceField="value"/>
                                                                <link dest="d95498c8bf064f1e" destField="arg1" source="15291fa43e874202" sourceField="name"/>
                                                                <extensions>
                                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                                </extensions>
                                                            </graph>
                                                            <ogcn:published_input field="obj" name="speaker" ref="15291fa43e874202"/>
                                                            <ogcn:published_input field="arg1" name="arg1" ref="e0004fc6644d405e"/>
                                                            <ogcn:published_output field="value" name="value" ref="3c933f56c09043ef"/>
                                                            <extensions>
                                                                <oga:meta x="205" y="390">
                                                                    <oga:default for="arg1" type="java.lang.String">Syllable Structure (by Session)_</oga:default>
                                                                </oga:meta>
                                                            </extensions>
                                                        </ogcn:macro>
                                                        <node id="c37e4ce7fc204887" name="Add Frequency Columns" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                            <input name="tableMap" optional="false"/>
                                                            <output name="freqTable" type="ca.phon.query.report.datasource.DefaultTableDataSource"/>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="__script"><![CDATA[function init(inputs, outputs) {
	inputs.add("tableMap", "", false, false);

	outputs.add("freqTable", "", false, Packages.ca.phon.query.report.datasource.DefaultTableDataSource);
}

function tableOp(context, table) {
	var tableMap = context.get("tableMap");
	var freqTable = new Packages.ca.phon.query.report.datasource.DefaultTableDataSource();

	// setup columns
	freqTable.setColumnTitle(0, table.getColumnTitle(0));

	var colIdx = 1;
	for(var col = 1; col < table.columnCount; col++) {
		freqTable.setColumnTitle(colIdx++, table.getColumnTitle(col));
		freqTable.setColumnTitle(colIdx++, "% " + table.getColumnTitle(col));
	}

	for(var row = 0; row < table.rowCount; row++) {
		var rowData = [];
		var tableData = table.getRow(row);

		rowData[0] = tableData[0];
		colIdx = 1;

		for(var col = 1; col < table.columnCount; col++) {
			var total = tableMap.get(table.getColumnTitle(col)).rowCount;
			var count = tableData[col];
			var freq = (count / total) * 100.0;

			rowData[colIdx++] = new java.lang.Integer(count);
			rowData[colIdx++] = freq;
		}

		freqTable.addRow(rowData);
	}

	context.put("freqTable", freqTable);
}
]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="357" y="36"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="9df2519ebf114209" type="class:ca.phon.app.opgraph.nodes.table.SortNode">
                                                            <extensions>
                                                                <opqry:sortoptions>
                                                                    <opqry:sortBy column="Structure" order="ascending" type="plain"/>
                                                                </opqry:sortoptions>
                                                                <oga:settings/>
                                                                <oga:meta x="558" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="46e57ad97cd24932" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                            <input name="data" optional="false">Data to print</input>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="dataTemplate"><![CDATA[$DATA]]></oga:property>
                                                                    <oga:property key="showText"><![CDATA[false]]></oga:property>
                                                                    <oga:property key="showTable"><![CDATA[true]]></oga:property>
                                                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="711" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <ogcn:macro id="361d5011baab480f" name="Add to Report Template" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                            <graph id="2646664f">
                                                                <node id="6e4500559f34cb1" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="26" y="202"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="4c45fbec63184847" name="Set Caption" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                                    <input name="data" optional="false">Data to print</input>
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="dataTemplate"><![CDATA[
#set($caption = "<h4>Syllable Structure (by Session)</h4>")
]]></oga:property>
                                                                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="220" y="122">
                                                                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <node id="7bb1cf0a3fe54122" name="Add to Template" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                                    <input name="data" optional="false">Data to print</input>
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="dataTemplate"><![CDATA[
#set($tableName = "$DATA")
#if($tables.containsKey($tableName))
#set($table = $tables.get($tableName))
#printTableWithIdAndCaption( $table $tableName $caption [] )
#else
$caption

No Results
#end
]]></oga:property>
                                                                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="223" y="252">
                                                                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <link dest="4c45fbec63184847" destField="buffer" source="6e4500559f34cb1" sourceField="obj"/>
                                                                <link dest="7bb1cf0a3fe54122" destField="buffer" source="6e4500559f34cb1" sourceField="obj"/>
                                                                <extensions>
                                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                                </extensions>
                                                            </graph>
                                                            <ogcn:published_input field="data" name="speaker" ref="4c45fbec63184847"/>
                                                            <ogcn:published_input field="data" name="bufferName" ref="7bb1cf0a3fe54122"/>
                                                            <ogcn:published_input field="obj" name="reportTemplateName" ref="6e4500559f34cb1"/>
                                                            <extensions>
                                                                <oga:meta x="791" y="203"/>
                                                            </extensions>
                                                        </ogcn:macro>
                                                        <link dest="46e57ad97cd24932" destField="data" source="9df2519ebf114209" sourceField="table"/>
                                                        <link dest="a2012897bda44f8" destField="speaker" source="34a75653eea64d15" sourceField="obj"/>
                                                        <link dest="361d5011baab480f" destField="speaker" source="34a75653eea64d15" sourceField="obj"/>
                                                        <link dest="46e57ad97cd24932" destField="buffer" source="a2012897bda44f8" sourceField="value"/>
                                                        <link dest="361d5011baab480f" destField="bufferName" source="46e57ad97cd24932" sourceField="buffer"/>
                                                        <link dest="9b7b38075b0b44fc" destField="table" source="4c22960fe18b4e7c" sourceField="obj"/>
                                                        <link dest="7c90b8bc" destField="table" source="4c22960fe18b4e7c" sourceField="obj"/>
                                                        <link dest="c37e4ce7fc204887" destField="tableMap" source="7c90b8bc" sourceField="tableMap"/>
                                                        <link dest="c37e4ce7fc204887" destField="table" source="9b7b38075b0b44fc" sourceField="table"/>
                                                        <link dest="9df2519ebf114209" destField="table" source="c37e4ce7fc204887" sourceField="freqTable"/>
                                                        <link dest="361d5011baab480f" destField="reportTemplateName" source="85c509f79a8443d6" sourceField="obj"/>
                                                        <extensions>
                                                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                        </extensions>
                                                    </graph>
                                                    <ogcn:published_input field="obj" name="speaker" ref="34a75653eea64d15"/>
                                                    <ogcn:published_input field="obj" name="obj" ref="4c22960fe18b4e7c"/>
                                                    <ogcn:published_input field="obj" name="bufferName" ref="85c509f79a8443d6"/>
                                                    <extensions>
                                                        <oga:meta x="555" y="184"/>
                                                    </extensions>
                                                </ogcn:macro>
                                                <node id="480e7fca23084a07" name="Add to Summary" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="__script"><![CDATA[function init(inputs, outputs) {
	inputs.add("inventory", "");
	inputs.add("numVocs", "");
}

function tableOp(context, table) {
	var inventory = context.get("inventory");
	var numVocs = context.get("numVocs");



	// add % vocalizations with CV or CVC
	var countCV = 0;
	var countFinalC = 0;
	var total = 0;
	for(var row = 0; row < inventory.rowCount; row++) {
		var pattern = inventory.getValueAt(row, 0);
		var c = inventory.getValueAt(row, 1);

		if(pattern.toString().contains("CV")) {
			countCV += c.intValue();
		}

		if(pattern.toString().endsWith("C")) {
			countFinalC += c.intValue();
		}
		
		total += c.intValue();
	}
	var freqCV = (countCV / total) * 100.0; 
	var freqFinalC = (countFinalC / total) * 100.0;

	var syllsPerVoc = total / numVocs;

	var rowData = [];
	var colIdx = 0;
	rowData[colIdx++] = "";
	rowData[colIdx++] = "# of syllables / vocalization";
	rowData[colIdx++] = new java.lang.Float(syllsPerVoc);
	table.addRow(rowData);
	
	rowData = [];
	colIdx = 0;
	rowData[colIdx++] = "";
	rowData[colIdx++] = "% of syllables that include a CV sequence";
	rowData[colIdx++] = new java.lang.Float(freqCV);
	table.addRow(rowData);

	rowData = [];
	colIdx = 0;

	rowData[colIdx++] = "";
	rowData[colIdx++] = "% of syllables that end with a C";
	rowData[colIdx++] = new java.lang.Float(freqFinalC);
	table.addRow(rowData);
}
]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="490" y="415"/>
                                                    </extensions>
                                                </node>
                                                <link dest="45faec77" destField="table" source="47c22615" sourceField="obj"/>
                                                <link dest="3c1623ed" destField="obj" source="45faec77" sourceField="syllTable"/>
                                                <link dest="3c1623ed" destField="speaker" source="cf6050cb379e46e4" sourceField="obj"/>
                                                <link dest="304f07bd533d4538" destField="obj" source="45faec77" sourceField="syllTable"/>
                                                <link dest="304f07bd533d4538" destField="speaker" source="cf6050cb379e46e4" sourceField="obj"/>
                                                <link dest="3c1623ed" destField="bufferName" source="b1d5d41efed14492" sourceField="obj"/>
                                                <link dest="304f07bd533d4538" destField="bufferName" source="b1d5d41efed14492" sourceField="obj"/>
                                                <link dest="480e7fca23084a07" destField="inventory" source="3c1623ed" sourceField="table"/>
                                                <link dest="480e7fca23084a07" destField="table" source="3dc067559584ced" sourceField="obj"/>
                                                <link dest="480e7fca23084a07" destField="numVocs" source="47c22615" sourceField="rowCount"/>
                                                <extensions>
                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                </extensions>
                                            </graph>
                                            <ogcn:published_input field="obj" name="table" ref="47c22615"/>
                                            <ogcn:published_input field="obj" name="obj" ref="cf6050cb379e46e4"/>
                                            <ogcn:published_input field="obj" name="bufferName" ref="b1d5d41efed14492"/>
                                            <ogcn:published_input field="obj" name="summaryTable" ref="3dc067559584ced"/>
                                            <extensions>
                                                <oga:meta x="476" y="342"/>
                                            </extensions>
                                        </ogcn:macro>
                                        <ogcn:macro id="c3a5d71d15704c6f" name="Mean Babble Level" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                            <graph id="4e5d0081">
                                                <node id="f2b0e896f7884dea" name="table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.DefaultTableDataSource]]></oga:property>
                                                            <oga:property key="contextKey"/>
                                                        </oga:settings>
                                                        <oga:meta x="17" y="25"/>
                                                    </extensions>
                                                </node>
                                                <node id="b9a7aaa10d754522" name="Participant" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="17" y="170"/>
                                                    </extensions>
                                                </node>
                                                <node id="49fd186c67364a32" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                            <oga:property key="contextKey"/>
                                                        </oga:settings>
                                                        <oga:meta x="17" y="490"/>
                                                    </extensions>
                                                </node>
                                                <node id="748fd15f9a984590" name="Summary Table" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.TableDataSource]]></oga:property>
                                                            <oga:property key="contextKey"/>
                                                        </oga:settings>
                                                        <oga:meta x="17" y="596"/>
                                                    </extensions>
                                                </node>
                                                <node id="117b1f6cbc42428c" name="Add Mean Babble Level" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="__script"><![CDATA[importClass(Packages.ca.phon.ipa.IPATranscriptBuilder)

var placeFeatures = [
	"{labial, -dental}",
	"{labial, dental}",
	"{dental}",
	"{alveolar}",
	"{alveopalatal}",
	"{lateral}",
	"{retroflex}",
	"{palatal}",
	"{velar}",
	"{uvular}",
	"{pharyngeal}",
	"{laryngeal}"
];

var mannerFeatures = [
	"{stop, -nasal}",
	"{fricative}",
	"{affricate}",
	"{nasal}",
	"{liquid, lateral}",
	"{rhotic}",
	"{glide}",
	"{vowel}"
];

function init(inputs, outputs) {
}

function getFeatures(featureArray, ele) {
	var retVal = "\u2205";

	for(var i = 0; i < featureArray.length; i++) {
		var features = featureArray[i];
		var transcript = (new IPATranscriptBuilder()).append(ele).toIPATranscript();
		if(transcript.matches(features)) {
			retVal = features;
			break;
		}
	}

	return retVal;
}

// return a set of consonant types {place+manner}
function getConsonantTypes(ipa) {
	var retVal = new java.util.HashSet();
	var phonex = "[^\\v{glide}{glottal}]";
	var phones = ipa.removePunctuation();

	var phonexPattern = Packages.ca.phon.phonex.PhonexPattern.compile(phonex);
	var matcher = phonexPattern.matcher(phones);

	while(matcher.find()) {
		var match = (new IPATranscriptBuilder()).append(matcher.group()).toIPATranscript();

		if(match.length() > 0) {
			var ele = match.elementAt(0);

			var pf = getFeatures(placeFeatures, ele);
			var mf = getFeatures(mannerFeatures, ele);

			var type = pf + " + " + mf;
			retVal.add(type);
		}
	}

	return retVal;
}

function getMeanBabbleLevel(ipa) {
	var consonantTypes = getConsonantTypes(ipa);

	if(consonantTypes.size() == 0) {
		return 1;
	} else if(consonantTypes.size() == 1) {
		return 2;
	} else {
		return 3;
	}
}

function tableOp(context, table) {
	var colIdx = table.columnCount;
	table.setColumnTitle(colIdx, "Mean Babble Level");

	for(var row = 0; row < table.rowCount; row++) {
		var tableData = table.getRow(row);

		var actualSyllabification = table.getValueAt(row, "Actual Syllabification (Word)");
		var ipa = (new IPATranscriptBuilder()).append(actualSyllabification).toIPATranscript();

		tableData[colIdx] = getMeanBabbleLevel(ipa);
	}
}
]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="275" y="25"/>
                                                    </extensions>
                                                </node>
                                                <ogcn:macro id="e59f22e93c0416a" name="Mean Babble Level (Total)" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                    <graph id="550107c9">
                                                        <node id="536cd64980e047a7" name="TableDataSource" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.TableDataSource]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="262b6ee690c24433" name="speaker" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="156"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="77ddcd71ce6e4e54" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                    <oga:property key="contextKey"/>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="477"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="9c4f740ed27b4b8d" type="class:ca.phon.app.opgraph.nodes.table.InventoryNode">
                                                            <extensions>
                                                                <opqry:inventoryoptions>
                                                                    <opqry:column caseSensitive="false" column="Mean Babble Level" ignoreDiacritics="true"/>
                                                                </opqry:inventoryoptions>
                                                                <oga:settings/>
                                                                <oga:meta x="242" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <ogcn:macro id="2556c0ad40cf4438" name="Setup Buffer Name" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                            <graph id="27fbede8">
                                                                <node id="3856b9f26f9c415d" name="StringBuffer#&lt;init&gt;(String)" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>(java.lang.String)]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="15" y="15">
                                                                            <oga:default for="arg1" type="java.lang.String"/>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <node id="19e09741c5154cc3" name="Participant" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="15" y="146"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="854df8b4a9ba47b4" name="StringBuffer#append(String)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[append(java.lang.String)]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="256" y="15"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="efa7d06fc2d741c5" name="StringBuffer#toString()" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[toString()]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="507" y="15"/>
                                                                    </extensions>
                                                                </node>
                                                                <link dest="efa7d06fc2d741c5" destField="obj" source="854df8b4a9ba47b4" sourceField="value"/>
                                                                <link dest="854df8b4a9ba47b4" destField="obj" source="3856b9f26f9c415d" sourceField="value"/>
                                                                <link dest="854df8b4a9ba47b4" destField="arg1" source="19e09741c5154cc3" sourceField="name"/>
                                                                <extensions>
                                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                                </extensions>
                                                            </graph>
                                                            <ogcn:published_input field="obj" name="speaker" ref="19e09741c5154cc3"/>
                                                            <ogcn:published_input field="arg1" name="arg1" ref="3856b9f26f9c415d"/>
                                                            <ogcn:published_output field="value" name="value" ref="efa7d06fc2d741c5"/>
                                                            <extensions>
                                                                <oga:meta x="241" y="156">
                                                                    <oga:default for="arg1" type="java.lang.String">Mean Babble Level_</oga:default>
                                                                </oga:meta>
                                                            </extensions>
                                                        </ogcn:macro>
                                                        <node id="f3b305518e5b4ac6" name="Add Frequency Column" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                            <input name="total" optional="false"/>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="__script"><![CDATA[function init(inputs, outputs) {
	inputs.add("total", "", false, false);
}

function tableOp(context, table) {
	var total = context.get("total");
	var colIdx = table.columnCount;
	table.setColumnTitle(colIdx, "%");

	for(var row = 0; row < table.rowCount; row++) {
		var rowData = table.getRow(row);
		var count = rowData[1];
		var freq = (count / total) * 100.0;

		rowData[2] = freq;
	}
}
]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="417" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="2ab4cd6392f7428b" type="class:ca.phon.app.opgraph.nodes.table.SortNode">
                                                            <extensions>
                                                                <opqry:sortoptions>
                                                                    <opqry:sortBy column="Mean Babble Level" order="ascending" type="plain"/>
                                                                </opqry:sortoptions>
                                                                <oga:settings/>
                                                                <oga:meta x="652" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="582067365e304b7d" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                            <input name="data" optional="false">Data to print</input>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="dataTemplate"><![CDATA[$DATA]]></oga:property>
                                                                    <oga:property key="showText"><![CDATA[false]]></oga:property>
                                                                    <oga:property key="showTable"><![CDATA[true]]></oga:property>
                                                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="827" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <ogcn:macro id="315090dcaacc4332" name="Add to Report Template" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                            <graph id="1eecfe6c">
                                                                <node id="b571fe4578a643de" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                            <oga:property key="contextKey"/>
                                                                        </oga:settings>
                                                                        <oga:meta x="18" y="112"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="75a7bebd3699496b" name="Set Caption" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                                    <input name="data" optional="false">Data to print</input>
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="dataTemplate"><![CDATA[
#set($caption = "<h4>Mean Babble Level</h4>")
]]></oga:property>
                                                                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="216" y="65">
                                                                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <node id="9fe3420948a44d16" name="Add to Template" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                                    <input name="data" optional="false">Data to print</input>
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="dataTemplate"><![CDATA[
#set($tableName = "$DATA")
#if($tables.containsKey($tableName))
#set($table = $tables.get($tableName))
#printTableWithIdAndCaption( $table $tableName $caption [] )
#else
$caption

No Results
#end
]]></oga:property>
                                                                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="219" y="194">
                                                                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <link dest="75a7bebd3699496b" destField="buffer" source="b571fe4578a643de" sourceField="obj"/>
                                                                <link dest="9fe3420948a44d16" destField="buffer" source="b571fe4578a643de" sourceField="obj"/>
                                                                <extensions>
                                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                                </extensions>
                                                            </graph>
                                                            <ogcn:published_input field="data" name="speaker" ref="75a7bebd3699496b"/>
                                                            <ogcn:published_input field="data" name="bufferName" ref="9fe3420948a44d16"/>
                                                            <ogcn:published_input field="obj" name="reportTemplateName" ref="b571fe4578a643de"/>
                                                            <extensions>
                                                                <oga:meta x="1009" y="15"/>
                                                            </extensions>
                                                        </ogcn:macro>
                                                        <link dest="2ab4cd6392f7428b" destField="table" source="f3b305518e5b4ac6" sourceField="table"/>
                                                        <link dest="582067365e304b7d" destField="data" source="2ab4cd6392f7428b" sourceField="table"/>
                                                        <link dest="2556c0ad40cf4438" destField="speaker" source="262b6ee690c24433" sourceField="obj"/>
                                                        <link dest="315090dcaacc4332" destField="speaker" source="262b6ee690c24433" sourceField="obj"/>
                                                        <link dest="582067365e304b7d" destField="buffer" source="2556c0ad40cf4438" sourceField="value"/>
                                                        <link dest="315090dcaacc4332" destField="bufferName" source="582067365e304b7d" sourceField="buffer"/>
                                                        <link dest="f3b305518e5b4ac6" destField="table" source="9c4f740ed27b4b8d" sourceField="table"/>
                                                        <link dest="f3b305518e5b4ac6" destField="total" source="536cd64980e047a7" sourceField="rowCount"/>
                                                        <link dest="9c4f740ed27b4b8d" destField="table" source="536cd64980e047a7" sourceField="obj"/>
                                                        <link dest="315090dcaacc4332" destField="reportTemplateName" source="77ddcd71ce6e4e54" sourceField="obj"/>
                                                        <extensions>
                                                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                        </extensions>
                                                    </graph>
                                                    <ogcn:published_input field="obj" name="speaker" ref="262b6ee690c24433"/>
                                                    <ogcn:published_input field="obj" name="obj" ref="536cd64980e047a7"/>
                                                    <ogcn:published_input field="obj" name="bufferName" ref="77ddcd71ce6e4e54"/>
                                                    <ogcn:published_output field="table" name="table" ref="9c4f740ed27b4b8d"/>
                                                    <extensions>
                                                        <oga:meta x="540" y="25"/>
                                                    </extensions>
                                                </ogcn:macro>
                                                <ogcn:macro id="455c63934e7b460c" name="Mean Babble Level (by Session)" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                    <graph id="71d37d8e">
                                                        <node id="c5954c4c2e8242f3" name="TableDataSource" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.TableDataSource]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="e5d4044eae2b4148" name="speaker" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="297"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="e575f4590fe1478d" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                    <oga:property key="contextKey"/>
                                                                </oga:settings>
                                                                <oga:meta x="15" y="618"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="26d8074f11a4469e" type="class:ca.phon.app.opgraph.nodes.table.InventoryNode">
                                                            <extensions>
                                                                <opqry:inventoryoptions>
                                                                    <opqry:groupBy caseSensitive="false" column="Session" ignoreDiacritics="true"/>
                                                                    <opqry:column caseSensitive="false" column="Mean Babble Level" ignoreDiacritics="true"/>
                                                                </opqry:inventoryoptions>
                                                                <oga:settings/>
                                                                <oga:meta x="242" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="8bf24634c804fef" name="Split Table" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                            <output name="keySet" type="java.util.Set">Unique values from given column name</output>
                                                            <output name="tableMap" type="java.util.Map">Map of key -&gt; table values</output>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="columnName"><![CDATA[Session]]></oga:property>
                                                                    <oga:property key="__script"><![CDATA[/*
 * Phon - An open source tool for research in phonology.
 * Copyright (C) 2005 - 2017, Gregory Hedlund <ghedlund@mun.ca> and Yvan Rose <yrose@mun.ca>
 * Dept of Linguistics, Memorial University <https://phon.ca>
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

 /**
  * Split Table.js
  *
  * Script for use with ca.phon.app.opgraph.nodes.table.TableScriptNode
  *
  * Split table based on column name.  Two outputs
  * are produced, a set of keys from the column used in the filter  and a
  * map of key -> table values.
  */

var columnParamInfo = {
	"id": "columnName",
	"title": "Column Name",
	"def": "",
	"prompt": "Enter column name"
}

function setup_params(params) {
	var columnParam = new StringScriptParam(
		columnParamInfo.id,
		columnParamInfo.title,
		columnParamInfo.def);
	columnParam.setPrompt(columnParamInfo.prompt);
	params.add(columnParam);
}

// add custom inputs/outputs here
function init(inputs, outputs) {
	outputs.add("keySet", "Unique values from given column name", false, java.util.Set);
	outputs.add("tableMap", "Map of key -> table values", false, java.util.Map);
}

/*
 * Create a new table with the same schema as the inputTable
 */
function setupTable(inputTable) {
    var table = new DefaultTableDataSource();
    for(c = 0; c < inputTable.columnCount; c++) {
	    var colTitle = inputTable.getColumnTitle(c);
	    table.setColumnTitle(c, colTitle);
	}
	return table;
}

// run operation on table
function tableOp(context, table) {
	// find table column index
	col = table.getColumnIndex(columnName);

	if(col < 0)
		return; // column not found

	var tableMap = new java.util.LinkedHashMap();

	for(row = 0; row < table.rowCount; row++) {
	    // use string value as row key
		var rowKey = Packages.ca.phon.formatter.FormatterUtil.format(table.getValueAt(row, col));

		var keyTable = tableMap.get(rowKey);
		if(keyTable == null) {
		    keyTable = setupTable(table);
		    tableMap.put(rowKey, keyTable);
		}
		keyTable.addRow(table.getRow(row));
	}

	context.put("keySet", tableMap.keySet());
	context.put("tableMap", tableMap);
}
]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="242" y="156"/>
                                                            </extensions>
                                                        </node>
                                                        <ogcn:macro id="fea3c514af3e46b1" name="Setup Buffer Name" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                            <graph id="48bfd94b">
                                                                <node id="d00a9320f7404b4d" name="StringBuffer#&lt;init&gt;(String)" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>(java.lang.String)]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="15" y="15">
                                                                            <oga:default for="arg1" type="java.lang.String"/>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <node id="459bc03c75704994" name="Participant" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="15" y="146"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="725b7b87a124e56" name="StringBuffer#append(String)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[append(java.lang.String)]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="256" y="15"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="337fd6eb26684299" name="StringBuffer#toString()" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[toString()]]></oga:property>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="507" y="15"/>
                                                                    </extensions>
                                                                </node>
                                                                <link dest="337fd6eb26684299" destField="obj" source="725b7b87a124e56" sourceField="value"/>
                                                                <link dest="725b7b87a124e56" destField="obj" source="d00a9320f7404b4d" sourceField="value"/>
                                                                <link dest="725b7b87a124e56" destField="arg1" source="459bc03c75704994" sourceField="name"/>
                                                                <extensions>
                                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                                </extensions>
                                                            </graph>
                                                            <ogcn:published_input field="obj" name="speaker" ref="459bc03c75704994"/>
                                                            <ogcn:published_input field="arg1" name="arg1" ref="d00a9320f7404b4d"/>
                                                            <ogcn:published_output field="value" name="value" ref="337fd6eb26684299"/>
                                                            <extensions>
                                                                <oga:meta x="241" y="297">
                                                                    <oga:default for="arg1" type="java.lang.String">Mean Babble Level (by Session)_</oga:default>
                                                                </oga:meta>
                                                            </extensions>
                                                        </ogcn:macro>
                                                        <node id="ec5c9a7ddce147ce" name="Add Frequency Columns" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                            <input name="tableMap" optional="false"/>
                                                            <output name="freqTable" type="ca.phon.query.report.datasource.DefaultTableDataSource"/>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="__script"><![CDATA[function init(inputs, outputs) {
	inputs.add("tableMap", "", false, false);

	outputs.add("freqTable", "", false, Packages.ca.phon.query.report.datasource.DefaultTableDataSource);
}

function tableOp(context, table) {
	var tableMap = context.get("tableMap");
	var freqTable = new Packages.ca.phon.query.report.datasource.DefaultTableDataSource();

	// setup columns
	freqTable.setColumnTitle(0, table.getColumnTitle(0));

	var colIdx = 1;
	for(var col = 1; col < table.columnCount; col++) {
		freqTable.setColumnTitle(colIdx++, table.getColumnTitle(col));
		freqTable.setColumnTitle(colIdx++, "% " + table.getColumnTitle(col));
	}

	for(var row = 0; row < table.rowCount; row++) {
		var rowData = [];
		var tableData = table.getRow(row);

		rowData[0] = tableData[0];
		colIdx = 1;

		for(var col = 1; col < table.columnCount; col++) {
			var total = tableMap.get(table.getColumnTitle(col)).rowCount;
			var count = tableData[col];
			var freq = (count / total) * 100.0;

			rowData[colIdx++] = new java.lang.Integer(count);
			rowData[colIdx++] = freq;
		}

		freqTable.addRow(rowData);
	}

	context.put("freqTable", freqTable);
}
]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="417" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="adb22cd51e934885" type="class:ca.phon.app.opgraph.nodes.table.SortNode">
                                                            <extensions>
                                                                <opqry:sortoptions>
                                                                    <opqry:sortBy column="Mean Babble Level" order="ascending" type="plain"/>
                                                                </opqry:sortoptions>
                                                                <oga:settings/>
                                                                <oga:meta x="652" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <node id="e25649dd23b3479f" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                            <input name="data" optional="false">Data to print</input>
                                                            <extensions>
                                                                <oga:settings>
                                                                    <oga:property key="dataTemplate"><![CDATA[$DATA]]></oga:property>
                                                                    <oga:property key="showText"><![CDATA[false]]></oga:property>
                                                                    <oga:property key="showTable"><![CDATA[true]]></oga:property>
                                                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                </oga:settings>
                                                                <oga:meta x="827" y="15"/>
                                                            </extensions>
                                                        </node>
                                                        <ogcn:macro id="eee148baf194879" name="Add to Report Template" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                                            <graph id="47730b79">
                                                                <node id="449b1e7ae3384674" name="Buffer Name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                                            <oga:property key="contextKey"/>
                                                                        </oga:settings>
                                                                        <oga:meta x="13" y="126"/>
                                                                    </extensions>
                                                                </node>
                                                                <node id="3ef220df55d3454e" name="Set Caption" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                                    <input name="data" optional="false">Data to print</input>
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="dataTemplate"><![CDATA[
#set($caption = "<h4>Mean Babble Level (by Session)</h4>")
]]></oga:property>
                                                                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="216" y="61">
                                                                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <node id="afddd18f666945ab" name="Add to Template" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                                                    <input name="data" optional="false">Data to print</input>
                                                                    <extensions>
                                                                        <oga:settings>
                                                                            <oga:property key="dataTemplate"><![CDATA[
#set($tableName = "$DATA")
#if($tables.containsKey($tableName))
#set($table = $tables.get($tableName))
#printTableWithIdAndCaption( $table $tableName $caption [] )
#else
$caption

No Results
#end
]]></oga:property>
                                                                            <oga:property key="showText"><![CDATA[true]]></oga:property>
                                                                            <oga:property key="showTable"><![CDATA[false]]></oga:property>
                                                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                                        </oga:settings>
                                                                        <oga:meta x="219" y="190">
                                                                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                                        </oga:meta>
                                                                    </extensions>
                                                                </node>
                                                                <link dest="3ef220df55d3454e" destField="buffer" source="449b1e7ae3384674" sourceField="obj"/>
                                                                <link dest="afddd18f666945ab" destField="buffer" source="449b1e7ae3384674" sourceField="obj"/>
                                                                <extensions>
                                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                                </extensions>
                                                            </graph>
                                                            <ogcn:published_input field="data" name="speaker" ref="3ef220df55d3454e"/>
                                                            <ogcn:published_input field="data" name="bufferName" ref="afddd18f666945ab"/>
                                                            <ogcn:published_input field="obj" name="obj" ref="449b1e7ae3384674"/>
                                                            <extensions>
                                                                <oga:meta x="1009" y="15"/>
                                                            </extensions>
                                                        </ogcn:macro>
                                                        <link dest="e25649dd23b3479f" destField="data" source="adb22cd51e934885" sourceField="table"/>
                                                        <link dest="fea3c514af3e46b1" destField="speaker" source="e5d4044eae2b4148" sourceField="obj"/>
                                                        <link dest="eee148baf194879" destField="speaker" source="e5d4044eae2b4148" sourceField="obj"/>
                                                        <link dest="e25649dd23b3479f" destField="buffer" source="fea3c514af3e46b1" sourceField="value"/>
                                                        <link dest="eee148baf194879" destField="bufferName" source="e25649dd23b3479f" sourceField="buffer"/>
                                                        <link dest="ec5c9a7ddce147ce" destField="tableMap" source="8bf24634c804fef" sourceField="tableMap"/>
                                                        <link dest="ec5c9a7ddce147ce" destField="table" source="26d8074f11a4469e" sourceField="table"/>
                                                        <link dest="adb22cd51e934885" destField="table" source="ec5c9a7ddce147ce" sourceField="freqTable"/>
                                                        <link dest="26d8074f11a4469e" destField="table" source="c5954c4c2e8242f3" sourceField="obj"/>
                                                        <link dest="8bf24634c804fef" destField="table" source="c5954c4c2e8242f3" sourceField="obj"/>
                                                        <link dest="eee148baf194879" destField="obj" source="e575f4590fe1478d" sourceField="obj"/>
                                                        <extensions>
                                                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                        </extensions>
                                                    </graph>
                                                    <ogcn:published_input field="obj" name="speaker" ref="e5d4044eae2b4148"/>
                                                    <ogcn:published_input field="obj" name="obj" ref="c5954c4c2e8242f3"/>
                                                    <ogcn:published_input field="obj" name="bufferName" ref="e575f4590fe1478d"/>
                                                    <extensions>
                                                        <oga:meta x="540" y="166"/>
                                                    </extensions>
                                                </ogcn:macro>
                                                <node id="b12705f4c9c84206" name="Add to Summary" type="class:ca.phon.app.opgraph.nodes.table.TableScriptNode">
                                                    <extensions>
                                                        <oga:settings>
                                                            <oga:property key="__script"><![CDATA[function init(inputs, outputs) {
	inputs.add("inventory", "");
	inputs.add("numVocs", "");
}

function tableOp(context, table) {
	var inventory = context.get("inventory");
	var numVocs = context.get("numVocs");

	var total = 0.0;
	for(var row = 0; row < inventory.rowCount; row++) {
		var mbl = inventory.getValueAt(row, 0);
		var cnt = inventory.getValueAt(row, 1);

		total += (mbl.floatValue() * cnt.intValue());
	}
	var meanBabbleLevel = total / numVocs;
	
	var rowData = [];
	var colIdx = 0;
	rowData[colIdx++] = "";
	rowData[colIdx++] = "mean babble level";
	rowData[colIdx++] = new java.lang.Float(meanBabbleLevel);
	table.addRow(rowData);
}
]]></oga:property>
                                                        </oga:settings>
                                                        <oga:meta x="490" y="415"/>
                                                    </extensions>
                                                </node>
                                                <link dest="117b1f6cbc42428c" destField="table" source="f2b0e896f7884dea" sourceField="obj"/>
                                                <link dest="e59f22e93c0416a" destField="speaker" source="b9a7aaa10d754522" sourceField="obj"/>
                                                <link dest="455c63934e7b460c" destField="speaker" source="b9a7aaa10d754522" sourceField="obj"/>
                                                <link dest="e59f22e93c0416a" destField="obj" source="117b1f6cbc42428c" sourceField="table"/>
                                                <link dest="455c63934e7b460c" destField="obj" source="117b1f6cbc42428c" sourceField="table"/>
                                                <link dest="e59f22e93c0416a" destField="bufferName" source="49fd186c67364a32" sourceField="obj"/>
                                                <link dest="455c63934e7b460c" destField="bufferName" source="49fd186c67364a32" sourceField="obj"/>
                                                <link dest="b12705f4c9c84206" destField="table" source="748fd15f9a984590" sourceField="obj"/>
                                                <link dest="b12705f4c9c84206" destField="inventory" source="e59f22e93c0416a" sourceField="table"/>
                                                <link dest="b12705f4c9c84206" destField="numVocs" source="f2b0e896f7884dea" sourceField="rowCount"/>
                                                <extensions>
                                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                                </extensions>
                                            </graph>
                                            <ogcn:published_input field="obj" name="table" ref="f2b0e896f7884dea"/>
                                            <ogcn:published_input field="obj" name="obj" ref="b9a7aaa10d754522"/>
                                            <ogcn:published_input field="obj" name="bufferName" ref="49fd186c67364a32"/>
                                            <ogcn:published_input field="obj" name="summaryTable" ref="748fd15f9a984590"/>
                                            <extensions>
                                                <oga:meta x="270" y="512"/>
                                            </extensions>
                                        </ogcn:macro>
                                        <link dest="39f91ef7" destField="speaker" source="45508fae" sourceField="obj"/>
                                        <link dest="71606628" destField="tableMap" source="7cbf1d09" sourceField="obj"/>
                                        <link dest="39f91ef7" destField="table" source="578fcaef" sourceField="obj"/>
                                        <link dest="71606628" destField="speaker" source="45508fae" sourceField="obj"/>
                                        <link dest="35376622" destField="obj" source="45508fae" sourceField="obj"/>
                                        <link dest="35376622" destField="table" source="578fcaef" sourceField="obj"/>
                                        <link dest="5c298b00" destField="speaker" source="45508fae" sourceField="obj"/>
                                        <link dest="5c298b00" destField="data" source="578fcaef" sourceField="obj"/>
                                        <link dest="9bee85a827324705" destField="speaker" source="45508fae" sourceField="obj"/>
                                        <link dest="9bee85a827324705" destField="table" source="578fcaef" sourceField="obj"/>
                                        <link dest="9dee81f2bd624468" destField="table" source="578fcaef" sourceField="obj"/>
                                        <link dest="9dee81f2bd624468" destField="obj" source="45508fae" sourceField="obj"/>
                                        <link dest="fbb7c1ceae774d2a" destField="speaker" source="45508fae" sourceField="obj"/>
                                        <link dest="c3a5d71d15704c6f" destField="table" source="578fcaef" sourceField="obj"/>
                                        <link dest="c3a5d71d15704c6f" destField="obj" source="45508fae" sourceField="obj"/>
                                        <link dest="71606628" destField="summaryTable" source="fe996f4347094d31" sourceField="obj"/>
                                        <link dest="71606628" destField="bufferName" source="e70f62ef9803475e" sourceField="obj"/>
                                        <link dest="5c298b00" destField="bufferName" source="e70f62ef9803475e" sourceField="obj"/>
                                        <link dest="39f91ef7" destField="bufferName" source="e70f62ef9803475e" sourceField="obj"/>
                                        <link dest="39f91ef7" destField="summaryTable" source="fe996f4347094d31" sourceField="obj"/>
                                        <link dest="9bee85a827324705" destField="bufferName" source="e70f62ef9803475e" sourceField="obj"/>
                                        <link dest="9bee85a827324705" destField="summaryTable" source="fe996f4347094d31" sourceField="obj"/>
                                        <link dest="9dee81f2bd624468" destField="summaryTable" source="fe996f4347094d31" sourceField="obj"/>
                                        <link dest="9dee81f2bd624468" destField="bufferName" source="e70f62ef9803475e" sourceField="obj"/>
                                        <link dest="fbb7c1ceae774d2a" destField="table" source="578fcaef" sourceField="obj"/>
                                        <link dest="fbb7c1ceae774d2a" destField="bufferName" source="e70f62ef9803475e" sourceField="obj"/>
                                        <link dest="fbb7c1ceae774d2a" destField="summaryTable" source="fe996f4347094d31" sourceField="obj"/>
                                        <link dest="35376622" destField="bufferName" source="e70f62ef9803475e" sourceField="obj"/>
                                        <link dest="35376622" destField="summaryTable" source="fe996f4347094d31" sourceField="obj"/>
                                        <link dest="c3a5d71d15704c6f" destField="bufferName" source="e70f62ef9803475e" sourceField="obj"/>
                                        <link dest="c3a5d71d15704c6f" destField="summaryTable" source="fe996f4347094d31" sourceField="obj"/>
                                        <extensions>
                                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                        </extensions>
                                    </graph>
                                    <ogcn:published_input field="obj" name="speaker" ref="45508fae"/>
                                    <ogcn:published_input field="obj" name="table" ref="578fcaef"/>
                                    <ogcn:published_input field="obj" name="tableMap" ref="7cbf1d09"/>
                                    <ogcn:published_input field="obj" name="result total" ref="c81dda4"/>
                                    <ogcn:published_input field="obj" name="bufferName" ref="e70f62ef9803475e"/>
                                    <ogcn:published_input field="obj" name="summaryTable" ref="fe996f4347094d31"/>
                                    <extensions>
                                        <oga:meta x="600" y="65"/>
                                    </extensions>
                                </ogcn:macro>
                                <link dest="7f149b7d" destField="table" source="60a76f15" sourceField="obj"/>
                                <link dest="5aee518f" destField="tableMap" source="7f149b7d" sourceField="tableMap"/>
                                <link dest="5aee518f" destField="table" source="60a76f15" sourceField="obj"/>
                                <link dest="5aee518f" destField="speaker" source="68d90fd6bd914ea2" sourceField="obj"/>
                                <link dest="5aee518f" destField="result total" source="60a76f15" sourceField="rowCount"/>
                                <link dest="5aee518f" destField="bufferName" source="d4b8b57a48a64b53" sourceField="obj"/>
                                <link dest="5aee518f" destField="summaryTable" source="95cfaf8923b44bb7" sourceField="obj"/>
                                <extensions>
                                    <oga:notes>
                                        <oga:note color="0xffff96" height="851" title="Inputs" width="311" x="9" y="19"/>
                                    </oga:notes>
                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                </extensions>
                            </graph>
                            <ogcn:published_input field="obj" name="tableMap" ref="60a76f15"/>
                            <ogcn:published_input field="obj" name="speaker" ref="68d90fd6bd914ea2"/>
                            <ogcn:published_input field="obj" name="bufferName" ref="d4b8b57a48a64b53"/>
                            <ogcn:published_input field="obj" name="summaryTable" ref="95cfaf8923b44bb7"/>
                            <extensions>
                                <oga:meta x="630" y="168"/>
                            </extensions>
                        </ogcn:macro>
                        <link dest="350c5a14" destField="speaker" source="28737cd4" sourceField="obj"/>
                        <link dest="bfbf3172e44b4532" destField="table" source="3303e4cd" sourceField="obj"/>
                        <link dest="bbf482c5a66541f7" destField="tableMap" source="bfbf3172e44b4532" sourceField="tableMap"/>
                        <link dest="bbf482c5a66541f7" destField="speaker" source="28737cd4" sourceField="obj"/>
                        <link dest="350c5a14" destField="tableMap" source="bbf482c5a66541f7" sourceField="table"/>
                        <link dest="350c5a14" destField="enabled" source="bbf482c5a66541f7" sourceField="exists"/>
                        <link dest="350c5a14" destField="bufferName" source="63be7001" sourceField="obj"/>
                        <link dest="350c5a14" destField="summaryTable" source="b559e3f830b34106" sourceField="obj"/>
                        <extensions>
                            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                        </extensions>
                    </graph>
                    <ogcn:published_input field="obj" name="speaker" ref="28737cd4"/>
                    <ogcn:published_input field="obj" name="table" ref="3303e4cd"/>
                    <ogcn:published_input field="obj" name="bufferName" ref="63be7001"/>
                    <ogcn:published_input field="obj" name="obj" ref="b559e3f830b34106"/>
                    <ogcn:published_output field="obj" name="summaryTable" ref="b559e3f830b34106"/>
                    <extensions>
                        <oga:meta x="785" y="110"/>
                    </extensions>
                </ogcn:macro>
                <ogcn:macro id="406db955" name="Print Summary Table" type="ca.gedge.opgraph.nodes.general.MacroNode">
                    <graph id="711caa6b">
                        <node id="5fa50b2" name="data" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.query.report.datasource.TableDataSource]]></oga:property>
                                </oga:settings>
                                <oga:meta x="563" y="457"/>
                            </extensions>
                        </node>
                        <node id="450a27e7" name="speaker" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                </oga:settings>
                                <oga:meta x="563" y="457"/>
                            </extensions>
                        </node>
                        <ogcn:macro id="58d79787d0f246e9" name="Setup Buffer Name" type="ca.gedge.opgraph.nodes.general.MacroNode">
                            <graph id="6ab6207f">
                                <node id="70f44961a79340c3" name="StringBuffer#&lt;init&gt;(String)" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>(java.lang.String)]]></oga:property>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="280" y="23">
                                            <oga:default for="arg1" type="java.lang.String">Summary_</oga:default>
                                        </oga:meta>
                                    </extensions>
                                </node>
                                <node id="b82dafa1d1934c30" name="participant" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="37" y="268"/>
                                    </extensions>
                                </node>
                                <node id="58754aeadf674768" name="StringBuffer#append(Object)" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[append(java.lang.Object)]]></oga:property>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="512" y="200"/>
                                    </extensions>
                                </node>
                                <node id="580547f8e2434cc6" name="StringBuffer#toString()" type="class:ca.gedge.opgraph.nodes.reflect.MethodNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.classMember"><![CDATA[toString()]]></oga:property>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.MethodNode.declaredClass"><![CDATA[java.lang.StringBuffer]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="843" y="232"/>
                                    </extensions>
                                </node>
                                <link dest="580547f8e2434cc6" destField="obj" source="58754aeadf674768" sourceField="value"/>
                                <link dest="58754aeadf674768" destField="arg1" source="b82dafa1d1934c30" sourceField="obj"/>
                                <link dest="58754aeadf674768" destField="obj" source="70f44961a79340c3" sourceField="value"/>
                            </graph>
                            <ogcn:published_input field="obj" name="speaker" ref="b82dafa1d1934c30"/>
                            <ogcn:published_output field="value" name="bufferName" ref="580547f8e2434cc6"/>
                            <extensions>
                                <oga:meta x="601" y="484"/>
                            </extensions>
                        </ogcn:macro>
                        <node id="5ba1c037" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                            <input name="data" optional="false">Data to print</input>
                            <extensions>
                                <oga:settings>
                                    <oga:property key="dataTemplate"><![CDATA[$DATA]]></oga:property>
                                    <oga:property key="showText"><![CDATA[false]]></oga:property>
                                    <oga:property key="showTable"><![CDATA[true]]></oga:property>
                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                </oga:settings>
                                <oga:meta x="886" y="470"/>
                            </extensions>
                        </node>
                        <link dest="5ba1c037" destField="data" source="5fa50b2" sourceField="obj"/>
                        <link dest="58d79787d0f246e9" destField="speaker" source="450a27e7" sourceField="obj"/>
                        <link dest="5ba1c037" destField="buffer" source="58d79787d0f246e9" sourceField="bufferName"/>
                    </graph>
                    <ogcn:published_input field="obj" name="data" ref="5fa50b2"/>
                    <ogcn:published_input field="obj" name="speaker" ref="450a27e7"/>
                    <ogcn:published_output field="buffer" name="buffer" ref="5ba1c037"/>
                    <extensions>
                        <oga:meta x="645" y="405"/>
                    </extensions>
                </ogcn:macro>
                <ogcn:macro id="7fc66e63" name="Add to Report" type="ca.gedge.opgraph.nodes.general.MacroNode">
                    <graph id="2636814d">
                        <node id="6dbdc299" name="speaker" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[ca.phon.session.Participant]]></oga:property>
                                </oga:settings>
                                <oga:meta x="15" y="15"/>
                            </extensions>
                        </node>
                        <node id="655d02fe" name="summary buffer name" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                </oga:settings>
                                <oga:meta x="15" y="336"/>
                            </extensions>
                        </node>
                        <node id="e749c2158974c93" name="speaker report template" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                            <extensions>
                                <oga:settings>
                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                </oga:settings>
                                <oga:meta x="20" y="457"/>
                            </extensions>
                        </node>
                        <node id="22a80449" name="Print Speaker Name" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                            <input name="data" optional="false">Data to print</input>
                            <extensions>
                                <oga:settings>
                                    <oga:property key="dataTemplate"><![CDATA[
#h2("$DATA")
]]></oga:property>
                                    <oga:property key="showText"><![CDATA[false]]></oga:property>
                                    <oga:property key="showTable"><![CDATA[true]]></oga:property>
                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                </oga:settings>
                                <oga:meta x="241" y="15">
                                    <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                    <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                </oga:meta>
                            </extensions>
                        </node>
                        <ogcn:macro id="5933833c" name="Add Summary Table to Report" type="ca.gedge.opgraph.nodes.general.MacroNode">
                            <graph id="272d7aad">
                                <node id="35b2b34b" name="String#&lt;init&gt;()" type="class:ca.gedge.opgraph.nodes.reflect.ConstructorNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.classMember"><![CDATA[<init>()]]></oga:property>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ConstructorNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="744" y="545"/>
                                    </extensions>
                                </node>
                                <node id="5d99c6dd" name="data" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                        </oga:settings>
                                    </extensions>
                                </node>
                                <node id="7db47b2a" name="Set Summary Caption" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                    <input name="data" optional="false">Data to print</input>
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="dataTemplate"><![CDATA[
#set($caption = "<h3>Summary</h3>")
]]></oga:property>
                                            <oga:property key="showText"><![CDATA[false]]></oga:property>
                                            <oga:property key="showTable"><![CDATA[true]]></oga:property>
                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="924" y="519">
                                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                        </oga:meta>
                                    </extensions>
                                </node>
                                <node id="18d67179" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                    <input name="data" optional="false">Data to print</input>
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="dataTemplate"><![CDATA[
#set($tableName = "$DATA")
#if($tables.containsKey($tableName))
#set($table = $tables.get($tableName))
#printTableWithIdAndCaption( $table $tableName $caption [] )
#else
$caption

No Results
#end
]]></oga:property>
                                            <oga:property key="showText"><![CDATA[false]]></oga:property>
                                            <oga:property key="showTable"><![CDATA[true]]></oga:property>
                                            <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="928" y="653">
                                            <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                            <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                        </oga:meta>
                                    </extensions>
                                </node>
                                <link dest="18d67179" destField="data" source="5d99c6dd" sourceField="obj"/>
                                <link dest="7db47b2a" destField="data" source="35b2b34b" sourceField="value"/>
                            </graph>
                            <ogcn:published_input field="obj" name="data" ref="5d99c6dd"/>
                            <extensions>
                                <oga:meta x="226" y="336"/>
                            </extensions>
                        </ogcn:macro>
                        <ogcn:macro id="48d93a8444e947bf" name="Add Speaker Template" type="ca.gedge.opgraph.nodes.general.MacroNode">
                            <graph id="a74c578">
                                <node id="99c2d82de8c84fdc" name="data" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                    <extensions>
                                        <oga:settings>
                                            <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                        </oga:settings>
                                        <oga:meta x="15" y="15"/>
                                    </extensions>
                                </node>
                                <ogcn:macro id="24eb3d7a" name="Add Buffer to Report Template" type="ca.gedge.opgraph.nodes.general.MacroNode">
                                    <graph id="6189a12f">
                                        <node id="43385f49" name="buffer" type="class:ca.gedge.opgraph.nodes.reflect.ObjectNode">
                                            <extensions>
                                                <oga:settings>
                                                    <oga:property key="ca.gedge.opgraph.nodes.reflect.ObjectNode.declaredClass"><![CDATA[java.lang.String]]></oga:property>
                                                </oga:settings>
                                            </extensions>
                                        </node>
                                        <node id="46beb9a7" type="class:ca.phon.app.opgraph.nodes.log.GetBufferNode">
                                            <extensions>
                                                <oga:meta x="229" y="32"/>
                                            </extensions>
                                        </node>
                                        <node id="3cb0b3a7" type="class:ca.phon.app.opgraph.nodes.log.PrintBufferNode">
                                            <input name="data" optional="false">Data to print</input>
                                            <extensions>
                                                <oga:settings>
                                                    <oga:property key="dataTemplate"><![CDATA[$DATA]]></oga:property>
                                                    <oga:property key="showText"><![CDATA[false]]></oga:property>
                                                    <oga:property key="showTable"><![CDATA[true]]></oga:property>
                                                    <oga:property key="showHTML"><![CDATA[false]]></oga:property>
                                                </oga:settings>
                                                <oga:meta x="433" y="52">
                                                    <oga:default for="buffer" type="java.lang.String">Report Template</oga:default>
                                                    <oga:default for="append" type="java.lang.Boolean">true</oga:default>
                                                </oga:meta>
                                            </extensions>
                                        </node>
                                        <link dest="3cb0b3a7" destField="data" source="46beb9a7" sourceField="text"/>
                                        <link dest="46beb9a7" destField="buffer" source="43385f49" sourceField="obj"/>
                                    </graph>
                                    <ogcn:published_input field="obj" name="buffer" ref="43385f49"/>
                                    <extensions>
                                        <oga:meta x="233" y="27"/>
                                    </extensions>
                                </ogcn:macro>
                                <node id="98be7f4" type="class:ca.phon.app.opgraph.nodes.log.CloseBufferNode">
                                    <extensions>
                                        <oga:meta x="229" y="138"/>
                                    </extensions>
                                </node>
                                <link dest="98be7f4" destField="buffer" source="99c2d82de8c84fdc" sourceField="obj"/>
                                <link dest="24eb3d7a" destField="buffer" source="99c2d82de8c84fdc" sourceField="obj"/>
                                <extensions>
                                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                                </extensions>
                            </graph>
                            <ogcn:published_input field="obj" name="data" ref="99c2d82de8c84fdc"/>
                            <extensions>
                                <oga:meta x="237" y="456"/>
                            </extensions>
                        </ogcn:macro>
                        <link dest="22a80449" destField="data" source="6dbdc299" sourceField="obj"/>
                        <link dest="5933833c" destField="data" source="655d02fe" sourceField="obj"/>
                        <link dest="48d93a8444e947bf" destField="data" source="e749c2158974c93" sourceField="obj"/>
                    </graph>
                    <ogcn:published_input field="obj" name="data" ref="6dbdc299"/>
                    <ogcn:published_input field="obj" name="data1" ref="655d02fe"/>
                    <ogcn:published_input field="obj" name="obj" ref="e749c2158974c93"/>
                    <extensions>
                        <oga:meta x="906" y="404"/>
                    </extensions>
                </ogcn:macro>
                <link dest="5fc29abaa09040c1" destField="obj" source="282a70f9" sourceField="obj"/>
                <link dest="4f8f6618" destField="speaker" source="5fc29abaa09040c1" sourceField="obj"/>
                <link dest="e60ae088c39c4be1" destField="table" source="cbab76efb3454ab5" sourceField="obj"/>
                <link dest="607a331e" destField="bufferName" source="4f8f6618" sourceField="bufferName"/>
                <link dest="607a331e" destField="speaker" source="5fc29abaa09040c1" sourceField="obj"/>
                <link dest="607a331e" destField="table" source="e60ae088c39c4be1" sourceField="trueTable"/>
                <link dest="607a331e" destField="obj" source="55aaa72dc82b4f91" sourceField="table"/>
                <link dest="406db955" destField="speaker" source="5fc29abaa09040c1" sourceField="obj"/>
                <link dest="406db955" destField="data" source="607a331e" sourceField="summaryTable"/>
                <link dest="7fc66e63" destField="data" source="5fc29abaa09040c1" sourceField="obj"/>
                <link dest="7fc66e63" destField="data1" source="406db955" sourceField="buffer"/>
                <link dest="7fc66e63" destField="obj" source="4f8f6618" sourceField="bufferName"/>
                <extensions>
                    <oga:notes>
                        <oga:note color="0xffff96" height="673" title="Inputs" width="255" x="22" y="139"/>
                    </oga:notes>
                    <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
                </extensions>
            </graph>
            <ogcn:published_input field="obj" name="resultTable" ref="cbab76efb3454ab5"/>
            <extensions>
                <oga:settings>
                    <oga:property key="ca.gedge.opgraph.nodes.reflect.IterableClassNode.className"><![CDATA[java.util.ArrayList]]></oga:property>
                </oga:settings>
                <oga:meta x="756" y="16"/>
            </extensions>
        </ogcn:macro>
        <link dest="29ac654b" destField="project" source="55f4fba4" sourceField="obj"/>
        <link dest="29ac654b" destField="sessions" source="1ae2322c" sourceField="obj"/>
        <link dest="61e6ae5ee8ed4084" destField="project" source="29ac654b" sourceField="project"/>
        <link dest="61208600" destField="collection" source="3da0e5db" sourceField="obj"/>
        <link dest="61e6ae5ee8ed4084" destField="results" source="29ac654b" sourceField="results"/>
        <link dest="41a5af28" destField="parameters" source="dc596f57c3774064" sourceField="parameters"/>
        <link dest="61208600" destField="resultTable" source="61e6ae5ee8ed4084" sourceField="table"/>
        <extensions>
            <opqry:nodewizard type="ca.phon.app.opgraph.analysis.AnalysisWizardExtension">
                <opqry:info format="html" title="Vocalization">
                    <opqry:message/>
                </opqry:info>
                <opqry:report-template name="Report Prefix"/>
                <opqry:report-template name="Report Suffix"/>
            </opqry:nodewizard>
            <nes:settings type="ca.phon.app.opgraph.analysis.AnalysisOpGraphEditorModel"/>
        </extensions>
    </graph>
</opgraph>
